
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>9. SQL &#8212; Online-Skript Grundlagen der Datenbanksysteme</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="10. Integrität und Trigger" href="../10/integritaet_und_trigger.html" />
    <link rel="prev" title="8. Relationale Algebra" href="../08/relationale_algebra.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/DBIS_Kurzlogo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Online-Skript Grundlagen der Datenbanksysteme</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Grundlagen der Datenbanksysteme
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../01/einfuehrung.html">
   1. Einführung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02/historie.html">
   2. Historie
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03/architektur.html">
   3. Architektur
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04/phasenmodell_datenbankentwurf.html">
   4. Phasenmodell für den Datenbankentwurf
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../05/er_modellierung.html">
   5. ER-Modellierung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06/relationaler_entwurf.html">
   6. Relationaler Entwurf
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07/normalisierung.html">
   7. Normalisierung
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08/relationale_algebra.html">
   8. Relationale Algebra
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   9. SQL
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../10/integritaet_und_trigger.html">
   10. Integrität und Trigger
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../11/transaktionen.html">
   11. Transaktionsmanagement
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/09/sql.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/LUH-DBS/GDBS_Script"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/LUH-DBS/GDBS_Script/issues/new?title=Issue%20on%20page%20%2F09/sql.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/LUH-DBS/GDBS_Script/main/?urlpath=tree/09/sql.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#einfuhrung">
   9.1. Einführung
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motivation-fur-sql">
     9.1.1. Motivation für SQL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sql-historie">
     9.1.2. SQL-Historie
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sql-standardisierung">
     9.1.3. SQL – Standardisierung
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sql-2008-struktur">
     9.1.4. SQL:2008 Struktur
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#einfach-anfragen">
   9.2. Einfach Anfragen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-from-where">
     9.2.1. SELECT … FROM … WHERE …
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#beispielschema">
     9.2.2. Beispielschema
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#projektion-in-sql-select-pi">
     9.2.3. Projektion in SQL (SELECT,
     <span class="math notranslate nohighlight">
      \(\pi\)
     </span>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selektion-in-sql-where-sigma">
     9.2.4. Selektion in SQL (WHERE,
     <span class="math notranslate nohighlight">
      \(\sigma\)
     </span>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stringvergleiche">
     9.2.5. Stringvergleiche
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#string-mustervergleiche-mit-like">
     9.2.6. String-Mustervergleiche mit LIKE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#datum-und-uhrzeit">
     9.2.7. Datum und Uhrzeit
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nullwerte">
     9.2.8. Nullwerte
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wahrheitswerte">
     9.2.9. Wahrheitswerte
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sortierung">
     9.2.10. Sortierung
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anfragen-uber-mehrere-relationen">
   9.3. Anfragen über mehrere Relationen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motivation">
     9.3.1. Motivation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kreuzprodukt-und-join">
     9.3.2. Kreuzprodukt und Join
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uneindeutige-attributnamen">
     9.3.3. Uneindeutige Attributnamen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tupelvariablen">
     9.3.4. Tupelvariablen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tupelvariablen-selfjoin">
     9.3.5. Tupelvariablen-Selfjoin
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpretation-von-anfragen">
     9.3.6. Interpretation von Anfragen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#joins">
     9.3.7. Joins
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-tpc-h-schema">
     9.3.8. The TPC-H Schema
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tpc-query-minimum-cost-supplier">
       9.3.8.1. TPC Query - Minimum Cost Supplier
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-tpc-h-universal-table">
       9.3.8.2. The TPC-H Universal Table
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#outer-joins">
     9.3.9. Outer Joins
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kreuzprodukt">
     9.3.10. Kreuzprodukt
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mengenoperationen-in-sql">
     9.3.11. Mengenoperationen in SQL
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#schnittmenge-intersect">
       9.3.11.1. Schnittmenge: INTERSECT
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vereinigung-union">
       9.3.11.2. Vereinigung: UNION
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#differenz-except-minus">
       9.3.11.3. Differenz: EXCEPT/MINUS
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#klammerung">
       9.3.11.4. Klammerung
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zusammenfassung-der-semantik">
     9.3.12. Zusammenfassung der Semantik
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geschachtelte-anfragen">
   9.4. Geschachtelte Anfragen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     9.4.1. Motivation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#skalare-subanfragen">
     9.4.2. Skalare Subanfragen
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#skalare-subanfragen-beispiel">
       9.4.2.1. Skalare Subanfragen – Beispiel
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bedingungen-mit-relationen">
     9.4.3. Bedingungen mit Relationen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exists-beispiele">
     9.4.4. EXISTS Beispiele
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#in-beispiele">
     9.4.5. IN Beispiele
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#all-und-any-beispiele">
     9.4.6. ALL und ANY Beispiele
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bedingungen-mit-tupeln">
     9.4.7. Bedingungen mit Tupeln
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#subanfragen-in-from-klausel">
     9.4.8. Subanfragen in FROM-Klausel
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#korrelierte-subanfragen">
     9.4.9. Korrelierte Subanfragen
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#operationen-auf-einer-relation">
   9.5. Operationen auf einer Relation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#duplikateliminierung">
     9.5.1. Duplikateliminierung
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#wdh-duplikateliminierung-bei-mengenoperationen">
       9.5.1.1. Wdh.: Duplikateliminierung bei Mengenoperationen
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aggregation">
     9.5.2. Aggregation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aggregation-beispiele">
       9.5.2.1. Aggregation – Beispiele
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gruppierung-aggregation-und-null">
     9.5.3. Gruppierung, Aggregation und NULL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gruppierung">
     9.5.4. Gruppierung
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zusammenfassung-sql">
     9.5.5. Zusammenfassung SQL
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datenbearbeitung-dml">
   9.6. Datenbearbeitung(DML)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uberblick">
     9.6.1. Überblick
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#einfugen">
     9.6.2. Einfügen
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#einfugen-per-anfrage">
       9.6.2.1. Einfügen per Anfrage
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ausfuhrungsreihenfolge-beim-einfugen">
     9.6.3. Ausführungsreihenfolge beim Einfügen
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bulk-insert">
       9.6.3.1. Bulk insert
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loschen">
     9.6.4. Löschen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verandern-update">
     9.6.5. Verändern (update)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#schemata-ddl">
   9.7. Schemata(DDL)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     9.7.1. Überblick
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#datentypen">
     9.7.2. Datentypen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uberblick-db2-datentypen">
     9.7.3. Überblick DB2 Datentypen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tabellen">
     9.7.4. Tabellen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#default-werte">
     9.7.5. Default-Werte
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#constraints-und-trigger">
     9.7.6. Constraints und Trigger
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indizes">
     9.7.7. Indizes
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#indexwahl">
       9.7.7.1. Indexwahl
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#indexwahl-voruberlegungen">
       9.7.7.2. Indexwahl – Vorüberlegungen
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#indexwahl-beispiel">
       9.7.7.3. Indexwahl – Beispiel
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       9.7.7.4. Indexwahl – Beispiel
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verteilung-in-imdb-real-world-daten-stand-ca-2010">
     9.7.8. Verteilung in IMDB (Real-world Daten, Stand ca. 2010)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sichten">
   9.8. Sichten
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#virtuelle-relationen">
     9.8.1. Virtuelle Relationen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sichten-in-sql">
     9.8.2. Sichten in SQL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#anfragen-an-sichten">
     9.8.3. Anfragen an Sichten
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#diskussion">
     9.8.4. Diskussion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#updates-auf-sichten">
     9.8.5. Updates auf Sichten
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#einfugen-auf-sichten-beispiel">
     9.8.6. Einfügen auf Sichten – Beispiel
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loschen-und-updates-auf-sichten">
     9.8.7. Löschen und Updates auf Sichten
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tupelmigration">
     9.8.8. Tupelmigration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#anfrageplanung-mit-sichten">
     9.8.9. Anfrageplanung mit Sichten
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#materialisierte-sichten">
     9.8.10. Materialisierte Sichten
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mv-themen-und-probleme">
       9.8.10.1. MV – Themen und Probleme
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#answering-queries-using-views">
     9.8.11. „Answering Queries using Views“
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zusammenfassung">
   9.9. Zusammenfassung
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>SQL</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#einfuhrung">
   9.1. Einführung
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motivation-fur-sql">
     9.1.1. Motivation für SQL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sql-historie">
     9.1.2. SQL-Historie
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sql-standardisierung">
     9.1.3. SQL – Standardisierung
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sql-2008-struktur">
     9.1.4. SQL:2008 Struktur
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#einfach-anfragen">
   9.2. Einfach Anfragen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#select-from-where">
     9.2.1. SELECT … FROM … WHERE …
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#beispielschema">
     9.2.2. Beispielschema
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#projektion-in-sql-select-pi">
     9.2.3. Projektion in SQL (SELECT,
     <span class="math notranslate nohighlight">
      \(\pi\)
     </span>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#selektion-in-sql-where-sigma">
     9.2.4. Selektion in SQL (WHERE,
     <span class="math notranslate nohighlight">
      \(\sigma\)
     </span>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stringvergleiche">
     9.2.5. Stringvergleiche
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#string-mustervergleiche-mit-like">
     9.2.6. String-Mustervergleiche mit LIKE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#datum-und-uhrzeit">
     9.2.7. Datum und Uhrzeit
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nullwerte">
     9.2.8. Nullwerte
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wahrheitswerte">
     9.2.9. Wahrheitswerte
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sortierung">
     9.2.10. Sortierung
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#anfragen-uber-mehrere-relationen">
   9.3. Anfragen über mehrere Relationen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motivation">
     9.3.1. Motivation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kreuzprodukt-und-join">
     9.3.2. Kreuzprodukt und Join
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uneindeutige-attributnamen">
     9.3.3. Uneindeutige Attributnamen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tupelvariablen">
     9.3.4. Tupelvariablen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tupelvariablen-selfjoin">
     9.3.5. Tupelvariablen-Selfjoin
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpretation-von-anfragen">
     9.3.6. Interpretation von Anfragen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#joins">
     9.3.7. Joins
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-tpc-h-schema">
     9.3.8. The TPC-H Schema
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tpc-query-minimum-cost-supplier">
       9.3.8.1. TPC Query - Minimum Cost Supplier
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-tpc-h-universal-table">
       9.3.8.2. The TPC-H Universal Table
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#outer-joins">
     9.3.9. Outer Joins
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kreuzprodukt">
     9.3.10. Kreuzprodukt
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mengenoperationen-in-sql">
     9.3.11. Mengenoperationen in SQL
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#schnittmenge-intersect">
       9.3.11.1. Schnittmenge: INTERSECT
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#vereinigung-union">
       9.3.11.2. Vereinigung: UNION
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#differenz-except-minus">
       9.3.11.3. Differenz: EXCEPT/MINUS
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#klammerung">
       9.3.11.4. Klammerung
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zusammenfassung-der-semantik">
     9.3.12. Zusammenfassung der Semantik
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#geschachtelte-anfragen">
   9.4. Geschachtelte Anfragen
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     9.4.1. Motivation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#skalare-subanfragen">
     9.4.2. Skalare Subanfragen
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#skalare-subanfragen-beispiel">
       9.4.2.1. Skalare Subanfragen – Beispiel
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bedingungen-mit-relationen">
     9.4.3. Bedingungen mit Relationen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exists-beispiele">
     9.4.4. EXISTS Beispiele
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#in-beispiele">
     9.4.5. IN Beispiele
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#all-und-any-beispiele">
     9.4.6. ALL und ANY Beispiele
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#bedingungen-mit-tupeln">
     9.4.7. Bedingungen mit Tupeln
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#subanfragen-in-from-klausel">
     9.4.8. Subanfragen in FROM-Klausel
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#korrelierte-subanfragen">
     9.4.9. Korrelierte Subanfragen
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#operationen-auf-einer-relation">
   9.5. Operationen auf einer Relation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#duplikateliminierung">
     9.5.1. Duplikateliminierung
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#wdh-duplikateliminierung-bei-mengenoperationen">
       9.5.1.1. Wdh.: Duplikateliminierung bei Mengenoperationen
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#aggregation">
     9.5.2. Aggregation
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#aggregation-beispiele">
       9.5.2.1. Aggregation – Beispiele
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gruppierung-aggregation-und-null">
     9.5.3. Gruppierung, Aggregation und NULL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gruppierung">
     9.5.4. Gruppierung
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zusammenfassung-sql">
     9.5.5. Zusammenfassung SQL
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#datenbearbeitung-dml">
   9.6. Datenbearbeitung(DML)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uberblick">
     9.6.1. Überblick
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#einfugen">
     9.6.2. Einfügen
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#einfugen-per-anfrage">
       9.6.2.1. Einfügen per Anfrage
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ausfuhrungsreihenfolge-beim-einfugen">
     9.6.3. Ausführungsreihenfolge beim Einfügen
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#bulk-insert">
       9.6.3.1. Bulk insert
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loschen">
     9.6.4. Löschen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verandern-update">
     9.6.5. Verändern (update)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#schemata-ddl">
   9.7. Schemata(DDL)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     9.7.1. Überblick
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#datentypen">
     9.7.2. Datentypen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#uberblick-db2-datentypen">
     9.7.3. Überblick DB2 Datentypen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tabellen">
     9.7.4. Tabellen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#default-werte">
     9.7.5. Default-Werte
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#constraints-und-trigger">
     9.7.6. Constraints und Trigger
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#indizes">
     9.7.7. Indizes
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#indexwahl">
       9.7.7.1. Indexwahl
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#indexwahl-voruberlegungen">
       9.7.7.2. Indexwahl – Vorüberlegungen
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#indexwahl-beispiel">
       9.7.7.3. Indexwahl – Beispiel
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       9.7.7.4. Indexwahl – Beispiel
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verteilung-in-imdb-real-world-daten-stand-ca-2010">
     9.7.8. Verteilung in IMDB (Real-world Daten, Stand ca. 2010)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sichten">
   9.8. Sichten
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#virtuelle-relationen">
     9.8.1. Virtuelle Relationen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sichten-in-sql">
     9.8.2. Sichten in SQL
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#anfragen-an-sichten">
     9.8.3. Anfragen an Sichten
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#diskussion">
     9.8.4. Diskussion
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#updates-auf-sichten">
     9.8.5. Updates auf Sichten
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#einfugen-auf-sichten-beispiel">
     9.8.6. Einfügen auf Sichten – Beispiel
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#loschen-und-updates-auf-sichten">
     9.8.7. Löschen und Updates auf Sichten
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#tupelmigration">
     9.8.8. Tupelmigration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#anfrageplanung-mit-sichten">
     9.8.9. Anfrageplanung mit Sichten
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#materialisierte-sichten">
     9.8.10. Materialisierte Sichten
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#mv-themen-und-probleme">
       9.8.10.1. MV – Themen und Probleme
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#answering-queries-using-views">
     9.8.11. „Answering Queries using Views“
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#zusammenfassung">
   9.9. Zusammenfassung
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="sql">
<h1><span class="section-number">9. </span>SQL<a class="headerlink" href="#sql" title="Permalink to this headline">¶</a></h1>
<div class="cell tag_remove-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sqlite3</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="o">%</span><span class="k">load_ext</span> sql
<span class="o">%</span><span class="k">sql</span> sqlite:///filme/filme.db
<span class="o">%</span><span class="k">sql</span> sqlite:///abteilung/abteilung.db
<span class="o">%</span><span class="k">sql</span> sqlite:///buecher/buecher.db
<span class="o">%</span><span class="k">sql</span> sqlite:///lehre/lehre.db
<span class="o">%</span><span class="k">sql</span> sqlite:///rst/rst.db
<span class="o">%</span><span class="k">sql</span> sqlite:///salesDB/salesDB.db
</pre></div>
</div>
</div>
</div>
<div class="section" id="einfuhrung">
<h2><span class="section-number">9.1. </span>Einführung<a class="headerlink" href="#einfuhrung" title="Permalink to this headline">¶</a></h2>
<p>Aus den vorherigen Kapiteln haben wir gelernt wie wir eine Datenbank auf Papier entwerfen, nun schauen wir uns die in der Realität benutzten technischen Mitteln an, insbesondere die Datenbankanfragesprache SQL.</p>
<div class="section" id="motivation-fur-sql">
<h3><span class="section-number">9.1.1. </span>Motivation für SQL<a class="headerlink" href="#motivation-fur-sql" title="Permalink to this headline">¶</a></h3>
<p>SQL ist die meist-verbreiteste Datenbankanfragesprache. Es handelt sich hierbei um eine Very-High-Level Language, die Ad-hoc, deklarativ und nicht prozedural / imperativ ist. SQL-Anfragen sich an die relationale Algebra angelehnt. Zusätzlich sind Data definition(DDL) und Data manipulation(DML) mit SQL möglich. Wichtig zu beachten ist noch, dass sowohl Syntax, als auch Funktionalität sich von System zu System leicht unterscheiden können.</p>
</div>
<div class="section" id="sql-historie">
<h3><span class="section-number">9.1.2. </span>SQL-Historie<a class="headerlink" href="#sql-historie" title="Permalink to this headline">¶</a></h3>
<p>SQL(1982, IBM) entstand durch die Ursprungssprache SEQUEL(1976, IBM Research Labs San Jose). Später entwickelte sich SEQUEL zu SEQUEL2(1976, IBM Research Labs San Jose), welche auf einer der Vorreitern von Datenbanksystemen “System R” benutzt wurde.</p>
<p><img alt="title" src="../_images/historie1.jpg" />
<br>
<img alt="title" src="../_images/historie2.jpg" />
<br>
<img alt="title" src="../_images/historie3.jpg" /></p>
</div>
<div class="section" id="sql-standardisierung">
<h3><span class="section-number">9.1.3. </span>SQL – Standardisierung<a class="headerlink" href="#sql-standardisierung" title="Permalink to this headline">¶</a></h3>
<p>Im Laufe der Zeit durchlief SQL verschiedene Standardisierungen, die Sie aus der folgenden Auflistung entnehmen können. Trotz der Standardisierung sind Inkompatibilitäten zwischen Systemen der einzelnen Hersteller noch möglich.</p>
<ul class="simple">
<li><p>SQL1 von ANSI als Standard verabschiedet (1986)
<br><br></p></li>
<li><p>SQL1 von der (ISO) als Standard verabschiedet (1987)
<br></p></li>
<li><p>1989 nochmals überarbeitet.
<br> <br></p></li>
<li><p>SQL2 oder SQL-92 von der ISO verabschiedet (1992)
<br> <br></p></li>
<li><p>SQL3 oder SQL:1999 verabschiedet
<br></p></li>
<li><p>Trigger, rekursive Anfragen
<br></p></li>
<li><p>Objektrelationale Erweiterungen
<br> <br></p></li>
<li><p>SQL:2003 von der ISO verabschiedet
<br></p></li>
<li><p>XML-Support durch SQL/XML
<br> <br></p></li>
<li><p>SQL/XML:2006
<br></p></li>
<li><p>XQuery eingebunden
<br> <br></p></li>
<li><p>SQL:2008
<br></p></li>
<li><p>Updates auf Sichten, logisches Löschen (TRUNCATE), …
<br> <br></p></li>
<li><p>SQL:2011
<br></p></li>
<li><p>Adds temporal data (PERIOD FOR)
<br> <br></p></li>
<li><p>SQL:2016
<br></p></li>
<li><p>Adds row pattern matching, polymorphic table functions, JSON.</p></li>
</ul>
</div>
<div class="section" id="sql-2008-struktur">
<h3><span class="section-number">9.1.4. </span>SQL:2008 Struktur<a class="headerlink" href="#sql-2008-struktur" title="Permalink to this headline">¶</a></h3>
<p>■ Part 1: Framework (SQL/Framework) – 82 Seiten
<br>
□ Überblick
<br><br>
■ Part 2: Foundation (SQL/Foundation) – 1316 Seiten
<br>
□ Datenmodell, DDL, DML, Abfragen
<br><br>
■ Part 3: Call-Level Interface (SQL/CLI) – 389 Seiten
<br>
□ Zugriff auf DBMS mittels Funktionsaufrufen aus anderen Programmiersprachen
<br><br>
■ Part 4: Persistent Stored Modules (SQL/PSM) – 188 Seiten
<br>
□ Prozedurale Erweiterungen
<br><br>
■ Part 9: Management of External Data (SQL/MED) – 484 Seiten
<br>
□ Neue Datentypen und Funktionen
<br><br>
■ Part 10: Object Language Bindings (SQL/OLB) – 396 Seiten
<br>
□ Auch (SQLJ); zur Einbettung von SQL in Java
<br><br>
■ Part 11: Information and Definition Schemas (SQL/Schemata) – 286 Seiten
<br>
□ DBMS werden selbst-beschreibend durch normierten Katalog
<br><br>
■ Part 13: SQL Routines and Types (SQL/JRT) – 198 Seiten
<br>
□ Externe Java Routinen als „stored procedures“
<br><br>
■ Part 14: XML-Related Specifications (SQL/XML) – 438 Seiten
<br>
□ XML Datentyp und Erweiterung von SQL um XQuery
<br><br>
=&gt; Zusammen: 3777 Seiten</p>
</div>
</div>
<div class="section" id="einfach-anfragen">
<h2><span class="section-number">9.2. </span>Einfach Anfragen<a class="headerlink" href="#einfach-anfragen" title="Permalink to this headline">¶</a></h2>
<div class="section" id="select-from-where">
<h3><span class="section-number">9.2.1. </span>SELECT … FROM … WHERE …<a class="headerlink" href="#select-from-where" title="Permalink to this headline">¶</a></h3>
<p>SQL-Anfragen folgen meist einer Drei-Zeilen-Struktur aus SELECT, FROM, WHERE, wobei SELECT und FROM in jeder SQL-Anfrage enthalten sein müssen. Das Schlüsselwort SELECT entspricht dem Projektionsoperator <span class="math notranslate nohighlight">\(\pi\)</span>, den wir aus dem Kapitel Relationale Algebra schon kennengelernt haben. Die FROM-Zeile gibt an von welchen Tabellen die Daten stammen sollen. WHERE entspricht gewissermaßen dem Selektionsoperator <span class="math notranslate nohighlight">\(\sigma\)</span>, hier werden also Bedingungen an  die Tupel gestellt die diese erfüllen sollen.</p>
<p>Betrachten wir folgendes Beispielschema für Filme, welches aus den vorherigen Kapiteln bekannt sein sollte. Wir möchten nun eine Anfrage formulieren, die uns alle Filme ausgibt, welche von Disney produziert und im Jahre 1990 erschienen sind.</p>
</div>
<div class="section" id="beispielschema">
<h3><span class="section-number">9.2.2. </span>Beispielschema<a class="headerlink" href="#beispielschema" title="Permalink to this headline">¶</a></h3>
<p><img alt="title" src="../_images/beispielschema.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT * </span>
<span class="c1">#FROM Film </span>
<span class="c1">#WHERE StudioName = &quot;Disney&quot; AND Jahr= 1990;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM Film WHERE StudioName = &#39;Disney&#39; AND Jahr= 1990&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
      <th>Laenge</th>
      <th>inFarbe</th>
      <th>StudioName</th>
      <th>ProduzentinID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
      <td>74</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shipwrecked</td>
      <td>1990</td>
      <td>92</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
      <td>77</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Wir benutzen SELECT *, wodurch uns alle Attribute der ausgewählten Tabelle ausgegeben werden, alternativ kann man auch SELECT Titel, Jahr, Laenge… machen. Da wir alle Filme ausgeben wollen, schreiben wir FROM Film, da wir Tupel aus der Tabelle Film wollen. Zuletzt selektieren wir die Tupel, die StudioName = “Disney” und Jahr = 1990 erfüllen.</p>
<p>In SQL wird Groß- und Kleinschreibung nicht beachtet, sowohl bei Schlüsselwörtern wie SELECT, FROM, WHERE usw., als auch bei Attribut- und Relationen.
<br><br>
D.h es gilt also:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">From</span> <span class="o">=</span> <span class="n">FROM</span> <span class="o">=</span> <span class="kn">from</span> <span class="o">=</span> <span class="n">FrOm</span>
</pre></div>
</div>
<br>
Und die folgenden Anfragen sind äquivalent:
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELect</span> <span class="n">vorNAMe</span> <span class="n">fROm</span> <span class="n">fiLM</span>
</pre></div>
</div>
<br>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SELECT</span> <span class="n">vorname</span> <span class="n">FROM</span> <span class="n">film</span>
</pre></div>
</div>
<p><br><br>
Anders ist es natürlich bei Konstanten:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>‘FROM‘ ≠ ‘from‘ ≠ from = FROM
</pre></div>
</div>
<p><br><br>
Trotzdem gilt als Konvention zur Lesbarkeit, dass Schlüsselwörter großgeschrieben werden und Schemaelemente klein.</p>
</div>
<div class="section" id="projektion-in-sql-select-pi">
<h3><span class="section-number">9.2.3. </span>Projektion in SQL (SELECT, <span class="math notranslate nohighlight">\(\pi\)</span>)<a class="headerlink" href="#projektion-in-sql-select-pi" title="Permalink to this headline">¶</a></h3>
<p>Wir betrachten nun die einzelnen Schlüsselwörter etwas genauer und starten mit der Projektion. In der SELECT Klausel werden Attribute von Relationen aufgelistet, die herausprojeziert werden sollen.
<br><br>
Im folgenden Beipiel wollen wir alle Attribute bzw. Spalten aus der Filmrelation ausgeben, der Stern “*” ist hier eine kürzere Schreibweise für alle Attribute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT * </span>
<span class="c1">#FROM Film</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot; SELECT * FROM Film&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
      <th>Laenge</th>
      <th>inFarbe</th>
      <th>StudioName</th>
      <th>ProduzentinID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Inside Out</td>
      <td>2015</td>
      <td>95</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Toy Story</td>
      <td>1999</td>
      <td>81</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Up</td>
      <td>2009</td>
      <td>96</td>
      <td>TRUE</td>
      <td>Pixar</td>
      <td>4567</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ratatouille</td>
      <td>2007</td>
      <td>111</td>
      <td>TRUE</td>
      <td>Pixar</td>
      <td>4567</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars</td>
      <td>1977</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Pinewood</td>
      <td>78910</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Star Trek</td>
      <td>1979</td>
      <td>132</td>
      <td>TRUE</td>
      <td>Paramount</td>
      <td>6789</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Lady Bird</td>
      <td>2017</td>
      <td>95</td>
      <td>TRUE</td>
      <td>Scott Rudin Productions</td>
      <td>3456</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Into the Wild</td>
      <td>2007</td>
      <td>148</td>
      <td>TRUE</td>
      <td>Paramount</td>
      <td>6789</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
      <td>134</td>
      <td>TRUE</td>
      <td>River Road</td>
      <td>4712</td>
    </tr>
    <tr>
      <th>9</th>
      <td>The Lighthouse</td>
      <td>2019</td>
      <td>109</td>
      <td>FALSE</td>
      <td>A24</td>
      <td>1748</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Roma</td>
      <td>2018</td>
      <td>135</td>
      <td>FALSE</td>
      <td>Participant</td>
      <td>5123</td>
    </tr>
    <tr>
      <th>11</th>
      <td>La Heine</td>
      <td>1995</td>
      <td>98</td>
      <td>FALSE</td>
      <td>NULL</td>
      <td>2212</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Total Recall</td>
      <td>1990</td>
      <td>113</td>
      <td>TRUE</td>
      <td>Fox</td>
      <td>3310</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Mamma Mia!</td>
      <td>2008</td>
      <td>108</td>
      <td>TRUE</td>
      <td>Littlestar Productions</td>
      <td>8871</td>
    </tr>
    <tr>
      <th>14</th>
      <td>The Dark Knight</td>
      <td>2008</td>
      <td>152</td>
      <td>TRUE</td>
      <td>Warner Bros.</td>
      <td>6035</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Pulp Fiction</td>
      <td>1994</td>
      <td>154</td>
      <td>TRUE</td>
      <td>A Band Apart</td>
      <td>7654</td>
    </tr>
    <tr>
      <th>16</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>142</td>
      <td>TRUE</td>
      <td>Village Roadshows</td>
      <td>8634</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Marvel Enterprises</td>
      <td>6362</td>
    </tr>
    <tr>
      <th>18</th>
      <td>La La Land</td>
      <td>2016</td>
      <td>128</td>
      <td>TRUE</td>
      <td>Summit Entertainment</td>
      <td>5123</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Moonlight</td>
      <td>2016</td>
      <td>124</td>
      <td>TRUE</td>
      <td>A24</td>
      <td>1748</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
      <td>74</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>21</th>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>158</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
    <tr>
      <th>22</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>148</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Shipwrecked</td>
      <td>1990</td>
      <td>92</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
      <td>77</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Gone with the Wind</td>
      <td>1939</td>
      <td>221</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es ist auch möglich konkret die Attributsnamen aufzulisten, die ausgegeben sollen werden. Im unteren Beispiel, geben wir nur die Spalten Titel, Jahr und inFarbe von der Filmrelation aus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel, Jahr, inFarbe </span>
<span class="c1">#FROM Film</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel, Jahr, inFarbe FROM Film&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
      <th>inFarbe</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Inside Out</td>
      <td>2015</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Toy Story</td>
      <td>1999</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Up</td>
      <td>2009</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ratatouille</td>
      <td>2007</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars</td>
      <td>1977</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Star Trek</td>
      <td>1979</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Lady Bird</td>
      <td>2017</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Into the Wild</td>
      <td>2007</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>9</th>
      <td>The Lighthouse</td>
      <td>2019</td>
      <td>FALSE</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Roma</td>
      <td>2018</td>
      <td>FALSE</td>
    </tr>
    <tr>
      <th>11</th>
      <td>La Heine</td>
      <td>1995</td>
      <td>FALSE</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Total Recall</td>
      <td>1990</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Mamma Mia!</td>
      <td>2008</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>14</th>
      <td>The Dark Knight</td>
      <td>2008</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Pulp Fiction</td>
      <td>1994</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>16</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>18</th>
      <td>La La Land</td>
      <td>2016</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Moonlight</td>
      <td>2016</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>21</th>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>22</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Shipwrecked</td>
      <td>1990</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
      <td>TRUE</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Gone with the Wind</td>
      <td>1939</td>
      <td>TRUE</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In der SELECT Klausel ist es auch möglich die Attributsnamen in der Ausgabetabelle umzubenennen. Die Ausgabe einer SQL-Anfrage ist immer eine Tabelle. Im unteren Beispiel projezieren wir die Attribute Titel, Jahr aus der Filmrelation und benennen die Attribute in unserer Ausgabetabelle zu Name,Zeit um.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel AS Name, Jahr AS Zeit </span>
<span class="c1">#FROM Film</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel AS Name, Jahr AS Zeit FROM Film&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Zeit</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Inside Out</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Toy Story</td>
      <td>1999</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Up</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ratatouille</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars</td>
      <td>1977</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Star Trek</td>
      <td>1979</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Lady Bird</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Into the Wild</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>9</th>
      <td>The Lighthouse</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Roma</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>11</th>
      <td>La Heine</td>
      <td>1995</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Total Recall</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Mamma Mia!</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>14</th>
      <td>The Dark Knight</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Pulp Fiction</td>
      <td>1994</td>
    </tr>
    <tr>
      <th>16</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Spider-Man</td>
      <td>2002</td>
    </tr>
    <tr>
      <th>18</th>
      <td>La La Land</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Moonlight</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>21</th>
      <td>House of Gucci</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>22</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Shipwrecked</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Gone with the Wind</td>
      <td>1939</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In der SELECT-Klausel ist es auch möglich arithmetische Ausdrücke zu benutzen. Im folgenden Beispiel werden Titel und Laenge der Filme herausprojeziert, wobei die Laenge direkt mit einer Konstanten multipliziert wird. Daher wird in der Ausgabetabelle die Laenge in Stunden und nicht in Minuten angegeben. Dementsprechend haben wir auch das Attribut Laenge in Stunden mit dem Umbenennungsoperator AS umbenannt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel, Laenge * 0.016667 AS Stunden </span>
<span class="c1">#FROM Film</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel, Laenge * 0.016667 AS Stunden FROM Film&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Stunden</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Inside Out</td>
      <td>1.583365</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Toy Story</td>
      <td>1.350027</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Up</td>
      <td>1.600032</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ratatouille</td>
      <td>1.850037</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars</td>
      <td>2.016707</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Star Trek</td>
      <td>2.200044</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Lady Bird</td>
      <td>1.583365</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Into the Wild</td>
      <td>2.466716</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Brokeback Mountain</td>
      <td>2.233378</td>
    </tr>
    <tr>
      <th>9</th>
      <td>The Lighthouse</td>
      <td>1.816703</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Roma</td>
      <td>2.250045</td>
    </tr>
    <tr>
      <th>11</th>
      <td>La Heine</td>
      <td>1.633366</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Total Recall</td>
      <td>1.883371</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Mamma Mia!</td>
      <td>1.800036</td>
    </tr>
    <tr>
      <th>14</th>
      <td>The Dark Knight</td>
      <td>2.533384</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Pulp Fiction</td>
      <td>2.566718</td>
    </tr>
    <tr>
      <th>16</th>
      <td>The Great Gatsby</td>
      <td>2.366714</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Spider-Man</td>
      <td>2.016707</td>
    </tr>
    <tr>
      <th>18</th>
      <td>La La Land</td>
      <td>2.133376</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Moonlight</td>
      <td>2.066708</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1.233358</td>
    </tr>
    <tr>
      <th>21</th>
      <td>House of Gucci</td>
      <td>2.633386</td>
    </tr>
    <tr>
      <th>22</th>
      <td>James Bond 007: Spectre</td>
      <td>2.466716</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Shipwrecked</td>
      <td>1.533364</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Rescuers Down Under</td>
      <td>1.283359</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Gone with the Wind</td>
      <td>3.683407</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Zudem ist es auch möglich, sich spezielle Konstanten ausgeben zu lassen. Im unteren Beispiel fügen wir der Ausgabetabelle eine neue Spalte hinzu, mit dem Namen inStunden, in der der String ‘std.’ steht</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel, Laenge * 0.016667 AS Stunden, ‘std.‘ AS inStunden </span>
<span class="c1">#FROM Film</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel, Laenge * 0.016667 AS Stunden, &#39;std.&#39; AS inStunden FROM Film&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Stunden</th>
      <th>inStunden</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Inside Out</td>
      <td>1.583365</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Toy Story</td>
      <td>1.350027</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Up</td>
      <td>1.600032</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ratatouille</td>
      <td>1.850037</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars</td>
      <td>2.016707</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Star Trek</td>
      <td>2.200044</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Lady Bird</td>
      <td>1.583365</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Into the Wild</td>
      <td>2.466716</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Brokeback Mountain</td>
      <td>2.233378</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>9</th>
      <td>The Lighthouse</td>
      <td>1.816703</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Roma</td>
      <td>2.250045</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>11</th>
      <td>La Heine</td>
      <td>1.633366</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Total Recall</td>
      <td>1.883371</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Mamma Mia!</td>
      <td>1.800036</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>14</th>
      <td>The Dark Knight</td>
      <td>2.533384</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Pulp Fiction</td>
      <td>2.566718</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>16</th>
      <td>The Great Gatsby</td>
      <td>2.366714</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Spider-Man</td>
      <td>2.016707</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>18</th>
      <td>La La Land</td>
      <td>2.133376</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Moonlight</td>
      <td>2.066708</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1.233358</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>21</th>
      <td>House of Gucci</td>
      <td>2.633386</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>22</th>
      <td>James Bond 007: Spectre</td>
      <td>2.466716</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Shipwrecked</td>
      <td>1.533364</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Rescuers Down Under</td>
      <td>1.283359</td>
      <td>std.</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Gone with the Wind</td>
      <td>3.683407</td>
      <td>std.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="selektion-in-sql-where-sigma">
<h3><span class="section-number">9.2.4. </span>Selektion in SQL (WHERE, <span class="math notranslate nohighlight">\(\sigma\)</span>)<a class="headerlink" href="#selektion-in-sql-where-sigma" title="Permalink to this headline">¶</a></h3>
<p>Die Selektion die wir aus der relationalen Algebra kennen wird in SQL mit dem Schlüsselwort WHERE ausgedrückt, nicht mit dem Schlüsselwort SELECT. Wie aus anderen Programmiersprachen bekannt, kann man in der WHERE-Klausel Bedinungen aufstellen.
<br><br>
Es gibt sechs Vergleichsoperatoren =, &lt;&gt;, &lt;, &gt;, &lt;=, &gt;=(gleich, ungleich, kleiner, größer, kleiner gleich, größer gleich), hier können Sie links und rechts der Vergleichsoperatoren Konstanten und Attribute einsetzen. Insbesondere ist es auch möglich Attribute in der WHERE-Klausel zu vergleichen, die nicht in der SELECT- Klausel herausprojeziert werden. Auch im WHERE kann man arithmetische Ausdrücke in die Bedinung einbauen wie in diesem Beispiel:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">Jahr</span> <span class="o">-</span> <span class="mi">1930</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">Jahr</span> <span class="o">-</span> <span class="mi">1930</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">100</span>
</pre></div>
</div>
<p>Und Konstanten und auch Variablen konkatenieren:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>‘Star‘ || ‘Wars‘ 
</pre></div>
</div>
<p>entspricht</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>‘StarWars‘
</pre></div>
</div>
<p>oder ein Beispiel mit Variablen:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Vorname</span> <span class="o">||</span> <span class="s1">&#39; &#39;</span> <span class="o">||</span> <span class="n">Nachname</span> <span class="o">=</span> <span class="s1">&#39;Luke Skywalker&#39;</span>
</pre></div>
</div>
<p>Hier werden die Variablen Vorname und Nachname mit einer Leerstelle konkateniert und verglichen, ob der String ‘Luke Skywalker’ entspricht.
<br><br>
Das Ergebnis der Vergleichsoperation in SQL ist dann ein Bool’escher Wert, als TRUE oder FALSE. Dementsprechend können mehrere Vergleichsoperatoren mit AND, OR und NOT verknüpft werden, wobei die Klammerungen auch den bekannten Regeln der Logik entsprechen.
<br><br>
Nur wenn die gesamte WHERE-Klausel zu TRUE evaluiert wird, werden die entsprechenden Tupel ausgegeben.</p>
<p>Im unteren Beispiel wollen wir jene Titel aus der Relation Film ausgeben, die nach dem Jahr 1970 erschienen und schwarz-weiß sind</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel </span>
<span class="c1">#FROM Film </span>
<span class="c1">#WHERE Jahr &gt; 1970 AND NOT inFarbe;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel FROM Film WHERE Jahr &gt; 1970 AND NOT inFarbe&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Inside Out</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Toy Story</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Up</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ratatouille</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Star Trek</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Lady Bird</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Into the Wild</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Brokeback Mountain</td>
    </tr>
    <tr>
      <th>9</th>
      <td>The Lighthouse</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Roma</td>
    </tr>
    <tr>
      <th>11</th>
      <td>La Heine</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Total Recall</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Mamma Mia!</td>
    </tr>
    <tr>
      <th>14</th>
      <td>The Dark Knight</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Pulp Fiction</td>
    </tr>
    <tr>
      <th>16</th>
      <td>The Great Gatsby</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Spider-Man</td>
    </tr>
    <tr>
      <th>18</th>
      <td>La La Land</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Moonlight</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
    </tr>
    <tr>
      <th>21</th>
      <td>House of Gucci</td>
    </tr>
    <tr>
      <th>22</th>
      <td>James Bond 007: Spectre</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Shipwrecked</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Rescuers Down Under</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In diesem Beispiel möchten wir wieder alle Filmtitel ausgeben, hier aber alle Filme die von MGM produziert wurden sind und nach dem Jahr 1970 erschienen sind oder kürzer als 90 min sind.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel </span>
<span class="c1">#FROM Film </span>
<span class="c1">#WHERE (Jahr &gt; 1970 OR Laenge &lt; 90) AND StudioName = &quot;MGM&quot;;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel FROM Film WHERE (Jahr &gt; 1970 OR Laenge &lt; 90) AND StudioName = &#39;MGM&#39;;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>House of Gucci</td>
    </tr>
    <tr>
      <th>1</th>
      <td>James Bond 007: Spectre</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="stringvergleiche">
<h3><span class="section-number">9.2.5. </span>Stringvergleiche<a class="headerlink" href="#stringvergleiche" title="Permalink to this headline">¶</a></h3>
<p>In SQL gibt es Datentypen unteranderem die Datentypen Array fester Länge, Buchstabenliste variabler Länge und Konstanten. Es sind viele Vergleiche über Datentypen hinweg erlaubt. In diesem Beispiel vergleichen wir eine Variable mit einer weiteren Variable und einer Stringkonstanten:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>foo _ _ _ _ _ = foo = ‘foo‘
</pre></div>
</div>
<p>Ebenfalls sind lexikographische Vergleiche mit den schon bekannten Vergleichsoperatoren =, &lt;, &gt;, &lt;=, &gt;=, &lt;&gt; möglich. Je nach verwendeter DBMS werden Sortierreihenfolge mit upper-case/lower-case andere behandelt</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;fodder&#39;</span> <span class="o">&lt;</span> <span class="s1">&#39;foo&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;bar&#39;</span> <span class="o">&lt;</span> <span class="s1">&#39;bargain&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="string-mustervergleiche-mit-like">
<h3><span class="section-number">9.2.6. </span>String-Mustervergleiche mit LIKE<a class="headerlink" href="#string-mustervergleiche-mit-like" title="Permalink to this headline">¶</a></h3>
<p>Mit dem LIKE Operator können Sie Stringteile miteinander vergleichen, also ob ein String einem gewissen Stringmuster folgt. Hierfür gibt es zwei spezielle Zeichen, einmal ‘%’, welches eine beliebige Sequenz von 0 oder mehr Zeichen entspricht und ‘_’, welches ein einzelnes beliebiges Zeichen steht. Hierfür ein Beispiel: Wir suchen jene Titel aus der Filmrelation, wo der Titel mit ‘Star’ beginnt, ein Leerzeichen folgt und 4 beliebige Zeichen folgen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel </span>
<span class="c1">#FROM Film WHERE Titel LIKE &quot;Star ____&quot;;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel FROM Film WHERE Titel LIKE &#39;Star ____&#39;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Star Trek</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Star Wars</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Hier suchen wir alle Titel, wo das Wort ‘War’ vorkommen muss. Sowohl vor dem ‘War’ als auch nachdem ‘War’ sind beliebige Zeichensequenzen erlaubt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel </span>
<span class="c1">#FROM Film </span>
<span class="c1">#WHERE Titel LIKE &quot;%War%&quot;;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel FROM Film WHERE Titel LIKE &#39;%War%&#39;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Star Wars</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="datum-und-uhrzeit">
<h3><span class="section-number">9.2.7. </span>Datum und Uhrzeit<a class="headerlink" href="#datum-und-uhrzeit" title="Permalink to this headline">¶</a></h3>
<p>In SQL gibt es auch Datentypen um Daten und Zeiten darzustellen.Der Datentyp DATE stellt ein Datumskonstante dar:
<br>
– DATE ‘YYYY-MM-DD‘
<br>
– DATE ‘1948-05-14‘
<br><br>
Zeitkonstanten werden mit dem Datentyp TIME dargestellt:
– TIME ‘HH:MM:SS.S‘
<br>
– TIME ‘15:00:02.5‘
<br><br>
Zeitstempel, also eine Kombination aus Datum und Zeit, werden mit dem Datentyp TIMESTAMP dargestellt:
<br>
– TIMESTAMP ‘1948-05-14 15:00:02.5‘
<br><br>
Auch dieses Datentypen können wieder miteinander ,in Form von Variablen und Konstanten, verglichen werden:
<br>
– TIME ‘15:00:02.5‘ &lt; TIME ‘15:02:02.5‘ ergibt TRUE
<br><br>
– ERSCHEINUNGSTAG &gt;= DATE ‘1949-11-12‘</p>
</div>
<div class="section" id="nullwerte">
<h3><span class="section-number">9.2.8. </span>Nullwerte<a class="headerlink" href="#nullwerte" title="Permalink to this headline">¶</a></h3>
<p>Nullwerte sind spezielle Datentypen, in SQL wird dieser als NULL dargestellt, auf Papier ist auch ⊥ geläufig. Es gibt mehrere Arten einen Nullwert zu interpretieren. Zum einen kann ein Nullwert bedeuten, dass ein Wert unbekannt ist, z.B kann es sein, dass der Geburtstag eines/r Schauspieler*in unbekannt ist. Eine weitere Interpretationsart ist, dass ein Wert eingetragen wurde der unzulässig ist, wie z.B ein Ehegatte eine eines/r Schauspieler*in. Zuletzt  können mit Nullwerten bestimmte Zellen oder Spalten maskiert werden, wie z.B bei einer unterdrückten Telefonnummer.
<br><br>
Bei dem Umgang mit Nullwerten gibt es verschiedene Regeln, die beachtet werden müssen. Wird NULL mit arithmetischen Operationen verknüpft, so ergibt sich aus der Verknüpfung wiederum NULL. Bei Vergleichen mit NULL ergibt der Wahrheitswert UNKNOWN und nicht NULL. Man muss auch beachten, dass NULL keine Konstante ist, sondern NULL erscheint als Attributwert, abhängig von dem DBMS gilt NULL = NULL oder NULL <span class="math notranslate nohighlight">\(\neq\)</span> NULL.
<br><br>
Beispiele: Sei der Wert von einer Variablen x NULL. Der Ausdruck x+3 ergibt NULL, da x NULL ist. Der Ausdruck NULL+3 ist unzulässig und kann so auch nicht geschrieben werden. Der Vergleich x=3 ergibt UNKNOWN, auch da x NULL ist.
<br>
<br>
Weiterhin kann in der WHERE-Klausel mit IS NULL und IS NOT NULL überprüft werden, ob ein Wert NULL its. Z.B:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Geburtstag</span> <span class="n">IS</span> <span class="n">NULL</span> 
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Geburtstag</span> <span class="n">IS</span> <span class="n">NOT</span> <span class="n">NULL</span>
</pre></div>
</div>
</div>
<div class="section" id="wahrheitswerte">
<h3><span class="section-number">9.2.9. </span>Wahrheitswerte<a class="headerlink" href="#wahrheitswerte" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>AND</p></th>
<th class="head"><p>true</p></th>
<th class="head"><p>unknown</p></th>
<th class="head"><p>false</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>true</strong></p></td>
<td><p>true</p></td>
<td><p>unknown</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-odd"><td><p><strong>unknown</strong></p></td>
<td><p>unknown</p></td>
<td><p>unknown</p></td>
<td><p>false</p></td>
</tr>
<tr class="row-even"><td><p><strong>false</strong></p></td>
<td><p>false</p></td>
<td><p>false</p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>OR</p></th>
<th class="head"><p>true</p></th>
<th class="head"><p>unknown</p></th>
<th class="head"><p>false</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>true</strong></p></td>
<td><p>true</p></td>
<td><p>true</p></td>
<td><p>true</p></td>
</tr>
<tr class="row-odd"><td><p><strong>unknown</strong></p></td>
<td><p>true</p></td>
<td><p>unknown</p></td>
<td><p>unknown</p></td>
</tr>
<tr class="row-even"><td><p><strong>false</strong></p></td>
<td><p>false</p></td>
<td><p>unknown</p></td>
<td><p>false</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>NOT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>true</strong></p></td>
</tr>
<tr class="row-odd"><td><p><strong>unknown</strong></p></td>
</tr>
<tr class="row-even"><td><p><strong>false</strong></p></td>
</tr>
</tbody>
</table>
<p>Nehmen wir an TRUE=1, FALSE=0 und UNKNOWN = ½. Dann ergeben sich folgende Rechenregeln:
<br>
AND: Minimum der beiden Werte
<br>
OR: Maximum der beiden Werte
<br>
NOT: 1 – Wert
<br><br>
Beispiele:
<br>
TRUE AND (FALSE OR NOT(UNKNOWN))
<br>
= MIN(1, MAX(0, (1 - ½ )))
<br>
= MIN(1, MAX(0, ½ )
<br>
= MIN(1, ½ ) = ½.
<br><br>
Zu beachten bei der Ausführungspriorität: NOT vor AND vor OR</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT * </span>
<span class="c1">#FROM Film </span>
<span class="c1">#WHERE Laenge &lt;= 90 </span>
<span class="c1">#OR Laenge &gt; 90; --Laenge &lt;= 90 == UNKNOWN und Länge &gt; 90</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM Film WHERE Laenge &lt;= 90 OR Laenge &gt; 90; --Laenge &lt;= 90 == UNKNOWN und Länge &gt; 90&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
      <th>Laenge</th>
      <th>inFarbe</th>
      <th>StudioName</th>
      <th>ProduzentinID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Inside Out</td>
      <td>2015</td>
      <td>95</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Toy Story</td>
      <td>1999</td>
      <td>81</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Up</td>
      <td>2009</td>
      <td>96</td>
      <td>TRUE</td>
      <td>Pixar</td>
      <td>4567</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ratatouille</td>
      <td>2007</td>
      <td>111</td>
      <td>TRUE</td>
      <td>Pixar</td>
      <td>4567</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars</td>
      <td>1977</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Pinewood</td>
      <td>78910</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Star Trek</td>
      <td>1979</td>
      <td>132</td>
      <td>TRUE</td>
      <td>Paramount</td>
      <td>6789</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Lady Bird</td>
      <td>2017</td>
      <td>95</td>
      <td>TRUE</td>
      <td>Scott Rudin Productions</td>
      <td>3456</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Into the Wild</td>
      <td>2007</td>
      <td>148</td>
      <td>TRUE</td>
      <td>Paramount</td>
      <td>6789</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
      <td>134</td>
      <td>TRUE</td>
      <td>River Road</td>
      <td>4712</td>
    </tr>
    <tr>
      <th>9</th>
      <td>The Lighthouse</td>
      <td>2019</td>
      <td>109</td>
      <td>FALSE</td>
      <td>A24</td>
      <td>1748</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Roma</td>
      <td>2018</td>
      <td>135</td>
      <td>FALSE</td>
      <td>Participant</td>
      <td>5123</td>
    </tr>
    <tr>
      <th>11</th>
      <td>La Heine</td>
      <td>1995</td>
      <td>98</td>
      <td>FALSE</td>
      <td>NULL</td>
      <td>2212</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Total Recall</td>
      <td>1990</td>
      <td>113</td>
      <td>TRUE</td>
      <td>Fox</td>
      <td>3310</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Mamma Mia!</td>
      <td>2008</td>
      <td>108</td>
      <td>TRUE</td>
      <td>Littlestar Productions</td>
      <td>8871</td>
    </tr>
    <tr>
      <th>14</th>
      <td>The Dark Knight</td>
      <td>2008</td>
      <td>152</td>
      <td>TRUE</td>
      <td>Warner Bros.</td>
      <td>6035</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Pulp Fiction</td>
      <td>1994</td>
      <td>154</td>
      <td>TRUE</td>
      <td>A Band Apart</td>
      <td>7654</td>
    </tr>
    <tr>
      <th>16</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>142</td>
      <td>TRUE</td>
      <td>Village Roadshows</td>
      <td>8634</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Marvel Enterprises</td>
      <td>6362</td>
    </tr>
    <tr>
      <th>18</th>
      <td>La La Land</td>
      <td>2016</td>
      <td>128</td>
      <td>TRUE</td>
      <td>Summit Entertainment</td>
      <td>5123</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Moonlight</td>
      <td>2016</td>
      <td>124</td>
      <td>TRUE</td>
      <td>A24</td>
      <td>1748</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
      <td>74</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>21</th>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>158</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
    <tr>
      <th>22</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>148</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Shipwrecked</td>
      <td>1990</td>
      <td>92</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
      <td>77</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Gone with the Wind</td>
      <td>1939</td>
      <td>221</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="sortierung">
<h3><span class="section-number">9.2.10. </span>Sortierung<a class="headerlink" href="#sortierung" title="Permalink to this headline">¶</a></h3>
<p>In SQL sind Sortierungen(ASC für aufsteigend bzw. DESC für absteigend) mit der ORDER BY Klausel möglich, welche an das Ende der Anfrage geschrieben wird. ASC wird als default gewählt:
<br><br>
ORDER BY &lt;Attributliste&gt; DESC/ASC
<br><br>
Im folgenden Beispiel wollen wir alle Attribute der Filmrelation ausgeben, welche von Disney produziert wurden und 1990 erschienen sind. Zusätzlich, soll die Ausgabe zuerst nach dem Attribut Laenge und folgend nach dem Attribut Titel aufsteigend sortiert werden.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT * </span>
<span class="c1">#FROM Film </span>
<span class="c1">#WHERE StudioName = &quot;Disney&quot; </span>
<span class="c1">#AND Jahr = 1990 ORDER BY Laenge, Titel;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM Film WHERE StudioName = &#39;Disney&#39; AND Jahr = 1990 ORDER BY Laenge,Titel;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
      <th>Laenge</th>
      <th>inFarbe</th>
      <th>StudioName</th>
      <th>ProduzentinID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
      <td>74</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
      <td>77</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Shipwrecked</td>
      <td>1990</td>
      <td>92</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Hier wird  zuerst nach Laenge aufsteigend sortiert und folgend nach Titel aber absteigend.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT * </span>
<span class="c1">#FROM Film </span>
<span class="c1">#WHERE StudioName = &quot;Disney&quot; </span>
<span class="c1">#AND Jahr = 1990 ORDER BY Laenge ASC, Titel DESC;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM Film WHERE StudioName = &#39;Disney&#39; AND Jahr = 1990 ORDER BY Laenge ASC, Titel DESC;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
      <th>Laenge</th>
      <th>inFarbe</th>
      <th>StudioName</th>
      <th>ProduzentinID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
      <td>74</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>1</th>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
      <td>77</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Shipwrecked</td>
      <td>1990</td>
      <td>92</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="anfragen-uber-mehrere-relationen">
<h2><span class="section-number">9.3. </span>Anfragen über mehrere Relationen<a class="headerlink" href="#anfragen-uber-mehrere-relationen" title="Permalink to this headline">¶</a></h2>
<div class="section" id="motivation">
<h3><span class="section-number">9.3.1. </span>Motivation<a class="headerlink" href="#motivation" title="Permalink to this headline">¶</a></h3>
<p>Die Hauptstärke der Relationalen Algebra ist die Kombination von Relationen. Erst durch die Kombination mehrerer Relationen sind viele interessante Anfragen möglich. In SQL ist das möglich, indem man die beteiligten Relationen in der FROM-Klausel nennt.</p>
</div>
<div class="section" id="kreuzprodukt-und-join">
<h3><span class="section-number">9.3.2. </span>Kreuzprodukt und Join<a class="headerlink" href="#kreuzprodukt-und-join" title="Permalink to this headline">¶</a></h3>
<p>Im folgenden Beispiel haben wir die Relationen Film(Titel, Jahr, Länge, inFarbe, StudioName, ProduzentinID) und
ManagerIn(Name, Adresse, ManagerinID, Gehalt) gegeben. Wir möchten nun alle Namen der Manager*Innen ausgeben, die einen Star Wars Film produziert haben. Hierfür müssen die Relationen Film und ManagerIn gejoint werden.Zuerst bilden wir das Kruezprodukt der beiden Relationen, indem wir in der FROM-Klausel die Relationen mit einem Komma getrennt nennen , so wird intern das Kreuzprodukt dieser beiden gebildet. Schließlich wenden  wir noch einmal die Selektionsbedingung an, also dass nur ManagerInnen die einen Star Wars Film produziert haben ausgegeben werden. Und zuletzt noch die Joinbedingung, undzwar dass ProduzentinID und ManagerinID im Kreuzprodukt übereinstimmen sollen. Falls die beiden Bedinungen erfüllt sind wird ein Ergebnistupel produziert. Hierbei ist noch zu beachten, dass die Reihenfolge der WHERE-Bedingungen irrelevant ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name </span>
<span class="c1">#FROM Film, ManagerIn </span>
<span class="c1">#WHERE Titel = &quot;Star Wars&quot; </span>
<span class="c1">#AND ProduzentinID = ManagerinID; </span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name FROM Film, ManagerIn WHERE Titel = &#39;Star Wars&#39; AND ProduzentinID = ManagerinID&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Paul Golding</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name </span>
<span class="c1">#FROM Film, ManagerIn --Kreuzprodukt</span>
<span class="c1">#WHERE Titel = ‘Star Wars‘--Selektionsbedingung </span>
<span class="c1">#AND ProduzentinID = ManagerinID; --Joinbedingung</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name </span>
<span class="c1">#FROM Film, ManagerIn </span>
<span class="c1">#WHERE Titel = &quot;Star Wars&quot; </span>
<span class="c1">#AND ProduzentinID = ManagerinID; </span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name FROM Film, ManagerIn WHERE Titel = &#39;Star Wars&#39; AND ProduzentinID = ManagerinID&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Paul Golding</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="uneindeutige-attributnamen">
<h3><span class="section-number">9.3.3. </span>Uneindeutige Attributnamen<a class="headerlink" href="#uneindeutige-attributnamen" title="Permalink to this headline">¶</a></h3>
<p>In diesem Beispiel haben wir die Relationen SchauspielerIn(Name, Adresse, Geschlecht, Geburtstag) und ManagerIn(Name, Adresse, ManagerinID, Gehalt) gegeben. Beide Relationen haben ein Attribut namens “Name”. Wir wollen nun die Namen der Schauspieler*Innen und Manager*Innen ausgeben, die die selbe Adresse haben. Wie im vorherigen Beispiel,bilden wir wieder das Kreuzprodukt beider. Da nur der Attributname der Relationen uneindeutig wäre, muss in der Anfrage immer ein Präfix vor das Attribut gesetzt werden. Auch bei keiner Uneindeutigkeit, kann man das Präfix schreiben, was manchmal as Lesen von SQL-Anfragen erleichtert.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT SchauspielerIn.Name, ManagerIn.Name </span>
<span class="c1">#FROM SchauspielerIn, ManagerIn </span>
<span class="c1">#WHERE SchauspielerIn.Adresse = ManagerIn.Adresse;</span>


<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT SchauspielerIn.Name, ManagerIn.Name FROM SchauspielerIn, ManagerIn WHERE SchauspielerIn.Adresse = ManagerIn.Adresse;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="tupelvariablen">
<h3><span class="section-number">9.3.4. </span>Tupelvariablen<a class="headerlink" href="#tupelvariablen" title="Permalink to this headline">¶</a></h3>
<p>In SQL ist es möglich einen Alias für eine Relation innerhalb einer Anfrage festzulegen. Dies ist sinnvoll, um die Tupeln, der beteiligten Relationen eindeutig zu Kennzeichnen, insbesondere wenn eine Relation mehrfach innerhalb einer Anfrage vorkommt. Umbenennung kann ebenfalls sinnvoll sein, um lange Relationennamen abzukürzen, um bessere Lesbarkeit zu schaffen. Ein Beispiel hierfür ist, z.B der Selfjoin im unteren Beispiel ,wo wir Schauspieler suchen, die zusammenleben. Und das Beispiel danach, wo wir Umbennenung zur Verkürzung der Anfrage benutzen.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SchauspielerIn</span> <span class="n">Star2</span>
</pre></div>
</div>
<p>ist äquivalent zu</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SchauspielerIn</span> <span class="n">AS</span> <span class="n">Star2</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Star1.Name, Star2.Name </span>
<span class="c1">#FROM SchauspielerIn Star1, SchauspielerIn Star2 </span>
<span class="c1">#WHERE Star1.Adresse = Star2.Adresse</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Star1.Name, Star2.Name FROM SchauspielerIn Star1, SchauspielerIn Star2 WHERE Star1.Adresse = Star2.Adresse&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arnold Schwarzenegger</td>
      <td>Arnold Schwarzenegger</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sharon Stone</td>
      <td>Sharon Stone</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Robert Pattinson</td>
      <td>Robert Pattinson</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Scarlet Johansson</td>
      <td>Scarlet Johansson</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saorise Ronan</td>
      <td>Saorise Ronan</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Jake Gyllenhaal</td>
      <td>Jake Gyllenhaal</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Heath Ledger</td>
      <td>Heath Ledger</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Mark Hamill</td>
      <td>Mark Hamill</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Carrie Fisher</td>
      <td>Carrie Fisher</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Harrison Ford</td>
      <td>Harrison Ford</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Emile Hirsch</td>
      <td>Emile Hirsch</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Vincent Cassel</td>
      <td>Léa Seydoux</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Vincent Cassel</td>
      <td>Vincent Cassel</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Meryl Streep</td>
      <td>Meryl Streep</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Cameron Diaz</td>
      <td>Cameron Diaz</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Cameron Diaz</td>
      <td>Leonardo DiCaprio</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Emma Stone</td>
      <td>Emma Stone</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Phyllis Smith</td>
      <td>Phyllis Smith</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Willem Dafoe</td>
      <td>Willem Dafoe</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Leonardo DiCaprio</td>
      <td>Cameron Diaz</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Leonardo DiCaprio</td>
      <td>Leonardo DiCaprio</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Tobey Maguire</td>
      <td>Kirsten Dunst</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Tobey Maguire</td>
      <td>Tobey Maguire</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Samuel L. Jackson</td>
      <td>Samuel L. Jackson</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Will Smith</td>
      <td>Will Smith</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Tom Hanks</td>
      <td>Tom Hanks</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Kirsten Dunst</td>
      <td>Kirsten Dunst</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Kirsten Dunst</td>
      <td>Tobey Maguire</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Ryan Gosling</td>
      <td>Jared Leto</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Ryan Gosling</td>
      <td>Ryan Gosling</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Mahershala Ali</td>
      <td>Mahershala Ali</td>
    </tr>
    <tr>
      <th>31</th>
      <td>William Shatner</td>
      <td>William Shatner</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Alan Young</td>
      <td>Alan Young</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Jared Leto</td>
      <td>Jared Leto</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Jared Leto</td>
      <td>Ryan Gosling</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Adam Driver</td>
      <td>Adam Driver</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Lady Gaga</td>
      <td>Lady Gaga</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Daniel Craig</td>
      <td>Daniel Craig</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Léa Seydoux</td>
      <td>Léa Seydoux</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Léa Seydoux</td>
      <td>Vincent Cassel</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Christoph Waltz</td>
      <td>Christoph Waltz</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT S.Name, M.Name</span>
<span class="c1">#FROM SchauspielerIn S, ManagerIn M</span>
<span class="c1">#WHERE S.Adresse = M.Adresse;</span>


<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT S.Name, M.Name FROM SchauspielerIn S, ManagerIn M WHERE S.Adresse = M.Adresse;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="tupelvariablen-selfjoin">
<h3><span class="section-number">9.3.5. </span>Tupelvariablen-Selfjoin<a class="headerlink" href="#tupelvariablen-selfjoin" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Star1.Name, Star2.Name</span>
<span class="c1">#FROM SchauspielerIn Star1, SchauspielerIn Star2</span>
<span class="c1">#WHERE Star1.Adresse = Star2.Adresse;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Star1.Name, Star2.Name FROM SchauspielerIn Star1, SchauspielerIn Star2 WHERE Star1.Adresse = Star2.Adresse;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arnold Schwarzenegger</td>
      <td>Arnold Schwarzenegger</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sharon Stone</td>
      <td>Sharon Stone</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Robert Pattinson</td>
      <td>Robert Pattinson</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Scarlet Johansson</td>
      <td>Scarlet Johansson</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saorise Ronan</td>
      <td>Saorise Ronan</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Jake Gyllenhaal</td>
      <td>Jake Gyllenhaal</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Heath Ledger</td>
      <td>Heath Ledger</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Mark Hamill</td>
      <td>Mark Hamill</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Carrie Fisher</td>
      <td>Carrie Fisher</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Harrison Ford</td>
      <td>Harrison Ford</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Emile Hirsch</td>
      <td>Emile Hirsch</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Vincent Cassel</td>
      <td>Léa Seydoux</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Vincent Cassel</td>
      <td>Vincent Cassel</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Meryl Streep</td>
      <td>Meryl Streep</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Cameron Diaz</td>
      <td>Cameron Diaz</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Cameron Diaz</td>
      <td>Leonardo DiCaprio</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Emma Stone</td>
      <td>Emma Stone</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Phyllis Smith</td>
      <td>Phyllis Smith</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Willem Dafoe</td>
      <td>Willem Dafoe</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Leonardo DiCaprio</td>
      <td>Cameron Diaz</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Leonardo DiCaprio</td>
      <td>Leonardo DiCaprio</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Tobey Maguire</td>
      <td>Kirsten Dunst</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Tobey Maguire</td>
      <td>Tobey Maguire</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Samuel L. Jackson</td>
      <td>Samuel L. Jackson</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Will Smith</td>
      <td>Will Smith</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Tom Hanks</td>
      <td>Tom Hanks</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Kirsten Dunst</td>
      <td>Kirsten Dunst</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Kirsten Dunst</td>
      <td>Tobey Maguire</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Ryan Gosling</td>
      <td>Jared Leto</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Ryan Gosling</td>
      <td>Ryan Gosling</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Mahershala Ali</td>
      <td>Mahershala Ali</td>
    </tr>
    <tr>
      <th>31</th>
      <td>William Shatner</td>
      <td>William Shatner</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Alan Young</td>
      <td>Alan Young</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Jared Leto</td>
      <td>Jared Leto</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Jared Leto</td>
      <td>Ryan Gosling</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Adam Driver</td>
      <td>Adam Driver</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Lady Gaga</td>
      <td>Lady Gaga</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Daniel Craig</td>
      <td>Daniel Craig</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Léa Seydoux</td>
      <td>Léa Seydoux</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Léa Seydoux</td>
      <td>Vincent Cassel</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Christoph Waltz</td>
      <td>Christoph Waltz</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Damit wir wie in der Ausgabe der obigen Beispiels, keine redundanten Tupel haben, setzten wir zusätzlich noch die Bedingung, dass die Namen der Schauspieler*Innen verschieden sein müssen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Star1.Name, Star2.Name</span>
<span class="c1">#FROM SchauspielerIn Star1, SchauspielerIn Star2</span>
<span class="c1">#WHERE Star1.Adresse = Star2.Adresse</span>
<span class="c1">#AND Star1.Name &lt;&gt; Star2.Name;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Star1.Name, Star2.Name FROM SchauspielerIn Star1, SchauspielerIn Star2 WHERE Star1.Adresse = Star2.Adresse AND Star1.Name &lt;&gt; Star2.Name;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Vincent Cassel</td>
      <td>Léa Seydoux</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Cameron Diaz</td>
      <td>Leonardo DiCaprio</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Leonardo DiCaprio</td>
      <td>Cameron Diaz</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Tobey Maguire</td>
      <td>Kirsten Dunst</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kirsten Dunst</td>
      <td>Tobey Maguire</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Ryan Gosling</td>
      <td>Jared Leto</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Jared Leto</td>
      <td>Ryan Gosling</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Léa Seydoux</td>
      <td>Vincent Cassel</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="interpretation-von-anfragen">
<h3><span class="section-number">9.3.6. </span>Interpretation von Anfragen<a class="headerlink" href="#interpretation-von-anfragen" title="Permalink to this headline">¶</a></h3>
<p>Anfragen können auf unterschiedlich Arten und Weisen interpretiert werden. Es gibt drie Interpretationsvarianten für Anfragen mit mehreren Relationen. Mit der Nested Loops(geschachtelte Schleifen) gibt es bei mehreren Tupelvariablen, für jede Variable eine geschachtelte Schleife. Bei der parallelen Zuordnung werden alle Kombinationen parallel bzgl. der Bedingungen geprüft. In der Relationen Algebra wird zuerst das Kreuzprodukt gebildet und dann auf jedes Resulat-Tupel die Selektionsbedingungen angewendet.
<br>
<br>
Im folgenden Beispiel sind die Relationen R(A), S(A) und T(A) mit dem selben Attribut A gegeben. Wir suchen die folgenden Tupel R  ∩  (S  ∪  T) (= (R  ∩  S)  ∪  (R  ∩  T) ). Nehmen wir an dass T leer sei, das vermeintliche Resultat ist R  ∩  S. Mit Nested Loops ist das Ergebnis jedoch leer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT R.A</span>
<span class="c1">#FROM R, S, T</span>
<span class="c1">#WHERE R.A = S.A</span>
<span class="c1">#OR R.A = T.A;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT R.A FROM R, S, T WHERE R.A = S.A OR R.A = T.A;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;rst/rst.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Im folgenden Beispiel ist das Ergebnis mit Nested Loops nicht leer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT *</span>
<span class="c1">#FROM</span>
<span class="c1">#(</span>
<span class="c1">#    (SELECT A FROM R)</span>
<span class="c1">#     INTERSECT</span>
<span class="c1">#    (SELECT * FROM</span>
<span class="c1">#     (SELECT A FROM S)</span>
<span class="c1">#      UNION</span>
<span class="c1">#    (SELECT A FROM T)</span>
<span class="c1">#   )</span>
<span class="c1">#)</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM (SELECT A FROM R INTERSECT SELECT * FROM (SELECT A FROM S) UNION SELECT A FROM T)&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;rst/rst.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="joins">
<h3><span class="section-number">9.3.7. </span>Joins<a class="headerlink" href="#joins" title="Permalink to this headline">¶</a></h3>
<p><img alt="title" src="../_images/joins.jpg" /></p>
<p>Bis hierhin haben wir Joins nur mit Komma zwischen den Relationennamen in der FROM-Klausel und der Joinbedingung in der WHERE-Klausel kennengelernt. Kreuzprodukte können auch mit CROSS JOIN ausgedrückt werden,z.B Film CROSS JOIN spielt_in, hier werden direkt doppelte Attributnamen mit Präfix der Relation schon aufgelöst.
<br><br>
Ein Beispiel für ein Theta-Join finden wir unten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT * </span>
<span class="c1">#FROM Film JOIN spielt_in ON Titel = FilmTitel </span>
<span class="c1">#AND Jahr = FilmJahr</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM Film JOIN spielt_in ON Titel = FilmTitel AND Jahr = FilmJahr&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
      <th>Laenge</th>
      <th>inFarbe</th>
      <th>StudioName</th>
      <th>ProduzentinID</th>
      <th>FilmTitel</th>
      <th>FilmJahr</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Star Wars</td>
      <td>1977</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Pinewood</td>
      <td>78910</td>
      <td>Star Wars</td>
      <td>1977</td>
      <td>Mark Hamill</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Star Wars</td>
      <td>1977</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Pinewood</td>
      <td>78910</td>
      <td>Star Wars</td>
      <td>1977</td>
      <td>Harrison Ford</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Star Wars</td>
      <td>1977</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Pinewood</td>
      <td>78910</td>
      <td>Star Wars</td>
      <td>1977</td>
      <td>Carrie Fisher</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Into the Wild</td>
      <td>2007</td>
      <td>148</td>
      <td>TRUE</td>
      <td>Paramount</td>
      <td>6789</td>
      <td>Into the Wild</td>
      <td>2007</td>
      <td>Emile Hirsch</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
      <td>134</td>
      <td>TRUE</td>
      <td>River Road</td>
      <td>4712</td>
      <td>Brokeback Mountain</td>
      <td>2005</td>
      <td>Jake Gyllenhaal</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
      <td>134</td>
      <td>TRUE</td>
      <td>River Road</td>
      <td>4712</td>
      <td>Brokeback Mountain</td>
      <td>2005</td>
      <td>Heath Ledger</td>
    </tr>
    <tr>
      <th>6</th>
      <td>The Dark Knight</td>
      <td>2008</td>
      <td>152</td>
      <td>TRUE</td>
      <td>Warner Bros.</td>
      <td>6035</td>
      <td>The Dark Knight</td>
      <td>2008</td>
      <td>Heath Ledger</td>
    </tr>
    <tr>
      <th>7</th>
      <td>The Lighthouse</td>
      <td>2019</td>
      <td>109</td>
      <td>FALSE</td>
      <td>A24</td>
      <td>1748</td>
      <td>The Lighthouse</td>
      <td>2019</td>
      <td>Robert Pattinson</td>
    </tr>
    <tr>
      <th>8</th>
      <td>The Lighthouse</td>
      <td>2019</td>
      <td>109</td>
      <td>FALSE</td>
      <td>A24</td>
      <td>1748</td>
      <td>The Lighthouse</td>
      <td>2019</td>
      <td>Willem Dafoe</td>
    </tr>
    <tr>
      <th>9</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>142</td>
      <td>TRUE</td>
      <td>Village Roadshows</td>
      <td>8634</td>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>Leonardo DiCaprio</td>
    </tr>
    <tr>
      <th>10</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>142</td>
      <td>TRUE</td>
      <td>Village Roadshows</td>
      <td>8634</td>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>Tobey Maguire</td>
    </tr>
    <tr>
      <th>11</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>142</td>
      <td>TRUE</td>
      <td>Village Roadshows</td>
      <td>8634</td>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>Carey Mulligan</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Lady Bird</td>
      <td>2017</td>
      <td>95</td>
      <td>TRUE</td>
      <td>Scott Rudin Productions</td>
      <td>3456</td>
      <td>Lady Bird</td>
      <td>2017</td>
      <td>Saoirse Ronan</td>
    </tr>
    <tr>
      <th>13</th>
      <td>La Heine</td>
      <td>1995</td>
      <td>98</td>
      <td>FALSE</td>
      <td>NULL</td>
      <td>2212</td>
      <td>La Heine</td>
      <td>1995</td>
      <td>Vincent Cassel</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Mamma Mia!</td>
      <td>2008</td>
      <td>108</td>
      <td>TRUE</td>
      <td>Littlestar Productions</td>
      <td>8871</td>
      <td>Mamma Mia!</td>
      <td>2008</td>
      <td>Meryl Streep</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Inside Out</td>
      <td>2015</td>
      <td>95</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
      <td>Inside Out</td>
      <td>2015</td>
      <td>Phyllis Smith</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Total Recall</td>
      <td>1990</td>
      <td>113</td>
      <td>TRUE</td>
      <td>Fox</td>
      <td>3310</td>
      <td>Total Recall</td>
      <td>1990</td>
      <td>Arnold Schwarzenegger</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Total Recall</td>
      <td>1990</td>
      <td>113</td>
      <td>TRUE</td>
      <td>Fox</td>
      <td>3310</td>
      <td>Total Recall</td>
      <td>1990</td>
      <td>Sharon Stone</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Pulp Fiction</td>
      <td>1994</td>
      <td>154</td>
      <td>TRUE</td>
      <td>A Band Apart</td>
      <td>7654</td>
      <td>Pulp Fiction</td>
      <td>1994</td>
      <td>Samuel L. Jackson</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Up</td>
      <td>2009</td>
      <td>96</td>
      <td>TRUE</td>
      <td>Pixar</td>
      <td>4567</td>
      <td>Up</td>
      <td>2009</td>
      <td>Tom Hanks</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Marvel Enterprises</td>
      <td>6362</td>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>Tobey Maguire</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Marvel Enterprises</td>
      <td>6362</td>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>Willem Dafoe</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Marvel Enterprises</td>
      <td>6362</td>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>Kirsten Dunst</td>
    </tr>
    <tr>
      <th>23</th>
      <td>La La Land</td>
      <td>2016</td>
      <td>128</td>
      <td>TRUE</td>
      <td>Summit Entertainment</td>
      <td>5123</td>
      <td>La La Land</td>
      <td>2016</td>
      <td>Emma Stone</td>
    </tr>
    <tr>
      <th>24</th>
      <td>La La Land</td>
      <td>2016</td>
      <td>128</td>
      <td>TRUE</td>
      <td>Summit Entertainment</td>
      <td>5123</td>
      <td>La La Land</td>
      <td>2016</td>
      <td>Ryan Gosling</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Moonlight</td>
      <td>2016</td>
      <td>124</td>
      <td>TRUE</td>
      <td>A24</td>
      <td>1748</td>
      <td>Moonlight</td>
      <td>2016</td>
      <td>Mahershala Ali</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Star Trek</td>
      <td>1979</td>
      <td>132</td>
      <td>TRUE</td>
      <td>Paramount</td>
      <td>6789</td>
      <td>Star Trek</td>
      <td>1979</td>
      <td>William Shatner</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
      <td>74</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
      <td>Alan Young</td>
    </tr>
    <tr>
      <th>28</th>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>158</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>Jared Leto</td>
    </tr>
    <tr>
      <th>29</th>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>158</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>Adam Driver</td>
    </tr>
    <tr>
      <th>30</th>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>158</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>Lady Gaga</td>
    </tr>
    <tr>
      <th>31</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>148</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>Daniel Craig</td>
    </tr>
    <tr>
      <th>32</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>148</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>Léa Seydoux</td>
    </tr>
    <tr>
      <th>33</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>148</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>Christoph Waltz</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Beim JOIN werden im Vergleich zum CROSS JOIN die redundanten Attribute eliminiert. Damit das geschieht muss natürlich ein Fremdschlüsselbeziehung vorhanden sein oder die Attributnamen müssen identisch sein. Hier wie im unteren Beispiel gezeigt, werden also FilmTitel und FilmJahr eliminiert.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel, Jahr, Laenge, inFarbe, StudioName, ProduzentinID, Name </span>
<span class="c1">#FROM Film JOIN spielt_in ON Titel = FilmTitel </span>
<span class="c1">#AND Jahr = FilmJahr;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel, Jahr, Laenge, inFarbe, StudioName, ProduzentinID, Name FROM Film JOIN spielt_in ON Titel = FilmTitel AND Jahr = FilmJahr;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
      <th>Laenge</th>
      <th>inFarbe</th>
      <th>StudioName</th>
      <th>ProduzentinID</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Star Wars</td>
      <td>1977</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Pinewood</td>
      <td>78910</td>
      <td>Mark Hamill</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Star Wars</td>
      <td>1977</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Pinewood</td>
      <td>78910</td>
      <td>Harrison Ford</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Star Wars</td>
      <td>1977</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Pinewood</td>
      <td>78910</td>
      <td>Carrie Fisher</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Into the Wild</td>
      <td>2007</td>
      <td>148</td>
      <td>TRUE</td>
      <td>Paramount</td>
      <td>6789</td>
      <td>Emile Hirsch</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
      <td>134</td>
      <td>TRUE</td>
      <td>River Road</td>
      <td>4712</td>
      <td>Jake Gyllenhaal</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
      <td>134</td>
      <td>TRUE</td>
      <td>River Road</td>
      <td>4712</td>
      <td>Heath Ledger</td>
    </tr>
    <tr>
      <th>6</th>
      <td>The Dark Knight</td>
      <td>2008</td>
      <td>152</td>
      <td>TRUE</td>
      <td>Warner Bros.</td>
      <td>6035</td>
      <td>Heath Ledger</td>
    </tr>
    <tr>
      <th>7</th>
      <td>The Lighthouse</td>
      <td>2019</td>
      <td>109</td>
      <td>FALSE</td>
      <td>A24</td>
      <td>1748</td>
      <td>Robert Pattinson</td>
    </tr>
    <tr>
      <th>8</th>
      <td>The Lighthouse</td>
      <td>2019</td>
      <td>109</td>
      <td>FALSE</td>
      <td>A24</td>
      <td>1748</td>
      <td>Willem Dafoe</td>
    </tr>
    <tr>
      <th>9</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>142</td>
      <td>TRUE</td>
      <td>Village Roadshows</td>
      <td>8634</td>
      <td>Leonardo DiCaprio</td>
    </tr>
    <tr>
      <th>10</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>142</td>
      <td>TRUE</td>
      <td>Village Roadshows</td>
      <td>8634</td>
      <td>Tobey Maguire</td>
    </tr>
    <tr>
      <th>11</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
      <td>142</td>
      <td>TRUE</td>
      <td>Village Roadshows</td>
      <td>8634</td>
      <td>Carey Mulligan</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Lady Bird</td>
      <td>2017</td>
      <td>95</td>
      <td>TRUE</td>
      <td>Scott Rudin Productions</td>
      <td>3456</td>
      <td>Saoirse Ronan</td>
    </tr>
    <tr>
      <th>13</th>
      <td>La Heine</td>
      <td>1995</td>
      <td>98</td>
      <td>FALSE</td>
      <td>NULL</td>
      <td>2212</td>
      <td>Vincent Cassel</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Mamma Mia!</td>
      <td>2008</td>
      <td>108</td>
      <td>TRUE</td>
      <td>Littlestar Productions</td>
      <td>8871</td>
      <td>Meryl Streep</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Inside Out</td>
      <td>2015</td>
      <td>95</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
      <td>Phyllis Smith</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Total Recall</td>
      <td>1990</td>
      <td>113</td>
      <td>TRUE</td>
      <td>Fox</td>
      <td>3310</td>
      <td>Arnold Schwarzenegger</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Total Recall</td>
      <td>1990</td>
      <td>113</td>
      <td>TRUE</td>
      <td>Fox</td>
      <td>3310</td>
      <td>Sharon Stone</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Pulp Fiction</td>
      <td>1994</td>
      <td>154</td>
      <td>TRUE</td>
      <td>A Band Apart</td>
      <td>7654</td>
      <td>Samuel L. Jackson</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Up</td>
      <td>2009</td>
      <td>96</td>
      <td>TRUE</td>
      <td>Pixar</td>
      <td>4567</td>
      <td>Tom Hanks</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Marvel Enterprises</td>
      <td>6362</td>
      <td>Tobey Maguire</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Marvel Enterprises</td>
      <td>6362</td>
      <td>Willem Dafoe</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Spider-Man</td>
      <td>2002</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Marvel Enterprises</td>
      <td>6362</td>
      <td>Kirsten Dunst</td>
    </tr>
    <tr>
      <th>23</th>
      <td>La La Land</td>
      <td>2016</td>
      <td>128</td>
      <td>TRUE</td>
      <td>Summit Entertainment</td>
      <td>5123</td>
      <td>Emma Stone</td>
    </tr>
    <tr>
      <th>24</th>
      <td>La La Land</td>
      <td>2016</td>
      <td>128</td>
      <td>TRUE</td>
      <td>Summit Entertainment</td>
      <td>5123</td>
      <td>Ryan Gosling</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Moonlight</td>
      <td>2016</td>
      <td>124</td>
      <td>TRUE</td>
      <td>A24</td>
      <td>1748</td>
      <td>Mahershala Ali</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Star Trek</td>
      <td>1979</td>
      <td>132</td>
      <td>TRUE</td>
      <td>Paramount</td>
      <td>6789</td>
      <td>William Shatner</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
      <td>74</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
      <td>Alan Young</td>
    </tr>
    <tr>
      <th>28</th>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>158</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>Jared Leto</td>
    </tr>
    <tr>
      <th>29</th>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>158</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>Adam Driver</td>
    </tr>
    <tr>
      <th>30</th>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>158</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>Lady Gaga</td>
    </tr>
    <tr>
      <th>31</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>148</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>Daniel Craig</td>
    </tr>
    <tr>
      <th>32</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>148</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>Léa Seydoux</td>
    </tr>
    <tr>
      <th>33</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>148</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
      <td>Christoph Waltz</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es ist ebenfalls möglich mehrere Joins hintereinander durchzuführen, wie im Beispiel unten gezeigt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel, Jahr </span>
<span class="c1">#FROM Film JOIN spielt_in ON Titel = FilmTitel </span>
<span class="c1">#AND Jahr = FilmJahr JOIN SchauspielerIn ON spielt_in.Name = SchauspielerIn.Name </span>
<span class="c1">#WHERE Geschlecht = &quot;f&quot;;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel, Jahr FROM Film JOIN spielt_in ON Titel = FilmTitel AND Jahr = FilmJahr JOIN SchauspielerIn ON spielt_in.Name = SchauspielerIn.Name WHERE Geschlecht = &#39;f&#39;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Star Wars</td>
      <td>1977</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mamma Mia!</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Inside Out</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Total Recall</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Spider-Man</td>
      <td>2002</td>
    </tr>
    <tr>
      <th>5</th>
      <td>La La Land</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>6</th>
      <td>House of Gucci</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>7</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="the-tpc-h-schema">
<h3><span class="section-number">9.3.8. </span>The TPC-H Schema<a class="headerlink" href="#the-tpc-h-schema" title="Permalink to this headline">¶</a></h3>
<p><img alt="title" src="../_images/tpc-h_schema.jpg" /></p>
<p>Das TPC-H ist ein Benchmark, dessen Datensätze zufällig generiert werden. Die Daten sind an Unternehmen und ihren Handelsketten orientiert. Datenbankentwickler*\Innen benutzen TPC-H ,um neu entwickelte Systeme zu testen.<br />
<br><br>
Eine Beispielanfrage für das TPC-H Schema finden Sie unten.</p>
<div class="section" id="tpc-query-minimum-cost-supplier">
<h4><span class="section-number">9.3.8.1. </span>TPC Query - Minimum Cost Supplier<a class="headerlink" href="#tpc-query-minimum-cost-supplier" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%sql</span>
<span class="c1">#SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone,</span>
<span class="c1">#s_comment</span>
<span class="c1">#FROM part, supplier, partsupp, nation, region</span>
<span class="c1">#WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey</span>
<span class="c1">#AND p_size = 2 AND p_type like &#39;PROMO PLATED TIN&#39;</span>
<span class="c1">#AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey</span>
<span class="c1">#AND r_name = &#39;EUROPE&#39;</span>
<span class="c1">#AND ps_supplycost =</span>
<span class="c1">#(SELECT min(ps_supplycost)</span>
<span class="c1">#FROM partsupp, supplier, nation, region</span>
<span class="c1">#WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey</span>
<span class="c1">#AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey</span>
<span class="c1">#AND r_name = &#39;EUROPE&#39; )</span>
<span class="c1">#ORDER BY s_acctbal desc, n_name, s_name, p_partkey;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT s_acctbal, s_name, n_name, p_partkey, p_mfgr, s_address, s_phone, s_comment FROM part, supplier, partsupp, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND p_size = 2 AND p_type like &#39;PROMO PLATED TIN&#39; AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = &#39;EUROPE&#39; AND ps_supplycost = (SELECT min(ps_supplycost) FROM partsupp, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND s_nationkey = n_nationkey AND n_regionkey = r_regionkey AND r_name = &#39;EUROPE&#39; ) ORDER BY s_acctbal desc, n_name, s_name, p_partkey;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;salesDB/salesDB&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>S_ACCTBAL</th>
      <th>S_NAME</th>
      <th>N_NAME</th>
      <th>P_PARTKEY</th>
      <th>P_MFGR</th>
      <th>S_ADDRESS</th>
      <th>S_PHONE</th>
      <th>S_COMMENT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1687.81</td>
      <td>Supplier#000000017</td>
      <td>ROMANIA</td>
      <td>16</td>
      <td>Manufacturer#3</td>
      <td>c2d,ESHRSkK3WYnxpgw6aOqN0q</td>
      <td>29-601-884-9219</td>
      <td>eep against the furiously bold ideas. fluffily...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="the-tpc-h-universal-table">
<h4><span class="section-number">9.3.8.2. </span>The TPC-H Universal Table<a class="headerlink" href="#the-tpc-h-universal-table" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%sql</span>
<span class="c1">#SELECT l_linenumber, l_quantity, l_extendedprice, l_discount, l_tax, l_returnflag, l_linestatus, l_shipdate, l_commitdate, l_receiptdate, l_shipinstruct, l_shipmode, l_comment, o_orderkey, o_orderstatus, o_totalprice, o_orderdate, o_orderpriority, o_clerk, o_shippriority, o_comment, ps_availqty, ps_supplycost, ps_comment, p_partkey, p_name, p_mfgr, p_brand, p_type, p_size, p_container, p_retailprice, p_comment, c_custkey, c_name, c_address, c_phone, c_acctbal, c_mktsegment, c_comment, s_suppkey, s_name, s_address, s_phone, s_acctbal, s_comment, n_nationkey, n_name, n_comment, r_regionkey, r_name, r_comment</span>
<span class="c1">#FROM lineitem, orders, partsupp, part, customer, supplier, nation, region</span>
<span class="c1">#WHERE p_partkey = ps_partkey</span>
<span class="c1">#AND s_suppkey = ps_suppkey</span>
<span class="c1">#AND n_nationkey = s_nationkey</span>
<span class="c1">#AND r_regionkey = n_regionkey</span>
<span class="c1">#AND c_custkey = o_custkey</span>
<span class="c1">#AND ps_partkey = l_partkey</span>
<span class="c1">#AND ps_suppkey = l_suppkey</span>
<span class="c1">#AND o_orderkey = l_orderkey</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT l_linenumber, l_quantity, l_extendedprice, l_discount, l_tax, l_returnflag, l_linestatus, l_shipdate, l_commitdate, l_receiptdate, l_shipinstruct, l_shipmode, l_comment, o_orderkey, o_orderstatus, o_totalprice, o_orderdate, o_orderpriority, o_clerk, o_shippriority, o_comment, ps_availqty, ps_supplycost, ps_comment, p_partkey, p_name, p_mfgr, p_brand, p_type, p_size, p_container, p_retailprice, p_comment, c_custkey, c_name, c_address, c_phone, c_acctbal, c_mktsegment, c_comment, s_suppkey, s_name, s_address, s_phone, s_acctbal, s_comment, n_nationkey, n_name, n_comment, r_regionkey, r_name, r_comment FROM lineitem, orders, partsupp, part, customer, supplier, nation, region WHERE p_partkey = ps_partkey AND s_suppkey = ps_suppkey AND n_nationkey = s_nationkey AND r_regionkey = n_regionkey AND c_custkey = o_custkey AND ps_partkey = l_partkey AND ps_suppkey = l_suppkey AND o_orderkey = l_orderkey&quot;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>L_LINENUMBER</th>
      <th>L_QUANTITY</th>
      <th>L_EXTENDEDPRICE</th>
      <th>L_DISCOUNT</th>
      <th>L_TAX</th>
      <th>L_RETURNFLAG</th>
      <th>L_LINESTATUS</th>
      <th>L_SHIPDATE</th>
      <th>L_COMMITDATE</th>
      <th>L_RECEIPTDATE</th>
      <th>...</th>
      <th>S_ADDRESS</th>
      <th>S_PHONE</th>
      <th>S_ACCTBAL</th>
      <th>S_COMMENT</th>
      <th>N_NATIONKEY</th>
      <th>N_NAME</th>
      <th>N_COMMENT</th>
      <th>R_REGIONKEY</th>
      <th>R_NAME</th>
      <th>R_COMMENT</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>17</td>
      <td>24710.35</td>
      <td>0.04</td>
      <td>0.02</td>
      <td>N</td>
      <td>O</td>
      <td>1996-03-13</td>
      <td>1996-02-12</td>
      <td>1996-03-22</td>
      <td>...</td>
      <td>wd1djjKXT,4zBm</td>
      <td>26-528-528-1157</td>
      <td>368.76</td>
      <td>yly final accounts could are carefully. fluffi...</td>
      <td>16</td>
      <td>MOZAMBIQUE</td>
      <td>s. ironic, unusual asymptotes wake blithely r</td>
      <td>0</td>
      <td>AFRICA</td>
      <td>lar deposits. blithely final packages cajole. ...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>36</td>
      <td>56688.12</td>
      <td>0.09</td>
      <td>0.06</td>
      <td>N</td>
      <td>O</td>
      <td>1996-04-12</td>
      <td>1996-02-28</td>
      <td>1996-04-20</td>
      <td>...</td>
      <td>7f3gN4rP1livII</td>
      <td>28-716-704-8686</td>
      <td>-224.84</td>
      <td>eans. even, silent packages c</td>
      <td>18</td>
      <td>CHINA</td>
      <td>c dependencies. furiously express notornis sle...</td>
      <td>2</td>
      <td>ASIA</td>
      <td>ges. thinly even pinto beans ca</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>8</td>
      <td>12301.04</td>
      <td>0.10</td>
      <td>0.02</td>
      <td>N</td>
      <td>O</td>
      <td>1996-01-29</td>
      <td>1996-03-05</td>
      <td>1996-01-31</td>
      <td>...</td>
      <td>xEcx45vD0FXHT7c9mvWFY</td>
      <td>14-361-296-6426</td>
      <td>2512.41</td>
      <td>ins. fluffily special accounts haggle slyly af</td>
      <td>4</td>
      <td>EGYPT</td>
      <td>y above the carefully unusual theodolites. fin...</td>
      <td>4</td>
      <td>MIDDLE EAST</td>
      <td>uickly special accounts cajole carefully blith...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>28</td>
      <td>25816.56</td>
      <td>0.09</td>
      <td>0.06</td>
      <td>N</td>
      <td>O</td>
      <td>1996-04-21</td>
      <td>1996-03-30</td>
      <td>1996-05-16</td>
      <td>...</td>
      <td>jg0U FNPMQDuyuKvTnLXXaLf3Wl6OtONA6mQlWJ</td>
      <td>24-722-551-9498</td>
      <td>5630.62</td>
      <td>xpress instructions affix. fluffily even reque...</td>
      <td>14</td>
      <td>KENYA</td>
      <td>pending excuses haggle furiously deposits. pe...</td>
      <td>0</td>
      <td>AFRICA</td>
      <td>lar deposits. blithely final packages cajole. ...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>24</td>
      <td>27389.76</td>
      <td>0.10</td>
      <td>0.04</td>
      <td>N</td>
      <td>O</td>
      <td>1996-03-30</td>
      <td>1996-03-14</td>
      <td>1996-04-01</td>
      <td>...</td>
      <td>ssetugTcXc096qlD7 2TL5crEEeS3zk</td>
      <td>19-559-422-5776</td>
      <td>5926.41</td>
      <td>ges could have to are ironic deposits. regular...</td>
      <td>9</td>
      <td>INDONESIA</td>
      <td>slyly express asymptotes. regular deposits ha...</td>
      <td>2</td>
      <td>ASIA</td>
      <td>ges. thinly even pinto beans ca</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>60170</th>
      <td>2</td>
      <td>23</td>
      <td>40131.32</td>
      <td>0.05</td>
      <td>0.03</td>
      <td>N</td>
      <td>O</td>
      <td>1995-08-09</td>
      <td>1995-06-08</td>
      <td>1995-08-23</td>
      <td>...</td>
      <td>kERxlLDnlIZJdN66zAPHklyL</td>
      <td>17-713-930-5667</td>
      <td>9759.38</td>
      <td>x. carefully quiet account</td>
      <td>7</td>
      <td>GERMANY</td>
      <td>l platelets. regular accounts x-ray: unusual, ...</td>
      <td>3</td>
      <td>EUROPE</td>
      <td>ly final courts cajole furiously final excuse</td>
    </tr>
    <tr>
      <th>60171</th>
      <td>3</td>
      <td>45</td>
      <td>43112.25</td>
      <td>0.02</td>
      <td>0.02</td>
      <td>R</td>
      <td>F</td>
      <td>1995-05-15</td>
      <td>1995-05-31</td>
      <td>1995-06-03</td>
      <td>...</td>
      <td>NlV0OQyIoPvPkw5AYuWGomX,hgqm1</td>
      <td>15-781-401-3047</td>
      <td>5742.03</td>
      <td>ar deposits. blithely bold accounts against th...</td>
      <td>5</td>
      <td>ETHIOPIA</td>
      <td>ven packages wake quickly. regu</td>
      <td>0</td>
      <td>AFRICA</td>
      <td>lar deposits. blithely final packages cajole. ...</td>
    </tr>
    <tr>
      <th>60172</th>
      <td>4</td>
      <td>29</td>
      <td>33966.83</td>
      <td>0.02</td>
      <td>0.01</td>
      <td>N</td>
      <td>O</td>
      <td>1995-07-25</td>
      <td>1995-06-07</td>
      <td>1995-08-17</td>
      <td>...</td>
      <td>i9v3 EsYCfLKFU6PIt8iihBOHBB37yR7b3GD7Rt</td>
      <td>17-886-101-6083</td>
      <td>6177.35</td>
      <td>onic, special deposits wake furio</td>
      <td>7</td>
      <td>GERMANY</td>
      <td>l platelets. regular accounts x-ray: unusual, ...</td>
      <td>3</td>
      <td>EUROPE</td>
      <td>ly final courts cajole furiously final excuse</td>
    </tr>
    <tr>
      <th>60173</th>
      <td>5</td>
      <td>31</td>
      <td>46052.98</td>
      <td>0.00</td>
      <td>0.05</td>
      <td>N</td>
      <td>O</td>
      <td>1995-08-06</td>
      <td>1995-07-18</td>
      <td>1995-08-19</td>
      <td>...</td>
      <td>YjP5C55zHDXL7LalK27zfQnwejdpin4AMpvh</td>
      <td>32-822-502-4215</td>
      <td>2972.26</td>
      <td>ously express ideas haggle quickly dugouts? fu</td>
      <td>22</td>
      <td>RUSSIA</td>
      <td>requests against the platelets use never acco...</td>
      <td>3</td>
      <td>EUROPE</td>
      <td>ly final courts cajole furiously final excuse</td>
    </tr>
    <tr>
      <th>60174</th>
      <td>6</td>
      <td>45</td>
      <td>78157.35</td>
      <td>0.04</td>
      <td>0.08</td>
      <td>N</td>
      <td>O</td>
      <td>1995-07-23</td>
      <td>1995-07-17</td>
      <td>1995-07-24</td>
      <td>...</td>
      <td>q1,G3Pj6OjIuUYfUoH18BFTKP5aU9bEV3</td>
      <td>11-383-516-1199</td>
      <td>4192.40</td>
      <td>blithely silent requests after the express dep...</td>
      <td>1</td>
      <td>ARGENTINA</td>
      <td>al foxes promise slyly according to the regula...</td>
      <td>1</td>
      <td>AMERICA</td>
      <td>hs use ironic, even requests. s</td>
    </tr>
  </tbody>
</table>
<p>60175 rows × 52 columns</p>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="outer-joins">
<h3><span class="section-number">9.3.9. </span>Outer Joins<a class="headerlink" href="#outer-joins" title="Permalink to this headline">¶</a></h3>
<p>Haben wir erneut die Relationen SchauspielerIn(Name, Adresse, Geschlecht, Geburtstag) und ManagerIn(Name, Adresse, ManagerinID, Gehalt) gegeben. Wir suchen nun alle Schauspieler*Innen, die zugleich auch Manger*Innen sind.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name, Adresse, Geburtstag, Gehalt </span>
<span class="c1">#FROM SchauspielerIn </span>
<span class="c1">#NATURAL INNER JOIN ManagerIn</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Adresse, Geburtstag, Gehalt FROM SchauspielerIn NATURAL INNER JOIN ManagerIn&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Adresse</th>
      <th>Geburtstag</th>
      <th>Gehalt</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nun suchen wir alle Schauspieler*Innen und ihre Manager*Inneninfo, falls diese vorhanden ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#…FROM SchauspielerIn NATURAL LEFT OUTER JOIN ManagerIn</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Adresse, Geburtstag, Gehalt FROM SchauspielerIn NATURAL LEFT OUTER JOIN ManagerIn&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Adresse</th>
      <th>Geburtstag</th>
      <th>Gehalt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>1947-07-30</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Sharon Stone</td>
      <td>407 N Maple Dr Suite 100, Beverly Hills, CA 90...</td>
      <td>1958-03-10</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Robert Pattinson</td>
      <td>William Morris Endeavor Entertainment, 9601 Wi...</td>
      <td>1986-05-13</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Scarlet Johansson</td>
      <td>15821 Ventura Blvs., Suite 370, Encino CA 9143...</td>
      <td>1984-11-22</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Saorise Ronan</td>
      <td>MacFarlane Chard Associates Ltd., 24 Adelaide ...</td>
      <td>1994-04-12</td>
      <td>None</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Jake Gyllenhaal</td>
      <td>Wilshire Boulevard, 3rd Floor, Beverly Hills, ...</td>
      <td>1980-12-19</td>
      <td>None</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Heath Ledger</td>
      <td>421 Broome Street, Lower Manhatta, New York City</td>
      <td>1979-04-04</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Mark Hamill</td>
      <td>P.O. Box 287, Grand Blanc, MI 48480</td>
      <td>1951-09-25</td>
      <td>None</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Carrie Fisher</td>
      <td>6514 Lankershim Blvd. North Hollywood, California</td>
      <td>1956-10-21</td>
      <td>None</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Harrison Ford</td>
      <td>P.O. Box 49344 Los Angeles, CA 90049-0344</td>
      <td>1942-07-13</td>
      <td>None</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Emile Hirsch</td>
      <td>9336 Civic Center Drive, Beverly Hills, CA 902...</td>
      <td>1985-03-13</td>
      <td>None</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Vincent Cassel</td>
      <td>42/44 rue de Paradis, 75010 Paris</td>
      <td>1966-11-23</td>
      <td>None</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Meryl Streep</td>
      <td>42 West, 600 3rd Avenue, 23rd Floor, New York</td>
      <td>1949-06-22</td>
      <td>None</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Cameron Diaz</td>
      <td>2000 Avenue Of The Stars, 3rd Floor, North Tow...</td>
      <td>1972-08-30</td>
      <td>None</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Emma Stone</td>
      <td>Wilshire Blvd., Suite 930, Beverly Hills, CA 9...</td>
      <td>1988-11-06</td>
      <td>None</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Phyllis Smith</td>
      <td>8383 Wilshire Blvd., Suite 100, Beverly Hills,...</td>
      <td>1951-07-10</td>
      <td>None</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Willem Dafoe</td>
      <td>9601 Wilshire Blvd., 3rd Floor, Beverly Hills,...</td>
      <td>1995-07-22</td>
      <td>None</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Leonardo DiCaprio</td>
      <td>2000 Avenue Of The Stars, 3rd Floor, North Tow...</td>
      <td>1974-11-11</td>
      <td>None</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Tobey Maguire</td>
      <td>10100 Santa Monica Blvd., Suite 2300, Los Ange...</td>
      <td>1975-06-27</td>
      <td>None</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Samuel L. Jackson</td>
      <td>8501 Washington Blvd., Culver City, CA 90232-7443</td>
      <td>1948-12-21</td>
      <td>None</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Will Smith</td>
      <td>1880 Century Park East, Suite 1600, Los Angele...</td>
      <td>1968-09-25</td>
      <td>None</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Tom Hanks</td>
      <td>P.O. Box 7340, Santa Monica, CA 90406-7340</td>
      <td>1956-07-09</td>
      <td>None</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Kirsten Dunst</td>
      <td>10100 Santa Monica Blvd., Suite 2300, Los Ange...</td>
      <td>1982-04-30</td>
      <td>None</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Ryan Gosling</td>
      <td>6311 Romaine Street, Suite 7327, Los Angeles, ...</td>
      <td>1980-11-12</td>
      <td>None</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Mahershala Ali</td>
      <td>4208 Overland Avenue Culver City, CA 90230-3736</td>
      <td>1974-02-16</td>
      <td>None</td>
    </tr>
    <tr>
      <th>25</th>
      <td>William Shatner</td>
      <td>5555 Melrose Avenue, Dreier 211, Hollywood, CA...</td>
      <td>1931-03-22</td>
      <td>None</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Alan Young</td>
      <td>P.O. Box 14 Rimrock, AZ 86335</td>
      <td>1919-11-19</td>
      <td>None</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Jared Leto</td>
      <td>6311 Romaine Street, Suite 7327, Los Angeles, ...</td>
      <td>1971-12-26</td>
      <td>None</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Adam Driver</td>
      <td>15260 Ventura Blvd. Suite 900, Sherman Oaks, C...</td>
      <td>1983-11-19</td>
      <td>None</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Lady Gaga</td>
      <td>401 Broadway Suite 206, New York, NY 10013</td>
      <td>1986-03-20</td>
      <td>None</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Daniel Craig</td>
      <td>40 Whitfield Street, London, W1T 2RH</td>
      <td>1968-03-02</td>
      <td>None</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Léa Seydoux</td>
      <td>42/44 rue de Paradis, 75010 Paris</td>
      <td>1985-07-01</td>
      <td>None</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>1956-10-04</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Falls keine Manager*Ininfo vorhanden ist bleibt Gehalt NULL.</p>
<p>Im Folgenden suchen wir Manager*Innen und gegebenenfalls ihre Schauspieler*Inneninfo</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#…FROM SchauspielerIn NATURAL RIGHT OUTER JOIN ManagerIn</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Adresse, Geburtstag, Gehalt FROM ManagerIn NATURAL RIGHT OUTER JOIN SchauspielerIn&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OperationalError</span><span class="g g-Whitespace">                          </span>Traceback (most recent call last)
<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2020,</span> in <span class="ni">SQLiteDatabase.execute</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2019</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2020</span>     <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2021</span>     <span class="k">return</span> <span class="n">cur</span>

<span class="ne">OperationalError</span>: RIGHT and FULL OUTER JOINs are not currently supported

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">DatabaseError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">Input In [9],</span> in <span class="ni">&lt;cell line: 5&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Adresse, Geburtstag, Gehalt FROM ManagerIn NATURAL RIGHT OUTER JOIN SchauspielerIn&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">df</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:399,</span> in <span class="ni">read_sql_query</span><span class="nt">(sql, con, index_col, coerce_float, params, parse_dates, chunksize, dtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">341</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">342</span><span class="sd"> Read SQL query into a DataFrame.</span>
<span class="g g-Whitespace">    </span><span class="mi">343</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span><span class="sd"> parameter will be converted to UTC.</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span> <span class="n">pandas_sql</span> <span class="o">=</span> <span class="n">pandasSQL_builder</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">399</span> <span class="k">return</span> <span class="n">pandas_sql</span><span class="o">.</span><span class="n">read_query</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">400</span>     <span class="n">sql</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">401</span>     <span class="n">index_col</span><span class="o">=</span><span class="n">index_col</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span>     <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span>     <span class="n">coerce_float</span><span class="o">=</span><span class="n">coerce_float</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span>     <span class="n">parse_dates</span><span class="o">=</span><span class="n">parse_dates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">405</span>     <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">406</span>     <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span> <span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2080,</span> in <span class="ni">SQLiteDatabase.read_query</span><span class="nt">(self, sql, index_col, coerce_float, params, parse_dates, chunksize, dtype)</span>
<span class="g g-Whitespace">   </span><span class="mi">2068</span> <span class="k">def</span> <span class="nf">read_query</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2069</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2070</span>     <span class="n">sql</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2076</span>     <span class="n">dtype</span><span class="p">:</span> <span class="n">DtypeArg</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2077</span> <span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">2079</span>     <span class="n">args</span> <span class="o">=</span> <span class="n">_convert_params</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2080</span>     <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2081</span>     <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col_desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">col_desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">2083</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2032,</span> in <span class="ni">SQLiteDatabase.execute</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2029</span>     <span class="k">raise</span> <span class="n">ex</span> <span class="kn">from</span> <span class="nn">inner_exc</span>
<span class="g g-Whitespace">   </span><span class="mi">2031</span> <span class="n">ex</span> <span class="o">=</span> <span class="n">DatabaseError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Execution failed on sql &#39;</span><span class="si">{</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2032</span> <span class="k">raise</span> <span class="n">ex</span> <span class="kn">from</span> <span class="nn">exc</span>

<span class="ne">DatabaseError</span>: Execution failed on sql &#39;SELECT Name, Adresse, Geburtstag, Gehalt FROM ManagerIn NATURAL RIGHT OUTER JOIN SchauspielerIn&#39;: RIGHT and FULL OUTER JOINs are not currently supported
</pre></div>
</div>
</div>
</div>
<p>Wir sehen, dass RIGHT OUTER JOINS in sqlite3 nicht direkt möglich sind, da dieser Operator in sqlite3 nicht unterstützt wird. Man kann aber dennoch durch Vertauschen der Reihenfolge der Tabellen, die gewünschte Ausgabe mit LEFT OUTER JOINS erzeugen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Adresse, Geburtstag, Gehalt FROM ManagerIn NATURAL LEFT OUTER JOIN SchauspielerIn&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Adresse</th>
      <th>Geburtstag</th>
      <th>Gehalt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bob Chapek</td>
      <td>500 S Buena Vista St, Burbank, CA 91521</td>
      <td>None</td>
      <td>2667846,08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jim Morris</td>
      <td>1200 Park Ave, Emeryville, CA 94608</td>
      <td>None</td>
      <td>16918,33</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Paul Golding</td>
      <td>Pinewood Rd, Slough, Iver SL0 0NH</td>
      <td>None</td>
      <td>10235,4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bill Pohlad</td>
      <td>5555 Melrose Ave, Los Angeles, CA 90038</td>
      <td>None</td>
      <td>739482,89</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Scott Rudin</td>
      <td>120 W. 45th St., 10th Fl., New York, New York ...</td>
      <td>None</td>
      <td>15758,57</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Daniel Katz</td>
      <td>31 West 27th Street, New York City</td>
      <td>None</td>
      <td>13450,13</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Brian Robbins</td>
      <td>2000 Avenue of the Stars Suite 620-N Los Angeles</td>
      <td>None</td>
      <td>12345,57</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Ann Sarnoff</td>
      <td>10100 Santa Monica Blvd., Los Angeles, CA 90404</td>
      <td>None</td>
      <td>24123,56</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jim Berk</td>
      <td>3520 Wesley Street, Culver City, CA 90232</td>
      <td>None</td>
      <td>88584,1</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Robert Kirby</td>
      <td>Entertainment Rd, Oxenford, Queensland 4210, AU</td>
      <td>None</td>
      <td>45678,9</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Steve Asbell</td>
      <td>10201 Pico Blvd, Los Angeles, CA 90064</td>
      <td>None</td>
      <td>12678,1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Alan Bruckner</td>
      <td>25 Whitlam Ave Unit 3, Etobicoke, ON M8V2K1</td>
      <td>None</td>
      <td>17853,41</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Isaac Perlmutter</td>
      <td>4000 Warner Blvd., Burbank, CA 91522</td>
      <td>None</td>
      <td>18456,1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Quentin Tarantino</td>
      <td>10100 Santa Monica Blvd., Los Angeles, CA 90404</td>
      <td>None</td>
      <td>12345,57</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Louis B.Mayer</td>
      <td>625 Palisades Beach Rd, Santa Monica</td>
      <td>None</td>
      <td>83333,33</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Falls die Schauspieler*Inneninfo nicht vorhanden ist bleibt Geburtstag NULL.</p>
<p>Nun suchen wir alle Schauspieler*innen und Manager*innen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#…FROM SchauspielerIn NATURAL RIGHT OUTER JOIN ManagerIn</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Adresse, Geburtstag, Gehalt FROM SchauspielerIn NATURAL FULL OUTER JOIN ManagerIn&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OperationalError</span><span class="g g-Whitespace">                          </span>Traceback (most recent call last)
<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2020,</span> in <span class="ni">SQLiteDatabase.execute</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2019</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2020</span>     <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2021</span>     <span class="k">return</span> <span class="n">cur</span>

<span class="ne">OperationalError</span>: RIGHT and FULL OUTER JOINs are not currently supported

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">DatabaseError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">Input In [10],</span> in <span class="ni">&lt;cell line: 5&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Adresse, Geburtstag, Gehalt FROM SchauspielerIn NATURAL FULL OUTER JOIN ManagerIn&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">df</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:399,</span> in <span class="ni">read_sql_query</span><span class="nt">(sql, con, index_col, coerce_float, params, parse_dates, chunksize, dtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">341</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">342</span><span class="sd"> Read SQL query into a DataFrame.</span>
<span class="g g-Whitespace">    </span><span class="mi">343</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span><span class="sd"> parameter will be converted to UTC.</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span> <span class="n">pandas_sql</span> <span class="o">=</span> <span class="n">pandasSQL_builder</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">399</span> <span class="k">return</span> <span class="n">pandas_sql</span><span class="o">.</span><span class="n">read_query</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">400</span>     <span class="n">sql</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">401</span>     <span class="n">index_col</span><span class="o">=</span><span class="n">index_col</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span>     <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span>     <span class="n">coerce_float</span><span class="o">=</span><span class="n">coerce_float</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span>     <span class="n">parse_dates</span><span class="o">=</span><span class="n">parse_dates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">405</span>     <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">406</span>     <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span> <span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2080,</span> in <span class="ni">SQLiteDatabase.read_query</span><span class="nt">(self, sql, index_col, coerce_float, params, parse_dates, chunksize, dtype)</span>
<span class="g g-Whitespace">   </span><span class="mi">2068</span> <span class="k">def</span> <span class="nf">read_query</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2069</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2070</span>     <span class="n">sql</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2076</span>     <span class="n">dtype</span><span class="p">:</span> <span class="n">DtypeArg</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2077</span> <span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">2079</span>     <span class="n">args</span> <span class="o">=</span> <span class="n">_convert_params</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2080</span>     <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2081</span>     <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col_desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">col_desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">2083</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2032,</span> in <span class="ni">SQLiteDatabase.execute</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2029</span>     <span class="k">raise</span> <span class="n">ex</span> <span class="kn">from</span> <span class="nn">inner_exc</span>
<span class="g g-Whitespace">   </span><span class="mi">2031</span> <span class="n">ex</span> <span class="o">=</span> <span class="n">DatabaseError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Execution failed on sql &#39;</span><span class="si">{</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2032</span> <span class="k">raise</span> <span class="n">ex</span> <span class="kn">from</span> <span class="nn">exc</span>

<span class="ne">DatabaseError</span>: Execution failed on sql &#39;SELECT Name, Adresse, Geburtstag, Gehalt FROM SchauspielerIn NATURAL FULL OUTER JOIN ManagerIn&#39;: RIGHT and FULL OUTER JOINs are not currently supported
</pre></div>
</div>
</div>
</div>
<p>Ebenso werden FULL OUTER JOINS in sqlite3 nicht unterstützt. Eine alternative Anfrage mit äquivalenter Ausgabe, die nur LEFT OUTER JOINS verwendet ist möglich. Ein FULL OUTER JOIN ist die Vereinigung von dem LEFT und RIGHT OUTER JOIN zweier Tabellen. Wie im vorherigen Beispiel gezeigt, können wir RIGHT OUTER JOINS mithilfe von LEFT OUTER JOINS erzeugen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Adresse, Geburtstag, Gehalt FROM SchauspielerIn NATURAL LEFT OUTER JOIN ManagerIn UNION SELECT Name, Adresse, Geburtstag, Gehalt FROM ManagerIn NATURAL LEFT OUTER JOIN SchauspielerIn&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Adresse</th>
      <th>Geburtstag</th>
      <th>Gehalt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adam Driver</td>
      <td>15260 Ventura Blvd. Suite 900, Sherman Oaks, C...</td>
      <td>1983-11-19</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alan Bruckner</td>
      <td>25 Whitlam Ave Unit 3, Etobicoke, ON M8V2K1</td>
      <td>None</td>
      <td>17853,41</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Alan Young</td>
      <td>P.O. Box 14 Rimrock, AZ 86335</td>
      <td>1919-11-19</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ann Sarnoff</td>
      <td>10100 Santa Monica Blvd., Los Angeles, CA 90404</td>
      <td>None</td>
      <td>24123,56</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>1947-07-30</td>
      <td>None</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Bill Pohlad</td>
      <td>5555 Melrose Ave, Los Angeles, CA 90038</td>
      <td>None</td>
      <td>739482,89</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Bob Chapek</td>
      <td>500 S Buena Vista St, Burbank, CA 91521</td>
      <td>None</td>
      <td>2667846,08</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Brian Robbins</td>
      <td>2000 Avenue of the Stars Suite 620-N Los Angeles</td>
      <td>None</td>
      <td>12345,57</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Cameron Diaz</td>
      <td>2000 Avenue Of The Stars, 3rd Floor, North Tow...</td>
      <td>1972-08-30</td>
      <td>None</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Carrie Fisher</td>
      <td>6514 Lankershim Blvd. North Hollywood, California</td>
      <td>1956-10-21</td>
      <td>None</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>1956-10-04</td>
      <td>None</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Daniel Craig</td>
      <td>40 Whitfield Street, London, W1T 2RH</td>
      <td>1968-03-02</td>
      <td>None</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Daniel Katz</td>
      <td>31 West 27th Street, New York City</td>
      <td>None</td>
      <td>13450,13</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Emile Hirsch</td>
      <td>9336 Civic Center Drive, Beverly Hills, CA 902...</td>
      <td>1985-03-13</td>
      <td>None</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Emma Stone</td>
      <td>Wilshire Blvd., Suite 930, Beverly Hills, CA 9...</td>
      <td>1988-11-06</td>
      <td>None</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Harrison Ford</td>
      <td>P.O. Box 49344 Los Angeles, CA 90049-0344</td>
      <td>1942-07-13</td>
      <td>None</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Heath Ledger</td>
      <td>421 Broome Street, Lower Manhatta, New York City</td>
      <td>1979-04-04</td>
      <td>None</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Isaac Perlmutter</td>
      <td>4000 Warner Blvd., Burbank, CA 91522</td>
      <td>None</td>
      <td>18456,1</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Jake Gyllenhaal</td>
      <td>Wilshire Boulevard, 3rd Floor, Beverly Hills, ...</td>
      <td>1980-12-19</td>
      <td>None</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Jared Leto</td>
      <td>6311 Romaine Street, Suite 7327, Los Angeles, ...</td>
      <td>1971-12-26</td>
      <td>None</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Jim Berk</td>
      <td>3520 Wesley Street, Culver City, CA 90232</td>
      <td>None</td>
      <td>88584,1</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Jim Morris</td>
      <td>1200 Park Ave, Emeryville, CA 94608</td>
      <td>None</td>
      <td>16918,33</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Kirsten Dunst</td>
      <td>10100 Santa Monica Blvd., Suite 2300, Los Ange...</td>
      <td>1982-04-30</td>
      <td>None</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Lady Gaga</td>
      <td>401 Broadway Suite 206, New York, NY 10013</td>
      <td>1986-03-20</td>
      <td>None</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Leonardo DiCaprio</td>
      <td>2000 Avenue Of The Stars, 3rd Floor, North Tow...</td>
      <td>1974-11-11</td>
      <td>None</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Louis B.Mayer</td>
      <td>625 Palisades Beach Rd, Santa Monica</td>
      <td>None</td>
      <td>83333,33</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Léa Seydoux</td>
      <td>42/44 rue de Paradis, 75010 Paris</td>
      <td>1985-07-01</td>
      <td>None</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Mahershala Ali</td>
      <td>4208 Overland Avenue Culver City, CA 90230-3736</td>
      <td>1974-02-16</td>
      <td>None</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Mark Hamill</td>
      <td>P.O. Box 287, Grand Blanc, MI 48480</td>
      <td>1951-09-25</td>
      <td>None</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Meryl Streep</td>
      <td>42 West, 600 3rd Avenue, 23rd Floor, New York</td>
      <td>1949-06-22</td>
      <td>None</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Paul Golding</td>
      <td>Pinewood Rd, Slough, Iver SL0 0NH</td>
      <td>None</td>
      <td>10235,4</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Phyllis Smith</td>
      <td>8383 Wilshire Blvd., Suite 100, Beverly Hills,...</td>
      <td>1951-07-10</td>
      <td>None</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Quentin Tarantino</td>
      <td>10100 Santa Monica Blvd., Los Angeles, CA 90404</td>
      <td>None</td>
      <td>12345,57</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Robert Kirby</td>
      <td>Entertainment Rd, Oxenford, Queensland 4210, AU</td>
      <td>None</td>
      <td>45678,9</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Robert Pattinson</td>
      <td>William Morris Endeavor Entertainment, 9601 Wi...</td>
      <td>1986-05-13</td>
      <td>None</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Ryan Gosling</td>
      <td>6311 Romaine Street, Suite 7327, Los Angeles, ...</td>
      <td>1980-11-12</td>
      <td>None</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Samuel L. Jackson</td>
      <td>8501 Washington Blvd., Culver City, CA 90232-7443</td>
      <td>1948-12-21</td>
      <td>None</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Saorise Ronan</td>
      <td>MacFarlane Chard Associates Ltd., 24 Adelaide ...</td>
      <td>1994-04-12</td>
      <td>None</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Scarlet Johansson</td>
      <td>15821 Ventura Blvs., Suite 370, Encino CA 9143...</td>
      <td>1984-11-22</td>
      <td>None</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Scott Rudin</td>
      <td>120 W. 45th St., 10th Fl., New York, New York ...</td>
      <td>None</td>
      <td>15758,57</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Sharon Stone</td>
      <td>407 N Maple Dr Suite 100, Beverly Hills, CA 90...</td>
      <td>1958-03-10</td>
      <td>None</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Steve Asbell</td>
      <td>10201 Pico Blvd, Los Angeles, CA 90064</td>
      <td>None</td>
      <td>12678,1</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Tobey Maguire</td>
      <td>10100 Santa Monica Blvd., Suite 2300, Los Ange...</td>
      <td>1975-06-27</td>
      <td>None</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Tom Hanks</td>
      <td>P.O. Box 7340, Santa Monica, CA 90406-7340</td>
      <td>1956-07-09</td>
      <td>None</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Vincent Cassel</td>
      <td>42/44 rue de Paradis, 75010 Paris</td>
      <td>1966-11-23</td>
      <td>None</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Will Smith</td>
      <td>1880 Century Park East, Suite 1600, Los Angele...</td>
      <td>1968-09-25</td>
      <td>None</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Willem Dafoe</td>
      <td>9601 Wilshire Blvd., 3rd Floor, Beverly Hills,...</td>
      <td>1995-07-22</td>
      <td>None</td>
    </tr>
    <tr>
      <th>47</th>
      <td>William Shatner</td>
      <td>5555 Melrose Avenue, Dreier 211, Hollywood, CA...</td>
      <td>1931-03-22</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Falls zu den Schauspieler*Innen die Manager*Inneninfo bzw. Manager*Innen die Schauspieler*Inneninfo fehlt, bleiben Geburtstag oder Gehalt gegebenenfalls leer.</p>
<p>Der Unterschied von FULL OUTER JOINS zu UNION ist, dass nur eine Zeile pro Person ausgegeben wird.</p>
</div>
<div class="section" id="kreuzprodukt">
<h3><span class="section-number">9.3.10. </span>Kreuzprodukt<a class="headerlink" href="#kreuzprodukt" title="Permalink to this headline">¶</a></h3>
<p>Wie aus der Relationalen Algebra bekannt bildet das Kreuzprodukt lle Paare aus Tupeln den beteiligten Relationen. In SQL können Kreuzprodukte mit CROSS JOIN gebildet werden, wie unten gezeigt oder auch mit Komma zwischen den beteiligten Relationen in der FROM-Klausel, wie ein Beispielt weiter gezeigt wird. Kreuzprodukte werden in der Regel selten verwendet, sie sind aber der Grundbaustein für Joins.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT * </span>
<span class="c1">#FROM SchauspielerIn CROSS JOIN Film</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM SchauspielerIn CROSS JOIN Film&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Adresse</th>
      <th>Geschlecht</th>
      <th>Geburtstag</th>
      <th>Titel</th>
      <th>Jahr</th>
      <th>Laenge</th>
      <th>inFarbe</th>
      <th>StudioName</th>
      <th>ProduzentinID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>m</td>
      <td>1947-07-30</td>
      <td>Inside Out</td>
      <td>2015</td>
      <td>95</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>m</td>
      <td>1947-07-30</td>
      <td>Toy Story</td>
      <td>1999</td>
      <td>81</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>m</td>
      <td>1947-07-30</td>
      <td>Up</td>
      <td>2009</td>
      <td>96</td>
      <td>TRUE</td>
      <td>Pixar</td>
      <td>4567</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>m</td>
      <td>1947-07-30</td>
      <td>Ratatouille</td>
      <td>2007</td>
      <td>111</td>
      <td>TRUE</td>
      <td>Pixar</td>
      <td>4567</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>m</td>
      <td>1947-07-30</td>
      <td>Star Wars</td>
      <td>1977</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Pinewood</td>
      <td>78910</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>853</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>m</td>
      <td>1956-10-04</td>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>158</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
    <tr>
      <th>854</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>m</td>
      <td>1956-10-04</td>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>148</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
    <tr>
      <th>855</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>m</td>
      <td>1956-10-04</td>
      <td>Shipwrecked</td>
      <td>1990</td>
      <td>92</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>856</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>m</td>
      <td>1956-10-04</td>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
      <td>77</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>857</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>m</td>
      <td>1956-10-04</td>
      <td>Gone with the Wind</td>
      <td>1939</td>
      <td>221</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
  </tbody>
</table>
<p>858 rows × 10 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT * </span>
<span class="c1">#FROM SchauspielerIn, Film</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM SchauspielerIn, Film&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Adresse</th>
      <th>Geschlecht</th>
      <th>Geburtstag</th>
      <th>Titel</th>
      <th>Jahr</th>
      <th>Laenge</th>
      <th>inFarbe</th>
      <th>StudioName</th>
      <th>ProduzentinID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>m</td>
      <td>1947-07-30</td>
      <td>Inside Out</td>
      <td>2015</td>
      <td>95</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>m</td>
      <td>1947-07-30</td>
      <td>Toy Story</td>
      <td>1999</td>
      <td>81</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>m</td>
      <td>1947-07-30</td>
      <td>Up</td>
      <td>2009</td>
      <td>96</td>
      <td>TRUE</td>
      <td>Pixar</td>
      <td>4567</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>m</td>
      <td>1947-07-30</td>
      <td>Ratatouille</td>
      <td>2007</td>
      <td>111</td>
      <td>TRUE</td>
      <td>Pixar</td>
      <td>4567</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
      <td>m</td>
      <td>1947-07-30</td>
      <td>Star Wars</td>
      <td>1977</td>
      <td>121</td>
      <td>TRUE</td>
      <td>Pinewood</td>
      <td>78910</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>853</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>m</td>
      <td>1956-10-04</td>
      <td>House of Gucci</td>
      <td>2021</td>
      <td>158</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
    <tr>
      <th>854</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>m</td>
      <td>1956-10-04</td>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
      <td>148</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
    <tr>
      <th>855</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>m</td>
      <td>1956-10-04</td>
      <td>Shipwrecked</td>
      <td>1990</td>
      <td>92</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>856</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>m</td>
      <td>1956-10-04</td>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
      <td>77</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>857</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
      <td>m</td>
      <td>1956-10-04</td>
      <td>Gone with the Wind</td>
      <td>1939</td>
      <td>221</td>
      <td>TRUE</td>
      <td>MGM</td>
      <td>5555</td>
    </tr>
  </tbody>
</table>
<p>858 rows × 10 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="mengenoperationen-in-sql">
<h3><span class="section-number">9.3.11. </span>Mengenoperationen in SQL<a class="headerlink" href="#mengenoperationen-in-sql" title="Permalink to this headline">¶</a></h3>
<p>Die Mengenoperationen UNION(Vereinigung), INTERSECT(Schnittmenge) und EXCEPT/MINUS(Differenz) können nur zwischen geklammertern Anfrageergebnissen benutzt werden, die das selbe Schema besitzen. Sobald einer dieser Operationen verwendet wird, wird implizit Mengensemantik verwendet. Möchte man Multimengensemantik haben, so müssen die Operatoren UNION ALL, INTERSECT ALL und EXCEPT/MINUS ALL verwendet werden. Das bietet sich an, wenn die Semantik egal ist oder die Mengeneigenschaft von Input und Output bereits bekannt ist.</p>
<div class="section" id="schnittmenge-intersect">
<h4><span class="section-number">9.3.11.1. </span>Schnittmenge: INTERSECT<a class="headerlink" href="#schnittmenge-intersect" title="Permalink to this headline">¶</a></h4>
<p>INTERSECT entspricht dem logischen „und“. Im Folgenden suchen wir die Schnittmenge zwischen den Namen und Adressen der Schauspieler*Innen und den Mangager*Innen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#(SELECT Name, Adresse FROM SchauspielerIn) INTERSECT (SELECT Name, Adresse FROM ManagerIn);</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Adresse FROM SchauspielerIn INTERSECT SELECT Name, Adresse FROM ManagerIn&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Adresse</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>In diesem Beispiel suchen wir die Schnittmenge zwischen den Namen und Adressen der  weiblichen Schauspieler*Innen und den Mangager*Innen, die ein Gehalt größer als 1000000 haben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%sql (SELECT Name, Adresse FROM SchauspielerIn WHERE Geschlecht = &quot;f&quot;) INTERSECT (SELECT Name, Adresse FROM ManagerIn WHERE Gehalt &gt; 1000000)</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Adresse FROM SchauspielerIn WHERE Geschlecht = &#39;f&#39; INTERSECT SELECT Name, Adresse FROM ManagerIn WHERE Gehalt &gt; 1000000&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Adresse</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="vereinigung-union">
<h4><span class="section-number">9.3.11.2. </span>Vereinigung: UNION<a class="headerlink" href="#vereinigung-union" title="Permalink to this headline">¶</a></h4>
<p>UNION entspricht dem logischen „oder“. Im unteren Beispiel geben wir alle Namen und Adressen der Schauspieler*Innen und den Mangager*Innen aus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#(SELECT Name, Adresse FROM SchauspielerIn) UNION (SELECT Name, Adresse FROM ManagerIn);</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Adresse FROM SchauspielerIn UNION SELECT Name, Adresse FROM ManagerIn&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Adresse</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adam Driver</td>
      <td>15260 Ventura Blvd. Suite 900, Sherman Oaks, C...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alan Bruckner</td>
      <td>25 Whitlam Ave Unit 3, Etobicoke, ON M8V2K1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Alan Young</td>
      <td>P.O. Box 14 Rimrock, AZ 86335</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ann Sarnoff</td>
      <td>10100 Santa Monica Blvd., Los Angeles, CA 90404</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arnold Schwarzenegger</td>
      <td>3110 Main Street, Suite 300, Santa Monica, CA ...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Bill Pohlad</td>
      <td>5555 Melrose Ave, Los Angeles, CA 90038</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Bob Chapek</td>
      <td>500 S Buena Vista St, Burbank, CA 91521</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Brian Robbins</td>
      <td>2000 Avenue of the Stars Suite 620-N Los Angeles</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Cameron Diaz</td>
      <td>2000 Avenue Of The Stars, 3rd Floor, North Tow...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Carrie Fisher</td>
      <td>6514 Lankershim Blvd. North Hollywood, California</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Christoph Waltz</td>
      <td>Sophienstrasse 21, 10178 Berlin</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Daniel Craig</td>
      <td>40 Whitfield Street, London, W1T 2RH</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Daniel Katz</td>
      <td>31 West 27th Street, New York City</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Emile Hirsch</td>
      <td>9336 Civic Center Drive, Beverly Hills, CA 902...</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Emma Stone</td>
      <td>Wilshire Blvd., Suite 930, Beverly Hills, CA 9...</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Harrison Ford</td>
      <td>P.O. Box 49344 Los Angeles, CA 90049-0344</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Heath Ledger</td>
      <td>421 Broome Street, Lower Manhatta, New York City</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Isaac Perlmutter</td>
      <td>4000 Warner Blvd., Burbank, CA 91522</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Jake Gyllenhaal</td>
      <td>Wilshire Boulevard, 3rd Floor, Beverly Hills, ...</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Jared Leto</td>
      <td>6311 Romaine Street, Suite 7327, Los Angeles, ...</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Jim Berk</td>
      <td>3520 Wesley Street, Culver City, CA 90232</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Jim Morris</td>
      <td>1200 Park Ave, Emeryville, CA 94608</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Kirsten Dunst</td>
      <td>10100 Santa Monica Blvd., Suite 2300, Los Ange...</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Lady Gaga</td>
      <td>401 Broadway Suite 206, New York, NY 10013</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Leonardo DiCaprio</td>
      <td>2000 Avenue Of The Stars, 3rd Floor, North Tow...</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Louis B.Mayer</td>
      <td>625 Palisades Beach Rd, Santa Monica</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Léa Seydoux</td>
      <td>42/44 rue de Paradis, 75010 Paris</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Mahershala Ali</td>
      <td>4208 Overland Avenue Culver City, CA 90230-3736</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Mark Hamill</td>
      <td>P.O. Box 287, Grand Blanc, MI 48480</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Meryl Streep</td>
      <td>42 West, 600 3rd Avenue, 23rd Floor, New York</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Paul Golding</td>
      <td>Pinewood Rd, Slough, Iver SL0 0NH</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Phyllis Smith</td>
      <td>8383 Wilshire Blvd., Suite 100, Beverly Hills,...</td>
    </tr>
    <tr>
      <th>32</th>
      <td>Quentin Tarantino</td>
      <td>10100 Santa Monica Blvd., Los Angeles, CA 90404</td>
    </tr>
    <tr>
      <th>33</th>
      <td>Robert Kirby</td>
      <td>Entertainment Rd, Oxenford, Queensland 4210, AU</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Robert Pattinson</td>
      <td>William Morris Endeavor Entertainment, 9601 Wi...</td>
    </tr>
    <tr>
      <th>35</th>
      <td>Ryan Gosling</td>
      <td>6311 Romaine Street, Suite 7327, Los Angeles, ...</td>
    </tr>
    <tr>
      <th>36</th>
      <td>Samuel L. Jackson</td>
      <td>8501 Washington Blvd., Culver City, CA 90232-7443</td>
    </tr>
    <tr>
      <th>37</th>
      <td>Saorise Ronan</td>
      <td>MacFarlane Chard Associates Ltd., 24 Adelaide ...</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Scarlet Johansson</td>
      <td>15821 Ventura Blvs., Suite 370, Encino CA 9143...</td>
    </tr>
    <tr>
      <th>39</th>
      <td>Scott Rudin</td>
      <td>120 W. 45th St., 10th Fl., New York, New York ...</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Sharon Stone</td>
      <td>407 N Maple Dr Suite 100, Beverly Hills, CA 90...</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Steve Asbell</td>
      <td>10201 Pico Blvd, Los Angeles, CA 90064</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Tobey Maguire</td>
      <td>10100 Santa Monica Blvd., Suite 2300, Los Ange...</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Tom Hanks</td>
      <td>P.O. Box 7340, Santa Monica, CA 90406-7340</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Vincent Cassel</td>
      <td>42/44 rue de Paradis, 75010 Paris</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Will Smith</td>
      <td>1880 Century Park East, Suite 1600, Los Angele...</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Willem Dafoe</td>
      <td>9601 Wilshire Blvd., 3rd Floor, Beverly Hills,...</td>
    </tr>
    <tr>
      <th>47</th>
      <td>William Shatner</td>
      <td>5555 Melrose Avenue, Dreier 211, Hollywood, CA...</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="differenz-except-minus">
<h4><span class="section-number">9.3.11.3. </span>Differenz: EXCEPT/MINUS<a class="headerlink" href="#differenz-except-minus" title="Permalink to this headline">¶</a></h4>
<p>Im unteren Beispiel suchen wir den Titel und das Jahr jener Filme die in der Film-Relation vorkommen, aber nicht in der spielt_in-Relation. Damit diese Anfrage funktioniert, muss Umbenennung benutzt werden, da die beiden Mengen sonst nicht das selbe Schema besitzten.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#(SELECT Titel, Jahr FROM Film) EXCEPT (SELECT FilmTitel AS Titel, FilmJahr AS Jahr FROM spielt_in) </span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel, Jahr FROM Film EXCEPT SELECT FilmTitel AS Titel, FilmJahr AS Jahr FROM spielt_in&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gone with the Wind</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ratatouille</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Roma</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Shipwrecked</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Toy Story</td>
      <td>1999</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="klammerung">
<h4><span class="section-number">9.3.11.4. </span>Klammerung<a class="headerlink" href="#klammerung" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT *</span>
<span class="c1">#FROM</span>
<span class="c1">#(</span>
<span class="c1">#    (SELECT A FROM R)</span>
<span class="c1">#     INTERSECT</span>
<span class="c1">#    (SELECT * FROM</span>
<span class="c1">#     (SELECT A FROM S)</span>
<span class="c1">#      UNION</span>
<span class="c1">#    (SELECT A FROM T)</span>
<span class="c1">#   )</span>
<span class="c1">#)</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM (SELECT A FROM R INTERSECT SELECT * FROM (SELECT A FROM S) UNION SELECT A FROM T)&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;rst/rst.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>6</td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="zusammenfassung-der-semantik">
<h3><span class="section-number">9.3.12. </span>Zusammenfassung der Semantik<a class="headerlink" href="#zusammenfassung-der-semantik" title="Permalink to this headline">¶</a></h3>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>R1</p></th>
<th class="head"><p>R2</p></th>
<th class="head"><p>UNION ALL</p></th>
<th class="head"><p>UNION</p></th>
<th class="head"><p>EXCEPT ALL</p></th>
<th class="head"><p>EXCEPT</p></th>
<th class="head"><p>INTERSECT ALL</p></th>
<th class="head"><p>INTERSECT</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-even"><td><p>1</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>﻿</p></td>
<td><p>3</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>4</p></td>
<td><p>2</p></td>
<td><p>﻿</p></td>
<td><p>4</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>3</p></td>
<td><p>1</p></td>
<td><p>5</p></td>
<td><p>4</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>3</p></td>
<td><p>2</p></td>
<td><p>﻿</p></td>
<td><p>5</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>4</p></td>
<td><p>2</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>﻿</p></td>
<td><p>2</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>﻿</p></td>
<td><p>3</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>5</p></td>
<td><p>﻿</p></td>
<td><p>3</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>﻿</p></td>
<td><p>﻿</p></td>
<td><p>3</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>﻿</p></td>
<td><p>﻿</p></td>
<td><p>3</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>﻿</p></td>
<td><p>﻿</p></td>
<td><p>3</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>﻿</p></td>
<td><p>﻿</p></td>
<td><p>4</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>﻿</p></td>
<td><p>﻿</p></td>
<td><p>4</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>﻿</p></td>
<td><p>﻿</p></td>
<td><p>4</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>﻿</p></td>
<td><p>﻿</p></td>
<td><p>5</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="geschachtelte-anfragen">
<h2><span class="section-number">9.4. </span>Geschachtelte Anfragen<a class="headerlink" href="#geschachtelte-anfragen" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3><span class="section-number">9.4.1. </span>Motivation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>In vorherigen Beispielen haben wir schon geschachtelte Anfragen gesehen, nun betrachten wir diese etwas genauer. Eine Anfrage kann Teil einer anderen theoretisch beliebig tief geschachtelten Anfrage sein. Hier gibt es drei verschiedene Varianten:
<br></p>
<ol class="simple">
<li><p>Die Subanfrage erzeugt einen einzigen Wert, der in der WHERE-Klausel mit einem anderen Wert verglichen werden kann.</p></li>
<li><p>Die Subanfrage erzeugt eine Relation, die auf verschiedene Weise in der WHERE-Klausel verwendet werden kann.</p></li>
<li><p>Die Subanfrage erzeugt eine Relation, die in der FROM Klausel (sozusagen als weitere Datenquelle) verwendet werden kann. – Wie jede andere normale Relation</p></li>
</ol>
</div>
<div class="section" id="skalare-subanfragen">
<h3><span class="section-number">9.4.2. </span>Skalare Subanfragen<a class="headerlink" href="#skalare-subanfragen" title="Permalink to this headline">¶</a></h3>
<p>Bei der ersten der drei Varianten von geschachtelten Anfrage, handelt es sich um skalare Subanfragen. Allgemeine Anfragen produzieren Relationen, mit mehreren Attributen, wo Zugriff auf ein bestimmtes Attribut auch möglich ist. Bei skalaren Subanfragen wird (garantiert) maximal nur ein Tupel und Projektion auf nur ein Attribut ausgegeben. Das Ergbenis einer skalaren Anfrage ist entweder genau ein Wert, der dann wie eine Konstante verwendet werden kann, oder wenn keine Zeilen gefunden werden, ist das Ergebnis der skalaren Anfrage NULL.
<br>
<img alt="title" src="../_images/skalare_subanfragen.jpg" />
<br>
Wir haben im Folgenden Beispiel die Relationen ManagerIn(Name, Adresse, ManagerinID, Gehalt)und Film(Titel, Jahr, Länge, inFarbe, StudioName, ProduzentinID) gegeben. Wir suchen nun den Produzent von Star Wars auf zwei Wegen, wobei garantiert ist, dass es nur einen Produzenten gibt. Zuerst suchen wir ,mithilfe einer allgemeinen Anfrage, unter allen Filmen jene mit dem Titel = ‘Star Wars’ und Jahr = 1977, wo die ProduzentinID mit der MangaerinID gematcht werden kann. Zuletzt geben wir den Namen aus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name </span>
<span class="c1">#FROM Film, ManagerIn </span>
<span class="c1">#WHERE Titel = ‘Star Wars‘ </span>
<span class="c1">#AND Jahr = ‘1977‘ </span>
<span class="c1">#AND ProduzentinID = ManagerinID;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name FROM Film, ManagerIn WHERE Titel = &#39;Star Wars&#39; AND Jahr = 1977 AND ProduzentinID = ManagerinID&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Paul Golding</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In dieser Variante suchen wir wieder den Produzent von Star Wars, jedoch mithile einer skalaren Subanfrage. Wir suchen zuerst die ProduzentinID des Films, wo Titel = ‘Star Wars’ und Jahr = 1977 gilt und vergleichen diesen einen mit der ManagerinID. Wenn eine identische ManagerinID gefunden wurde, geben wir den dazugehörigen Namen aus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name FROM ManagerIn </span>
<span class="c1">#WHERE ManagerinID = ( SELECT ProduzentinID FROM Film WHERE Titel = &quot;Star Wars&quot; AND Jahr = 1977 );</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name FROM ManagerIn WHERE ManagerinID = ( SELECT ProduzentinID FROM Film WHERE Titel = &#39;Star Wars&#39; AND Jahr = 1977 );&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Paul Golding</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Das DBMS erwartet maximal ein Tupel als Ergebnis der Teilanfrage, falls kein Tupel in der Subanfrage gefunden wird, ist das Ergebnis NULL, falls mehr als ein Tupel gefunden werden, wird ein Laufzeitfehler ausgegeben.</p>
<div class="section" id="skalare-subanfragen-beispiel">
<h4><span class="section-number">9.4.2.1. </span>Skalare Subanfragen – Beispiel<a class="headerlink" href="#skalare-subanfragen-beispiel" title="Permalink to this headline">¶</a></h4>
<p>Im folgenden Beispiel suchen wir die Abteilungen, deren durchschnittliche Bonuszahlungen höher sind als deren durchschnittliches Gehalt. Wir verwenden zwei Subanfragen, die einmal die durchschnittliche Bonuszahlung pro Abteilung ausgibt und einmal das durchschnittliche Gehalt pro Abteilung. Zuletzt vergleichen wir diese Werte miteinander und geben nur die aus, wo die durchschnittliche Bonuszahlung höher ist als das jeweilige durchschnittliche Gehalt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT a.Name, a.Standort </span>
<span class="c1">#FROM Abteilung a </span>
<span class="c1">#WHERE (SELECT AVG(bonus) </span>
<span class="c1">#           FROM personal p </span>
<span class="c1">#           WHERE a.AbtID = p.AbtID)&gt;</span>
<span class="c1">#      (SELECT AVG(gehalt)</span>
<span class="c1">#            FROM personal p</span>
<span class="c1">#               WHERE a.AbtID = p.AbtID)</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT a.Name, a.Standort FROM Abteilung a WHERE (SELECT AVG(bonus) FROM personal p WHERE a.AbtID = p.AbtID)&gt;(SELECT AVG(gehalt) FROM personal p WHERE a.AbtID = p.AbtID)&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;abteilung/abteilung.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Standort</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>HR</td>
      <td>Potsdam</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Produktion</td>
      <td>München</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Geschäftsleitung</td>
      <td>Potsdam</td>
    </tr>
    <tr>
      <th>3</th>
      <td>PR</td>
      <td>Potsdam</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Kundendienst</td>
      <td>Hannover</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Buchhaltung</td>
      <td>Potsdam</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In diesem Beispiel suchen wir alle Potsdamer Abteilungen mit ihrem jeweiligen Maximalgehalt. Auch hier benutzen wir wieder eine skalare Subanfrage. Wir geben neben der AbteilungsID, dem Abteilungsnamen, zusätzlich noch das Maximum aller Gehälter der jeweiligen Abteilung als maxGehatlt aus, die sich in Potsdam befindet.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT a.AbtID, a.Name,</span>
<span class="c1">#           (SELECT MAX(Gehalt)</span>
<span class="c1">#                FROM Personal p</span>
<span class="c1">#            WHERE a.AbtID = p.AbtID) AS maxGehalt</span>
<span class="c1">#FROM Abteilung a</span>
<span class="c1">#WHERE a.Ort = ‘Potsdam‘</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT a.AbtID, a.Name, (SELECT MAX(Gehalt) FROM Personal p WHERE a.AbtID = p.AbtID) AS maxGehalt FROM Abteilung a WHERE a.Standort = &#39;Potsdam&#39;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;abteilung/abteilung.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AbtID</th>
      <th>Name</th>
      <th>maxGehalt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1111</td>
      <td>HR</td>
      <td>4536</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1234</td>
      <td>IT</td>
      <td>9999</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2850</td>
      <td>Geschäftsleitung</td>
      <td>2774</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4567</td>
      <td>PR</td>
      <td>2846</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9999</td>
      <td>Buchhaltung</td>
      <td>8653</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In dieser Beispielanfrage suchen wir erneut alle Potsdamer Abteilungen mit ihrem jeweiligen Maximalgehalt. Im Vergleich zu der vorherigen Anfrage, können im Ergebnis dieser Anfrage Abteilungen ohne Mitarbeiter nicht vorkommen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT a.AbtID, a.Name, MAX(p.Gehalt) AS maxGehalt</span>
<span class="c1">#FROM Abteilung a, Personal p</span>
<span class="c1">#WHERE a.Ort = ‘Potsdam‘</span>
<span class="c1">#AND a.AbtID = p.AbtID</span>
<span class="c1">#GROUP BY a.AbtID, a.Name</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT a.AbtID, a.Name, MAX(p.Gehalt) AS maxGehalt FROM Abteilung a, Personal p WHERE a.Standort = &#39;Potsdam&#39; AND a.AbtID = p.AbtID GROUP BY a.AbtID, a.Name&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;abteilung/abteilung.db&quot;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AbtID</th>
      <th>Name</th>
      <th>maxGehalt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1111</td>
      <td>HR</td>
      <td>4536</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1234</td>
      <td>IT</td>
      <td>9999</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2850</td>
      <td>Geschäftsleitung</td>
      <td>2774</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4567</td>
      <td>PR</td>
      <td>2846</td>
    </tr>
    <tr>
      <th>4</th>
      <td>9999</td>
      <td>Buchhaltung</td>
      <td>8653</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="bedingungen-mit-relationen">
<h3><span class="section-number">9.4.3. </span>Bedingungen mit Relationen<a class="headerlink" href="#bedingungen-mit-relationen" title="Permalink to this headline">¶</a></h3>
<p>Nun betrachten wir weitere SQL Operatoren auf Relationen die Boole‘sche Werte erzeugen:
<br><br>
Um zu überprüfen ob eine Relation leer oder nicht ist, kann der EXISTS-Operator benutzt werden:
<br>
EXISTS R gibt TRUE zurück, falls R nicht leer ist
<br><br>
Um zu überprüfen ob ein Wert in einer Relation mind. einmal vorkommt, kann der IN-Operator benutzt werden:
<br>
x IN R gibt TRUE zurück, falls x gleich einem Wert in R ist (R hat nur ein Attribut)
<br><br>
Um zu überprüfen ob x nicht in R vorkommt, kann NOT IN benutzt werden:
<br>
x NOT IN R gibt TRUE zurück, falls x keinem Wert in R gleicht
<br><br>
Um, zu überprüfen ob ein Wert größer als alle Werte in R ist, kann der ALL-Operator benutzt werden:
<br>
x &gt; ALL R gibt TRUE zurück, falls x größer als jeder Wert in R ist (R hat nur ein Attribut)
<br>
x &lt;&gt; ALL R entspricht x NOT IN R bzw. auch NOT(x in R)
<br>
Natürlich kann man alternativ auch die anderen Vergleichsoperatoren verwenden: &lt;, &gt;, &lt;=, &gt;=, &lt;&gt;, =
<br><br>
Um zu überprüfen, ob ein Wert größer als mind. ein Wert aus einer Relation ist, kann der ANY-Operator benutzt werden
<br>
x &gt; ANY R gibt TRUE zurück, falls x größer als mindestens ein Wert in R ist (R hat nur ein Attribut)
<br>
Auch hier kann man natürlich auch alternativ die anderen Vergleichsoperatoren verwenden: &lt;, &gt;, &lt;=, &gt;=, &lt;&gt;, =
<br>
x = ANY R entspricht x IN R
<br>
Ein alternativer Befehl für ANY ist SOME
<br><br>
Die Negation mit NOT(…) ist immer möglich.</p>
</div>
<div class="section" id="exists-beispiele">
<h3><span class="section-number">9.4.4. </span>EXISTS Beispiele<a class="headerlink" href="#exists-beispiele" title="Permalink to this headline">¶</a></h3>
<p>Im folgenden Beispiel wollen wir die ISBNs aller ausgeliehenen Bücher ausgeben. Hierbei verwenden wir den EXISTS-Operator und geben jene ISBNs aus der Relation BuchExemplar aus, dessen Inventarnr in der Relation Ausleihe existiert.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT ISBN</span>
<span class="c1">#FROM BuchExemplar</span>
<span class="c1">#WHERE EXISTS</span>
<span class="c1">#     (SELECT *</span>
<span class="c1">#      FROM Ausleihe</span>
<span class="c1">#      WHERE Ausleihe.Inventarnr = BuchExemplar.Inventarnr) </span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT ISBN FROM BuchExemplar WHERE EXISTS (SELECT * FROM Ausleihe WHERE Ausleihe.Inventarnr = BuchExemplar.Inventarnr) &quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;buecher/buecher.db&quot;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ISBN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>25379173</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48828372</td>
    </tr>
    <tr>
      <th>2</th>
      <td>94488201</td>
    </tr>
    <tr>
      <th>3</th>
      <td>130319953</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3898644006</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Im folgenden Beispiel suchen wir die Lehrstuhlbezeichnungen der Professor*innen, die alle von ihnen gelesenen Vorlesungen auch schon einmal geprüft haben bzw. Lehrstuhlbezeichnungen von Professor*innen, wo keine von diesem/er gelesene Vorlesung existiert, die von ihm/ihr nicht geprüft wurde.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Lehrstuhlbezeichnung</span>
<span class="c1">#FROM Prof</span>
<span class="c1">#WHERE NOT EXISTS</span>
<span class="c1">#      (SELECT *</span>
<span class="c1">#       FROM Liest</span>
<span class="c1">#       WHERE Liest.PANr = Prof.PANr</span>
<span class="c1">#       AND NOT EXISTS (SELECT *</span>
<span class="c1">#                   FROM Prueft</span>
<span class="c1">#                   WHERE Prueft.PANr = Prof.PANr</span>
<span class="c1">#                   AND Prüft.VL_NR = Liest.VL_NR)</span>
<span class="c1">#) </span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Lehrstuhlbezeichnung FROM Prof WHERE NOT EXISTS (SELECT * FROM Liest WHERE Liest.PA_Nr = Prof.PA_Nr AND NOT EXISTS (SELECT * FROM Prueft WHERE Prueft.PA_Nr = Prof.PA_Nr AND Prueft.VL_NR = Liest.VL_NR)) &quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;lehre/lehre.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Lehrstuhlbezeichnung</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Märchen</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Getreidemuehlen</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Kräuterkunde</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="in-beispiele">
<h3><span class="section-number">9.4.5. </span>IN Beispiele<a class="headerlink" href="#in-beispiele" title="Permalink to this headline">¶</a></h3>
<p>Im folgenden Beispiel suchen wir eine Auswahl an Büchern mit bestimmter ISBN.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel</span>
<span class="c1">#FROM Bücher</span>
<span class="c1">#WHERE ISBN IN (3898644006, 1608452204, 0130319953)</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel FROM BuchExemplar WHERE ISBN IN (3898644006, 1608452204, 0130319953)&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;buecher/buecher.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>The Catcher in the Rye</td>
    </tr>
    <tr>
      <th>1</th>
      <td>To Kill a Mockingbird</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Moby Dick</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Hier suchen wir die Matrikelnr. der Studierenden, die zumindest einen Prüfer/in gemeinsam mit dem Studierenden mit der Matrikelnr. ‚123456‘ haben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT DISTINCT Matrikel</span>
<span class="c1">#FROM Prüft</span>
<span class="c1">#WHERE Prüfer IN ( SELECT Prüfer</span>
<span class="c1">#                  FROM Prüft</span>
<span class="c1">#                  WHERE Matrikel = 123456) </span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT Matrikel FROM Prueft WHERE Pruefer IN ( SELECT Pruefer FROM Prueft WHERE Matrikel = 123456) &quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;lehre/lehre.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Matrikel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>123456</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4852</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4757</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8294</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11233</td>
    </tr>
    <tr>
      <th>5</th>
      <td>55940</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Eine Alternativanfrage, welche dieselbe Ausgabe erzeugt, aber nicht den IN-Operator benutzt:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT DISTINCT P1.Matrikel</span>
<span class="c1">#FROM Prueft P1, Prueft P2</span>
<span class="c1">#WHERE P2.Matrikel = 123456</span>
<span class="c1">#AND P1.Pruefer = P2.Pruefer</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT P1.Matrikel FROM Prueft P1, Prueft P2 WHERE P2.Matrikel = 123456 AND P1.Pruefer = P2.Pruefer&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;lehre/lehre.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Matrikel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4757</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4852</td>
    </tr>
    <tr>
      <th>2</th>
      <td>123456</td>
    </tr>
    <tr>
      <th>3</th>
      <td>8294</td>
    </tr>
    <tr>
      <th>4</th>
      <td>11233</td>
    </tr>
    <tr>
      <th>5</th>
      <td>55940</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In diesem Beispiel geben wir alle Nachnamen aller Professor*innen aus, die schon einmal eine 1,0 vergeben haben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Nachname</span>
<span class="c1">#FROM Prof</span>
<span class="c1">#WHERE 1.0 IN ( SELECT Note</span>
<span class="c1">#FROM Prüft</span>
<span class="c1">#WHERE Prüfer = Prof.ID )</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Nachname FROM Prof WHERE 1.0 IN ( SELECT Note FROM Prueft WHERE Pruefer = ProfID )&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;lehre/lehre.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Nachname</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>Achtung: Korrelierte Subanfrage, die Subanfrag wird für jede ProfID ausgeführt.</p>
</div>
<div class="section" id="all-und-any-beispiele">
<h3><span class="section-number">9.4.6. </span>ALL und ANY Beispiele<a class="headerlink" href="#all-und-any-beispiele" title="Permalink to this headline">¶</a></h3>
<p>Im folgenden Beispiel suchen wir die schlechteste Note des Studierenden mit der Matrikelnr. 123456.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Note</span>
<span class="c1">#FROM Prüft</span>
<span class="c1">#WHERE Matrikel = ‘123456‘</span>
<span class="c1">#AND Note &gt;= ALL (SELECT Note</span>
<span class="c1">#                 FROM Prüft</span>
<span class="c1">#                 WHERE Matrikel = ‘123456‘)</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Note FROM Prueft WHERE Matrikel = ‘123456‘ AND Note &gt;= ALL (SELECT Note FROM Prueft WHERE Matrikel = ‘123456‘)&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;lehre/lehre.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OperationalError</span><span class="g g-Whitespace">                          </span>Traceback (most recent call last)
<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2020,</span> in <span class="ni">SQLiteDatabase.execute</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2019</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2020</span>     <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2021</span>     <span class="k">return</span> <span class="n">cur</span>

<span class="ne">OperationalError</span>: near &quot;ALL&quot;: syntax error

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">DatabaseError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">Input In [3],</span> in <span class="ni">&lt;cell line: 10&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Note FROM Prueft WHERE Matrikel = ‘123456‘ AND Note &gt;= ALL (SELECT Note FROM Prueft WHERE Matrikel = ‘123456‘)&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;lehre/lehre.db&quot;</span><span class="p">)</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="n">df</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:399,</span> in <span class="ni">read_sql_query</span><span class="nt">(sql, con, index_col, coerce_float, params, parse_dates, chunksize, dtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">341</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">342</span><span class="sd"> Read SQL query into a DataFrame.</span>
<span class="g g-Whitespace">    </span><span class="mi">343</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span><span class="sd"> parameter will be converted to UTC.</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span> <span class="n">pandas_sql</span> <span class="o">=</span> <span class="n">pandasSQL_builder</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">399</span> <span class="k">return</span> <span class="n">pandas_sql</span><span class="o">.</span><span class="n">read_query</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">400</span>     <span class="n">sql</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">401</span>     <span class="n">index_col</span><span class="o">=</span><span class="n">index_col</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span>     <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span>     <span class="n">coerce_float</span><span class="o">=</span><span class="n">coerce_float</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span>     <span class="n">parse_dates</span><span class="o">=</span><span class="n">parse_dates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">405</span>     <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">406</span>     <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span> <span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2080,</span> in <span class="ni">SQLiteDatabase.read_query</span><span class="nt">(self, sql, index_col, coerce_float, params, parse_dates, chunksize, dtype)</span>
<span class="g g-Whitespace">   </span><span class="mi">2068</span> <span class="k">def</span> <span class="nf">read_query</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2069</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2070</span>     <span class="n">sql</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2076</span>     <span class="n">dtype</span><span class="p">:</span> <span class="n">DtypeArg</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2077</span> <span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">2079</span>     <span class="n">args</span> <span class="o">=</span> <span class="n">_convert_params</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2080</span>     <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2081</span>     <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col_desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">col_desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">2083</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2032,</span> in <span class="ni">SQLiteDatabase.execute</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2029</span>     <span class="k">raise</span> <span class="n">ex</span> <span class="kn">from</span> <span class="nn">inner_exc</span>
<span class="g g-Whitespace">   </span><span class="mi">2031</span> <span class="n">ex</span> <span class="o">=</span> <span class="n">DatabaseError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Execution failed on sql &#39;</span><span class="si">{</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2032</span> <span class="k">raise</span> <span class="n">ex</span> <span class="kn">from</span> <span class="nn">exc</span>

<span class="ne">DatabaseError</span>: Execution failed on sql &#39;SELECT Note FROM Prueft WHERE Matrikel = ‘123456‘ AND Note &gt;= ALL (SELECT Note FROM Prueft WHERE Matrikel = ‘123456‘)&#39;: near &quot;ALL&quot;: syntax error
</pre></div>
</div>
</div>
</div>
<p>Wie man sehen kann wird der Operator ALL nicht von sqlite3 unterstützt. Stattdessen kann man eine äquivalente Anfrage mithilfe MAX() formulieren.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Note FROM Prueft WHERE Matrikel = 123456 AND Note &gt;= (SELECT MAX(Note) FROM Prueft WHERE Matrikel = 123456)&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;lehre/lehre.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Note</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3,0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Im folgenden Beispiel suchen wir alle Studierenden, die mindestens eine Prüfung absolviert haben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name, Matrikel</span>
<span class="c1">#FROM Student</span>
<span class="c1">#WHERE Matrikel = ANY (SELECT Matrikel</span>
<span class="c1">#                      FROM Prueft)</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Matrikel FROM Student WHERE Matrikel = ANY (SELECT Matrikel FROM Prueft)&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;lehre/lehre.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">OperationalError</span><span class="g g-Whitespace">                          </span>Traceback (most recent call last)
<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2020,</span> in <span class="ni">SQLiteDatabase.execute</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2019</span> <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2020</span>     <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2021</span>     <span class="k">return</span> <span class="n">cur</span>

<span class="ne">OperationalError</span>: near &quot;SELECT&quot;: syntax error

<span class="n">The</span> <span class="n">above</span> <span class="n">exception</span> <span class="n">was</span> <span class="n">the</span> <span class="n">direct</span> <span class="n">cause</span> <span class="n">of</span> <span class="n">the</span> <span class="n">following</span> <span class="n">exception</span><span class="p">:</span>

<span class="ne">DatabaseError</span><span class="g g-Whitespace">                             </span>Traceback (most recent call last)
<span class="nn">Input In [4],</span> in <span class="ni">&lt;cell line: 8&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Matrikel FROM Student WHERE Matrikel = ANY (SELECT Matrikel FROM Prueft)&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;lehre/lehre.db&quot;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">8</span> <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">df</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:399,</span> in <span class="ni">read_sql_query</span><span class="nt">(sql, con, index_col, coerce_float, params, parse_dates, chunksize, dtype)</span>
<span class="g g-Whitespace">    </span><span class="mi">341</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">342</span><span class="sd"> Read SQL query into a DataFrame.</span>
<span class="g g-Whitespace">    </span><span class="mi">343</span><span class="sd"> </span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">    </span><span class="mi">396</span><span class="sd"> parameter will be converted to UTC.</span>
<span class="g g-Whitespace">    </span><span class="mi">397</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">398</span> <span class="n">pandas_sql</span> <span class="o">=</span> <span class="n">pandasSQL_builder</span><span class="p">(</span><span class="n">con</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">399</span> <span class="k">return</span> <span class="n">pandas_sql</span><span class="o">.</span><span class="n">read_query</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">400</span>     <span class="n">sql</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">401</span>     <span class="n">index_col</span><span class="o">=</span><span class="n">index_col</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">402</span>     <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">403</span>     <span class="n">coerce_float</span><span class="o">=</span><span class="n">coerce_float</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">404</span>     <span class="n">parse_dates</span><span class="o">=</span><span class="n">parse_dates</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">405</span>     <span class="n">chunksize</span><span class="o">=</span><span class="n">chunksize</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">406</span>     <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">407</span> <span class="p">)</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2080,</span> in <span class="ni">SQLiteDatabase.read_query</span><span class="nt">(self, sql, index_col, coerce_float, params, parse_dates, chunksize, dtype)</span>
<span class="g g-Whitespace">   </span><span class="mi">2068</span> <span class="k">def</span> <span class="nf">read_query</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">2069</span>     <span class="bp">self</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2070</span>     <span class="n">sql</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2076</span>     <span class="n">dtype</span><span class="p">:</span> <span class="n">DtypeArg</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">2077</span> <span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">2079</span>     <span class="n">args</span> <span class="o">=</span> <span class="n">_convert_params</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span> <span class="n">params</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2080</span>     <span class="n">cursor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2081</span>     <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col_desc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">col_desc</span> <span class="ow">in</span> <span class="n">cursor</span><span class="o">.</span><span class="n">description</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">2083</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>

<span class="nn">File ~/anaconda3/lib/python3.9/site-packages/pandas/io/sql.py:2032,</span> in <span class="ni">SQLiteDatabase.execute</span><span class="nt">(self, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">2029</span>     <span class="k">raise</span> <span class="n">ex</span> <span class="kn">from</span> <span class="nn">inner_exc</span>
<span class="g g-Whitespace">   </span><span class="mi">2031</span> <span class="n">ex</span> <span class="o">=</span> <span class="n">DatabaseError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Execution failed on sql &#39;</span><span class="si">{</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39;: </span><span class="si">{</span><span class="n">exc</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2032</span> <span class="k">raise</span> <span class="n">ex</span> <span class="kn">from</span> <span class="nn">exc</span>

<span class="ne">DatabaseError</span>: Execution failed on sql &#39;SELECT Name, Matrikel FROM Student WHERE Matrikel = ANY (SELECT Matrikel FROM Prueft)&#39;: near &quot;SELECT&quot;: syntax error
</pre></div>
</div>
</div>
</div>
<p>Wie man sehen kann wird der Operator ANY nicht von sqlite3 unterstützt. Stattdessen kann man eine äquivalente Anfrage mithilfe IN formulieren.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Matrikel FROM Student WHERE Matrikel IN (SELECT Matrikel FROM Prueft)&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;lehre/lehre.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Matrikel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Anna Kraft</td>
      <td>4757</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Hans Meyer</td>
      <td>4852</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Guenther Goethe</td>
      <td>8294</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Svenja Krug</td>
      <td>11233</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Clara Hund</td>
      <td>55940</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Max Mustermann</td>
      <td>123456</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="bedingungen-mit-tupeln">
<h3><span class="section-number">9.4.7. </span>Bedingungen mit Tupeln<a class="headerlink" href="#bedingungen-mit-tupeln" title="Permalink to this headline">¶</a></h3>
<p>Verallgemeinerungen von IN, ALL und ANY auf Tupel sind auch möglich.
<br><br>
t IN R gibt TRUE zurück, falls t ein Tupel in R ist (mehr als ein Attribut möglich). Hierbei ist vorausgesetzt, dass beide dasselbe Schemata haben und dieselbe Reihenfolge der Attribute.
<br><br>
t &gt; ALL R gibt TRUE zurück, falls t größer als jedes Tupel in R ist. Die Vergleiche finden in Standardreihenfolge der Attribute statt.
<br><br>
t &lt;&gt; ANY R gibt TRUE zurück, falls R mindestens ein Tupel hat, das ungleich t ist.
<br>
<br>
Im folgenden Beispiel wollen wir alle Namen von Produzenten von Filmen mit Harrison Ford ausgeben. Wir suchen erst Titel und Jahr aller Filme mit Harrison Ford mithilfe einer Subanfrage. Für jene Filme suchen wir dann die ProduzentinIDs und gleichen die mit den ManagerinIDs ab, zuletzt geben wir die Namen der passenden Manager*Innen aus.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name </span>
<span class="c1">#FROM ManagerIn </span>
<span class="c1">#WHERE ManagerinID IN( SELECT ProduzentinID FROM Film WHERE (Titel, Jahr) </span>
<span class="c1">#IN( SELECT FilmTitel AS Titel, FilmJahr AS Jahr FROM spielt_in WHERE Name = &quot;Harrison Ford&quot;));</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name FROM ManagerIn WHERE ManagerinID IN( SELECT ProduzentinID FROM Film WHERE (Titel, Jahr) IN( SELECT FilmTitel AS Titel, FilmJahr AS Jahr FROM spielt_in WHERE Name = &#39;Harrison Ford&#39;))&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Paul Golding</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Es gibt auch eine alternative Formulierung der Anfrage ohne IN. Wir joinen ManagerIn, Film und spielt_in und geben jene Manager*Innamen aus, wo spielt_in.Name Harrison Ford entspricht.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT ManagerIn.Name </span>
<span class="c1">#FROM ManagerIn, Film, spielt_in </span>
<span class="c1">#WHERE ManagerinID = ProduzentinID </span>
<span class="c1">#AND Titel = FilmTitel </span>
<span class="c1">#AND Jahr = FilmJahr </span>
<span class="c1">#AND spielt_in.Name = &quot;Harrison Ford&quot;;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT ManagerIn.Name FROM ManagerIn, Film, spielt_in WHERE ManagerinID = ProduzentinID AND Titel = FilmTitel AND Jahr = FilmJahr AND spielt_in.Name = &#39;Harrison Ford&#39;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Paul Golding</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="subanfragen-in-from-klausel">
<h3><span class="section-number">9.4.8. </span>Subanfragen in FROM-Klausel<a class="headerlink" href="#subanfragen-in-from-klausel" title="Permalink to this headline">¶</a></h3>
<p>Wir können anstelle einer einfachen Relation auch eine geklammerte Subanfrage in der FROM-Klausel schreiben. Der Subanfrage mussein Alias vergeben werden, um auf die Attribute zuzugreifen.
<br><br>
Im folgenden Beispiel wollen wir wieder alle Namen von Produzenten von Filmen mit Harrison Ford ausgeben. Wir stellen eine Subanfrage in der FROM-Klausel, die alle ProduzentinIDs zurückgibt, welche in Filmen mit Harrison Ford beteiligt waren. Zum Schluss werden die ProduzentinIDs wieder mit den ManagerinIDs abgeglichen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT M.Name </span>
<span class="c1">#FROM ManagerIn M, (SELECT ProduzentinID AS ID FROM Film, spielt_in WHERE Titel = FilmTitel AND Jahr = FilmJahr AND Name = &quot;Harrison Ford&quot;) ProduzentIn </span>
<span class="c1">#WHERE M.ManagerinID = ProduzentIn.ID;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT M.Name FROM ManagerIn M, (SELECT ProduzentinID AS ID FROM Film, spielt_in WHERE Titel = FilmTitel AND Jahr = FilmJahr AND Name = &#39;Harrison Ford&#39;) ProduzentIn WHERE M.ManagerinID = ProduzentIn.ID&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Paul Golding</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="korrelierte-subanfragen">
<h3><span class="section-number">9.4.9. </span>Korrelierte Subanfragen<a class="headerlink" href="#korrelierte-subanfragen" title="Permalink to this headline">¶</a></h3>
<p>Wird eine Subanfragen einmalig ausgeführt, so handelt es sich um eine unkorrelierte Subanfrage. Korrelierte Subanfragen werden mehrfach ausgeführt, undzwar einmal pro Bindung der korrelierten Variable der äußeren Anfrage.
<br><br>
Im folgenden ein Beispiel für eine korrelierte Subanfrage. Wir suchen alle mehrfachen Filme mit Ausnahme der jeweils jüngsten Ausgabe. Die Subanfrage wird für jedes Tupel in Filme ausgeführt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel, Jahr </span>
<span class="c1">#FROM Film Alt </span>
<span class="c1">#WHERE Jahr &lt; ANY ( SELECT Jahr FROM Film WHERE Titel = Alt.Titel);</span>


<span class="c1">#ohne ANY</span>
<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel, Jahr FROM Film Alt WHERE Jahr &lt; (SELECT MIN(Jahr) FROM Film WHERE Titel = Alt.Titel)&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>Nun suchen wir die Namen und Gehälter aller Mitarbeiter*Innen in Potsdam, wir formulieren zunächst eine Anfrage mit einer unkorrelierten und dann eine mit einr korrelierte Subanfrage.
<br><br>
Unten wird die Subanfrage nur einmal ausgeführt, da wir sofort alle AbtIDs haben. Daher handelt es sich hierbei um eine unkorrelierte Subanfrage.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name, Gehalt</span>
<span class="c1">#FROM Personal p</span>
<span class="c1">#WHERE AbtID IN</span>
<span class="c1">#    (SELECT AbtID</span>
<span class="c1">#    FROM Abteilung</span>
<span class="c1">#    WHERE Ort =</span>
<span class="c1">#‘Potsdam‘)</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Gehalt FROM Personal p WHERE AbtID IN (SELECT AbtID FROM Abteilung WHERE Standort = &#39;Potsdam&#39;)&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;abteilung/abteilung.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Gehalt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cem Urban</td>
      <td>3645</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jonathan Müller</td>
      <td>4536</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Anna Graf</td>
      <td>2345</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Erik Meyer</td>
      <td>9999</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Max Mustermann</td>
      <td>4567</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Diana Bakker</td>
      <td>2774</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Sascha Stark</td>
      <td>2846</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Hans Meyer</td>
      <td>2675</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Peter Silie</td>
      <td>8653</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Hierbei handelt es sich um eine korrelierte Subanfrage, aufgrund des p.AbtID, da die Subanfrage für jedes Tupel aus Personal p ausgeführt werden muss.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name, Gehalt</span>
<span class="c1">#FROM Personal p</span>
<span class="c1">#WHERE Gehalt &gt;</span>
<span class="c1">#    (SELECT 0.1*Budget</span>
<span class="c1">#    FROM Abteilung a</span>
<span class="c1">#    WHERE a.AbtID =</span>
<span class="c1">#p.AbtID)</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, Gehalt FROM Personal p WHERE Gehalt &gt; (SELECT 0.1*Budget FROM Abteilung a WHERE a.AbtID = p.AbtID)&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;abteilung/abteilung.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Gehalt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Jonathan Müller</td>
      <td>4536</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Peter Silie</td>
      <td>8653</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jasmin Helmstedt</td>
      <td>3574</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="operationen-auf-einer-relation">
<h2><span class="section-number">9.5. </span>Operationen auf einer Relation<a class="headerlink" href="#operationen-auf-einer-relation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="duplikateliminierung">
<h3><span class="section-number">9.5.1. </span>Duplikateliminierung<a class="headerlink" href="#duplikateliminierung" title="Permalink to this headline">¶</a></h3>
<p>Relationale DBMS verwenden i.d.R. Multimengensemantik, nicht Mengensemantik.
<br>
□ Duplikate entstehen durch
<br>
– Einfügen von Duplikaten in Basisrelation
<br>
– Veränderung von Tupeln in Basisrelation
<br>
– Projektion in Anfragen
<br>
– Durch Subanfragen (UNION ALL)
<br>
– Vermehrung von Duplikaten durch Kreuzprodukt
<br> <br>
■ Duplikateliminierung
<br>
□ SELECT DISTINCT Attributnamen
<br>
□ Kosten sind hoch: Sortierung oder hashing
<br>
■ Alle Filme, in denen mindestens ein Schauspieler mitspielt</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT DISTINCT FilmTitel, FilmJahr </span>
<span class="c1">#FROM spielt_in</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT FilmTitel, FilmJahr FROM spielt_in&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FilmTitel</th>
      <th>FilmJahr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Star Wars</td>
      <td>1977</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Into the Wild</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>3</th>
      <td>The Dark Knight</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>4</th>
      <td>The Lighthouse</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>5</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Lady Bird</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>7</th>
      <td>La Heine</td>
      <td>1995</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Mamma Mia!</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Inside Out</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Total Recall</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Pulp Fiction</td>
      <td>1994</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Up</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Spider-Man</td>
      <td>2002</td>
    </tr>
    <tr>
      <th>14</th>
      <td>La La Land</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Moonlight</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Star Trek</td>
      <td>1979</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>18</th>
      <td>House of Gucci</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>19</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><img alt="title" src="../_images/duplikateliminierung.jpg" /></p>
<div class="section" id="wdh-duplikateliminierung-bei-mengenoperationen">
<h4><span class="section-number">9.5.1.1. </span>Wdh.: Duplikateliminierung bei Mengenoperationen<a class="headerlink" href="#wdh-duplikateliminierung-bei-mengenoperationen" title="Permalink to this headline">¶</a></h4>
<p>■ Mengenoperationen in SQL entfernen Duplikate
<br>
□ UNION, INTERSECT, EXCEPT
<br>
□ wandeln Multimengen in Mengen um und verwenden Mengensemantik
<br>
□ Solche Duplikateliminierung verhindern durch ALL
<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#(SELECT Titel, Jahr, FROM Film) UNION ALL (SELECT FilmTitel AS Titel, FilmJahr AS Jahr FROM spielt_in);</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel, Jahr FROM Film UNION ALL SELECT FilmTitel AS Titel, FilmJahr AS Jahr FROM spielt_in&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Inside Out</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Toy Story</td>
      <td>1999</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Up</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Ratatouille</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Star Wars</td>
      <td>1977</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Star Trek</td>
      <td>1979</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Lady Bird</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Into the Wild</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>9</th>
      <td>The Lighthouse</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Roma</td>
      <td>2018</td>
    </tr>
    <tr>
      <th>11</th>
      <td>La Heine</td>
      <td>1995</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Total Recall</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Mamma Mia!</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>14</th>
      <td>The Dark Knight</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Pulp Fiction</td>
      <td>1994</td>
    </tr>
    <tr>
      <th>16</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Spider-Man</td>
      <td>2002</td>
    </tr>
    <tr>
      <th>18</th>
      <td>La La Land</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Moonlight</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>21</th>
      <td>House of Gucci</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>22</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Shipwrecked</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>24</th>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Gone with the Wind</td>
      <td>1939</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Star Wars</td>
      <td>1977</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Star Wars</td>
      <td>1977</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Star Wars</td>
      <td>1977</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Into the Wild</td>
      <td>2007</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Brokeback Mountain</td>
      <td>2005</td>
    </tr>
    <tr>
      <th>32</th>
      <td>The Dark Knight</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>33</th>
      <td>The Lighthouse</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>34</th>
      <td>The Lighthouse</td>
      <td>2019</td>
    </tr>
    <tr>
      <th>35</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>36</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>37</th>
      <td>The Great Gatsby</td>
      <td>2013</td>
    </tr>
    <tr>
      <th>38</th>
      <td>Lady Bird</td>
      <td>2017</td>
    </tr>
    <tr>
      <th>39</th>
      <td>La Heine</td>
      <td>1995</td>
    </tr>
    <tr>
      <th>40</th>
      <td>Mamma Mia!</td>
      <td>2008</td>
    </tr>
    <tr>
      <th>41</th>
      <td>Inside Out</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Total Recall</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>43</th>
      <td>Total Recall</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>44</th>
      <td>Pulp Fiction</td>
      <td>1994</td>
    </tr>
    <tr>
      <th>45</th>
      <td>Up</td>
      <td>2009</td>
    </tr>
    <tr>
      <th>46</th>
      <td>Spider-Man</td>
      <td>2002</td>
    </tr>
    <tr>
      <th>47</th>
      <td>Spider-Man</td>
      <td>2002</td>
    </tr>
    <tr>
      <th>48</th>
      <td>Spider-Man</td>
      <td>2002</td>
    </tr>
    <tr>
      <th>49</th>
      <td>La La Land</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>50</th>
      <td>La La Land</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>51</th>
      <td>Moonlight</td>
      <td>2016</td>
    </tr>
    <tr>
      <th>52</th>
      <td>Star Trek</td>
      <td>1979</td>
    </tr>
    <tr>
      <th>53</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
    </tr>
    <tr>
      <th>54</th>
      <td>House of Gucci</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>55</th>
      <td>House of Gucci</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>56</th>
      <td>House of Gucci</td>
      <td>2021</td>
    </tr>
    <tr>
      <th>57</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>58</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
    </tr>
    <tr>
      <th>59</th>
      <td>James Bond 007: Spectre</td>
      <td>2015</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>– Film mit drei Schauspielern erscheint also 4 Mal im Ergebnis
<br>
□ R INTERSECT ALL S
<br>
□ R EXCEPT ALL S</p>
</div>
</div>
<div class="section" id="aggregation">
<h3><span class="section-number">9.5.2. </span>Aggregation<a class="headerlink" href="#aggregation" title="Permalink to this headline">¶</a></h3>
<p>■ Standardaggregationsoperatoren
<br>
□ SUM, AVG, MIN, MAX, COUNT
<br>
□ Angewendet auf einzelne Attribute in der SELECT-Klausel
<br><br>
■ Typische weitere Aggregationsoperatoren
<br>
□ VAR, STDDEV
<br><br>
■ COUNT(*) zählt Anzahl der Tupel
<br>
□ in der Relation, die durch die FROM und WHERE Klauseln definiert wird.
<br><br>
■ Kombination mit DISTINCT
<br>
□ COUNT(DISTINCT Jahr)
<br>
□ SUM(DISTINCT Gehalt)</p>
<div class="section" id="aggregation-beispiele">
<h4><span class="section-number">9.5.2.1. </span>Aggregation – Beispiele<a class="headerlink" href="#aggregation-beispiele" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT AVG(Gehalt) </span>
<span class="c1">#FROM ManagerIn;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT AVG(Gehalt) FROM ManagerIn&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AVG(Gehalt)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>251938.933333</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT COUNT(*) </span>
<span class="c1">#FROM spielt_in;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT COUNT(*) FROM spielt_in;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT(*)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT COUNT(Name) </span>
<span class="c1">#FROM spielt_in;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT COUNT(Name) FROM spielt_in;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT(Name)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>34</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT COUNT(DISTINCT Name) </span>
<span class="c1">#FROM spielt_in </span>
<span class="c1">#WHERE FilmJahr = 1990;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT COUNT(DISTINCT Name) FROM spielt_in WHERE FilmJahr = 1990;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT(DISTINCT Name)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="gruppierung-aggregation-und-null">
<h3><span class="section-number">9.5.3. </span>Gruppierung, Aggregation und NULL<a class="headerlink" href="#gruppierung-aggregation-und-null" title="Permalink to this headline">¶</a></h3>
<p>■ NULL wird bei Aggregation ignoriert.
<br>
□ Trägt also nicht zu SUM, AVG oder COUNT bei.
<br>
□ Ist nicht MIN oder MAX
<br>
□ Anzahl Tupel: SELECT COUNT(*) FROM spielt_in;
<br>
□ Anzahl nicht-NULL Werte: SELECT COUNT(Länge) FROM Film;
<br><br>
■ NULL ist ein eigener Gruppierungswert
<br>
□ Es gibt also z.B. die NULL-Gruppe
<br>
□ SELECT A, COUNT(B) FROM R GROUP BY A;
<br>
– Ergebnis: (NULL, 0)
<br>
□ SELECT A, SUM(B) FROM R GROUP BY A;
<br>
– Ergebnis: (NULL, NULL)
<br></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>A</p></th>
<th class="head"><p>B</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NULL</p></td>
<td><p>NULL</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="gruppierung">
<h3><span class="section-number">9.5.4. </span>Gruppierung<a class="headerlink" href="#gruppierung" title="Permalink to this headline">¶</a></h3>
<p>■ Gruppierung mittels GROUP BY nach der WHERE-Klausel</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT StudioName, SUM(Laenge) </span>
<span class="c1">#FROM Film GROUP BY StudioName</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT StudioName, SUM(Laenge) FROM Film GROUP BY StudioName&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>StudioName</th>
      <th>SUM(Laenge)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A Band Apart</td>
      <td>154</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A24</td>
      <td>233</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Disney</td>
      <td>419</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Fox</td>
      <td>113</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Littlestar Productions</td>
      <td>108</td>
    </tr>
    <tr>
      <th>5</th>
      <td>MGM</td>
      <td>527</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Marvel Enterprises</td>
      <td>121</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NULL</td>
      <td>98</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Paramount</td>
      <td>148</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Paramount</td>
      <td>132</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Participant</td>
      <td>135</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Pinewood</td>
      <td>121</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Pixar</td>
      <td>207</td>
    </tr>
    <tr>
      <th>13</th>
      <td>River Road</td>
      <td>134</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Scott Rudin Productions</td>
      <td>95</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Summit Entertainment</td>
      <td>128</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Village Roadshows</td>
      <td>142</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Warner Bros.</td>
      <td>152</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>■ In SELECT-Klausel zwei „Sorten“ von Attributen
<br></p>
<ol class="simple">
<li><p>Gruppierungsattribute
<br></p></li>
<li><p>Aggregierte Attribute
<br>
□ Nicht-aggregierte Werte der SELECT-Klausel müssen in der GROUP BY-Klausel erscheinen.
<br>
□ Keine der beiden Sorten muss erscheinen.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT StudioName </span>
<span class="c1">#FROM Film </span>
<span class="c1">#GROUP BY StudioName</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT StudioName FROM Film GROUP BY StudioName&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>StudioName</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A Band Apart</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A24</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Disney</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Fox</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Littlestar Productions</td>
    </tr>
    <tr>
      <th>5</th>
      <td>MGM</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Marvel Enterprises</td>
    </tr>
    <tr>
      <th>7</th>
      <td>NULL</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Paramount</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Paramount</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Participant</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Pinewood</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Pixar</td>
    </tr>
    <tr>
      <th>13</th>
      <td>River Road</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Scott Rudin Productions</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Summit Entertainment</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Village Roadshows</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Warner Bros.</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT SUM(Laenge) </span>
<span class="c1">#FROM Film </span>
<span class="c1">#GROUP BY StudioName</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT SUM(Laenge) FROM Film GROUP BY StudioName&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>SUM(Laenge)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>154</td>
    </tr>
    <tr>
      <th>1</th>
      <td>233</td>
    </tr>
    <tr>
      <th>2</th>
      <td>419</td>
    </tr>
    <tr>
      <th>3</th>
      <td>113</td>
    </tr>
    <tr>
      <th>4</th>
      <td>108</td>
    </tr>
    <tr>
      <th>5</th>
      <td>527</td>
    </tr>
    <tr>
      <th>6</th>
      <td>121</td>
    </tr>
    <tr>
      <th>7</th>
      <td>98</td>
    </tr>
    <tr>
      <th>8</th>
      <td>148</td>
    </tr>
    <tr>
      <th>9</th>
      <td>132</td>
    </tr>
    <tr>
      <th>10</th>
      <td>135</td>
    </tr>
    <tr>
      <th>11</th>
      <td>121</td>
    </tr>
    <tr>
      <th>12</th>
      <td>207</td>
    </tr>
    <tr>
      <th>13</th>
      <td>134</td>
    </tr>
    <tr>
      <th>14</th>
      <td>95</td>
    </tr>
    <tr>
      <th>15</th>
      <td>128</td>
    </tr>
    <tr>
      <th>16</th>
      <td>142</td>
    </tr>
    <tr>
      <th>17</th>
      <td>152</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>■ Gruppierung bei Verwendung mehrerer Relationen wird am Schluss durchgeführt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name, SUM(Laenge) </span>
<span class="c1">#FROM ManagerIn, Film </span>
<span class="c1">#WHERE ManagerinID = ProduzentinID </span>
<span class="c1">#GROUP BY Name</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, SUM(Laenge) FROM ManagerIn, Film WHERE ManagerinID = ProduzentinID GROUP BY Name&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>SUM(Laenge)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alan Bruckner</td>
      <td>108</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ann Sarnoff</td>
      <td>121</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bill Pohlad</td>
      <td>280</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bob Chapek</td>
      <td>419</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Brian Robbins</td>
      <td>134</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Daniel Katz</td>
      <td>233</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Isaac Perlmutter</td>
      <td>152</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Jim Berk</td>
      <td>263</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jim Morris</td>
      <td>207</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Louis B.Mayer</td>
      <td>527</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Paul Golding</td>
      <td>121</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Quentin Tarantino</td>
      <td>154</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Robert Kirby</td>
      <td>142</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Scott Rudin</td>
      <td>95</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Steve Asbell</td>
      <td>113</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>■ Reihenfolge der Ausführung (und des Lesens)
<br></p>
<ol class="simple">
<li><p>FROM-Klausel
<br></p></li>
<li><p>WHERE-Klausel
<br></p></li>
<li><p>GROUP BY-Klausel
<br></p></li>
<li><p>SELECT-Klausel
<br>
<br>
■ Einschränkung der Ergebnismenge nach der Gruppierung durch HAVING</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name, SUM(Laenge) </span>
<span class="c1">#FROM ManagerIn, Film </span>
<span class="c1">#WHERE ManagerinID = ProduzentinID </span>
<span class="c1">#AND Gehalt &gt; 1000000 GROUP BY Name</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, SUM(Laenge) FROM ManagerIn, Film WHERE ManagerinID = ProduzentinID AND Gehalt &gt; 1000000 GROUP BY Name&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>SUM(Laenge)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alan Bruckner</td>
      <td>108</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ann Sarnoff</td>
      <td>121</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bill Pohlad</td>
      <td>280</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Bob Chapek</td>
      <td>419</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Brian Robbins</td>
      <td>134</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Daniel Katz</td>
      <td>233</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Isaac Perlmutter</td>
      <td>152</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Jim Berk</td>
      <td>263</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jim Morris</td>
      <td>207</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Louis B.Mayer</td>
      <td>527</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Paul Golding</td>
      <td>121</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Quentin Tarantino</td>
      <td>154</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Robert Kirby</td>
      <td>142</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Scott Rudin</td>
      <td>95</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Steve Asbell</td>
      <td>113</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name, SUM(Laenge) </span>
<span class="c1">#FROM ManagerIn, Film </span>
<span class="c1">#WHERE ManagerinID = ProduzentinID </span>
<span class="c1">#GROUP BY Name HAVING SUM(Laenge) &gt; 200</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name, SUM(Laenge) FROM ManagerIn, Film WHERE ManagerinID = ProduzentinID GROUP BY Name HAVING SUM(Laenge) &gt; 200&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>SUM(Laenge)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bill Pohlad</td>
      <td>280</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob Chapek</td>
      <td>419</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Daniel Katz</td>
      <td>233</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jim Berk</td>
      <td>263</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jim Morris</td>
      <td>207</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Louis B.Mayer</td>
      <td>527</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Name </span>
<span class="c1">#FROM ManagerIn, Film </span>
<span class="c1">#WHERE ManagerinID = ProduzentinID </span>
<span class="c1">#GROUP BY Name HAVING SUM(Laenge) &gt; 200</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name FROM ManagerIn, Film WHERE ManagerinID = ProduzentinID GROUP BY Name HAVING SUM(Laenge) &gt; 200&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Bill Pohlad</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bob Chapek</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Daniel Katz</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Jim Berk</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jim Morris</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Louis B.Mayer</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>■ Aggregationen in HAVING-Klausel beziehen sich nur auf aktuelle Gruppe.
<br>
■ Nur Gruppierungsattribute dürfen un-aggregiert in HAVING Klausel erscheinen (wie bei
SELECT-Klausel).</p>
</div>
<div class="section" id="zusammenfassung-sql">
<h3><span class="section-number">9.5.5. </span>Zusammenfassung SQL<a class="headerlink" href="#zusammenfassung-sql" title="Permalink to this headline">¶</a></h3>
<p>Grundbausteine einer SQL Anfrage (mit empfohlener Lesereihenfolge)
<br>
□ 6. SELECT
<br>
□ 1. FROM
<br>
□ 2. WHERE
<br>
□ 3. GROUP BY
<br>
□ 4. HAVING
<br>
□ 5. ORDER BY
<br><br>
■ SELECT … FROM … sind Pflicht.
<br>
□ Ausnahme: z.B. SELECT 7 + 3
<br><br>
■ HAVING darf nur in Kombination mit GROUP BY erscheinen.</p>
</div>
</div>
<div class="section" id="datenbearbeitung-dml">
<h2><span class="section-number">9.6. </span>Datenbearbeitung(DML)<a class="headerlink" href="#datenbearbeitung-dml" title="Permalink to this headline">¶</a></h2>
<div class="section" id="uberblick">
<h3><span class="section-number">9.6.1. </span>Überblick<a class="headerlink" href="#uberblick" title="Permalink to this headline">¶</a></h3>
<p>■  CRUD: Create, Read, Update, Delete
<br><br>
■ Einfügen
<br>
□ INSERT INTO … VALUES…
<br><br>
■ Löschen
<br>
□ DELETE FROM … WHERE …
<br><br>
■ Ändern
<br>
□ UPDATE … SET … WHERE …</p>
</div>
<div class="section" id="einfugen">
<h3><span class="section-number">9.6.2. </span>Einfügen<a class="headerlink" href="#einfugen" title="Permalink to this headline">¶</a></h3>
<p>■ Grundbaustein
<br>
□ INSERT INTO R(A1, …, An) VALUES (v1,…,vn);
<br>
□ Bei fehlenden Attributen
<br>
– Default-Wert aus Tabellendefinition (NULL, falls nicht anders angegeben)
<br>
□ Beispiel</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> INSERT INTO spielt_in(FilmTitel, FilmJahr, Schauspieler) VALUES (‘Star Wars‘, 1977, ‘Alec Guinness‘);
</pre></div>
</div>
</div>
</div>
<p>– Reihenfolge der Werte und Attribute wird beachtet.</p>
<p>□ Falls alle Attribute gesetzt werden, kann Attributliste fehlen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span> INSERT INTO spielt_in VALUES (‘Star Wars‘, 1977, ‘Alec Guinness‘);
</pre></div>
</div>
</div>
</div>
<p>– Reihenfolge entsprechend der Spezifikation des Schemas
(CREATE TABLE …)</p>
<div class="section" id="einfugen-per-anfrage">
<h4><span class="section-number">9.6.2.1. </span>Einfügen per Anfrage<a class="headerlink" href="#einfugen-per-anfrage" title="Permalink to this headline">¶</a></h4>
<p>Füge in Studio-Tabelle alle Studios der Filme-Relation ein
<br>
□ Film(Titel, Jahr, Länge, inFarbe, StudioName, ProduzentinID)
<br>
□ Studio(Name, Adresse, VorsitzendeID)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">Studio</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">DISTINCT</span> <span class="n">StudioName</span>
<span class="n">FROM</span> <span class="n">Film</span>
<span class="n">WHERE</span> <span class="n">StudioName</span> <span class="n">NOT</span> <span class="n">IN</span>
    <span class="p">(</span><span class="n">SELECT</span> <span class="n">Name</span>
    <span class="n">FROM</span> <span class="n">Studio</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>Adresse und VorsitzendeIDbleiben NULL.
<br>
□ Erzeugt im Allgemeinen Redundanz und sollte vermieden werden.</p>
</div>
</div>
<div class="section" id="ausfuhrungsreihenfolge-beim-einfugen">
<h3><span class="section-number">9.6.3. </span>Ausführungsreihenfolge beim Einfügen<a class="headerlink" href="#ausfuhrungsreihenfolge-beim-einfugen" title="Permalink to this headline">¶</a></h3>
<p>Wann wird eingefügt?
<br>
Nach vollständiger Ausführung der SELECT FROM WHERE Anfrage?
<br>
Sofort?
<br>
Schnellere Implementation
<br>
Was passiert jeweils bei Anfrage 1?
<br>
Was passiert jeweils bei Anfrage 2?
<br>
SQL Standard: Erst gesamte Anfrage ausführen</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">Studio</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">DISTINCT</span> <span class="n">StudioName</span>
<span class="n">FROM</span> <span class="n">Film</span>
<span class="n">WHERE</span> <span class="n">StudioName</span> <span class="n">NOT</span> <span class="n">IN</span>
    <span class="p">(</span><span class="n">SELECT</span> <span class="n">Name</span>
    <span class="n">FROM</span> <span class="n">Studio</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">Studio</span><span class="p">(</span><span class="n">Name</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">StudioName</span>
<span class="n">FROM</span> <span class="n">Film</span>
<span class="n">WHERE</span> <span class="n">StudioName</span> <span class="n">NOT</span> <span class="n">IN</span>
    <span class="p">(</span><span class="n">SELECT</span> <span class="n">Name</span>
    <span class="n">FROM</span> <span class="n">Studio</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="bulk-insert">
<h4><span class="section-number">9.6.3.1. </span>Bulk insert<a class="headerlink" href="#bulk-insert" title="Permalink to this headline">¶</a></h4>
<p>■ INSERT
<br>
□ Zeilenbasiertes Einfügen aus SQL statements
<br><br>
■ IMPORT
<br>
□ Zeilen-basiertes Einfügen aus Datei
<br>
□ Trigger und Nebenbedingungen bleiben aktiv
<br>
□ Indizes werden laufend aktualisiert
<br><br>
■ LOAD
<br>
□ Seiten-basiertes Einfügen aus Datei
<br>
□ Trigger und Nebenbedingungen werden deaktiviert
<br>
□ Deutlich effizienter
<br>
□ Indizes werden am Ende neu generiert
<br><br>
■ Syntax ist jeweils DBMS-spezifisch.
<br>
□ Viele Parameter</p>
</div>
</div>
<div class="section" id="loschen">
<h3><span class="section-number">9.6.4. </span>Löschen<a class="headerlink" href="#loschen" title="Permalink to this headline">¶</a></h3>
<p>■ Grundbaustein
<br>
□ DELETE FROM R WHERE …
<br>
□ Lösche alle Tupel in R, für die die Bedingung wahr ist.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
DELETE FROM spielt_in
WHERE FilmTitel = ‘The Maltese Falcon‘
AND FilmJahr = 1942
AND Schauspieler = ‘Sydney Greenstreet‘;
</pre></div>
</div>
</div>
</div>
<p>■ Tupel können im Gegensatz zum Einfügen nicht direkt angegeben werden, sondern müssen umschrieben werden.
<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">DELETE</span> <span class="n">FROM</span> <span class="n">Manager</span>
<span class="n">WHERE</span> <span class="n">Gehalt</span> <span class="o">&lt;</span> <span class="mi">10000000</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>■ Alle Manager-Tupel löschen: DELETE FROM Manager;</p>
</div>
<div class="section" id="verandern-update">
<h3><span class="section-number">9.6.5. </span>Verändern (update)<a class="headerlink" href="#verandern-update" title="Permalink to this headline">¶</a></h3>
<p>■ Grundbaustein
<br>
□ UPDATE R SET … WHERE …
<br>
□ SET Klausel
<br>
– Wertzuweisungen
<br>
– Komma-separiert
<br></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
UPDATE Manager
SET Name = ‘Präs. ‘ || Name
WHERE ManagerinID IN
(SELECT PräsidentID FROM Studios);
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="schemata-ddl">
<h2><span class="section-number">9.7. </span>Schemata(DDL)<a class="headerlink" href="#schemata-ddl" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id2">
<h3><span class="section-number">9.7.1. </span>Überblick<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>■ Datentypen
<br>
■ Tabellen
<br>
■ Default-Werte
<br>
■ Indizes</p>
</div>
<div class="section" id="datentypen">
<h3><span class="section-number">9.7.2. </span>Datentypen<a class="headerlink" href="#datentypen" title="Permalink to this headline">¶</a></h3>
<p>■ Jedes Attribut muss einen Datentyp haben.
<br>
□ CHAR(n) – String fester Länge (n Zeichen)
<br>
□ VARCHAR(n) – String variabler Länge, maximal n Zeichen
<br>
□ BIT(n) bzw. BIT VARYING(n) – Wie CHAR, aber Bits
<br>
□ BOOLEAN – TRUE, FALSE oder UNKNOWN
<br>
□ INT / INTEGER bzw. SHORTINT – 8 bzw. 4 Byte
<br>
□ FLOAT / REAL bzw. DOUBLE PRECISION
<br>
□ DECIMAL (n,d) – Z.B. Gehalt DECIMAL(7,2) – 7 Stellen, davon 2 Nachkommastellen
<br>
□ CLOB und BLOB</p>
</div>
<div class="section" id="uberblick-db2-datentypen">
<h3><span class="section-number">9.7.3. </span>Überblick DB2 Datentypen<a class="headerlink" href="#uberblick-db2-datentypen" title="Permalink to this headline">¶</a></h3>
<p><img alt="title" src="../_images/db2_datentypen.jpg" /></p>
</div>
<div class="section" id="tabellen">
<h3><span class="section-number">9.7.4. </span>Tabellen<a class="headerlink" href="#tabellen" title="Permalink to this headline">¶</a></h3>
<p>■ Grundbaustein zum Erzeugen</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
CREATE TABLE R …
CREATE TABLE Schauspieler (
Name CHAR(30),
Adresse VARCHAR(255),
Geschlecht CHAR(1),
Geburtstag DATE );
</pre></div>
</div>
</div>
</div>
<p>■ Löschen
<br>
□ DROP TABLE Schauspieler;
<br><br>
■ Verändern
<br>
□ ALTER TABLE Schauspieler ADD Telefon CHAR(6);
<br>
– Nullwerte entstehen
<br>
□ ALTER TABLE Schauspieler DROP Geburtstag;
<br>
□ ALTER TABLE Schauspieler MODIFY Telefon CHAR(10);</p>
</div>
<div class="section" id="default-werte">
<h3><span class="section-number">9.7.5. </span>Default-Werte<a class="headerlink" href="#default-werte" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
CREATE TABLE Schauspieler (
Name CHAR(30),
Adresse VARCHAR(255),
Geschlecht CHAR(1) DEFAULT ‚?‘,
Geburtstag DATE DEFAULT DATE ‚&#39;0000-00-00&#39;);

ALTER TABLE Schauspieler
ADD Telefon CHAR(16) DEFAULT ‚unbekannt‘;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="constraints-und-trigger">
<h3><span class="section-number">9.7.6. </span>Constraints und Trigger<a class="headerlink" href="#constraints-und-trigger" title="Permalink to this headline">¶</a></h3>
<p>Weitere Optionen für Tabellen
<br>
□ PRIMARY KEY
<br>
□ UNIQUE
<br>
□ FOREIGN KEY … REFERENCES …
<br>
□ NOT NULL
<br>
□ CHECK
<br>
□ CREATE ASSERTION
<br>
□ CREATE TRIGGER
<br>
■ Siehe separater Foliensatz</p>
</div>
<div class="section" id="indizes">
<h3><span class="section-number">9.7.7. </span>Indizes<a class="headerlink" href="#indizes" title="Permalink to this headline">¶</a></h3>
<p>■ Ein Index auf einem Attribut ist eine Datenstruktur, die es dem DBMS erleichtert, Tupel mit einem bekannten Wert des Attributs zu finden.
<br>
□ Nicht SQL-Standard, aber in (fast) jedem DBMS verfügbar.
<br><br>
■ Motivation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%sql SELECT * </span>
<span class="c1">#FROM Film </span>
<span class="c1">#WHERE StudioName = &quot;Disney&quot; </span>
<span class="c1">#AND Jahr = 1990;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT * FROM Film WHERE StudioName = &#39;Disney&#39; AND Jahr = 1990&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
      <th>Jahr</th>
      <th>Laenge</th>
      <th>inFarbe</th>
      <th>StudioName</th>
      <th>ProduzentinID</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Ducktales the Movie: Treasure of the Lost Lamp</td>
      <td>1990</td>
      <td>74</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shipwrecked</td>
      <td>1990</td>
      <td>92</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
    <tr>
      <th>2</th>
      <td>The Rescuers Down Under</td>
      <td>1990</td>
      <td>77</td>
      <td>TRUE</td>
      <td>Disney</td>
      <td>1234</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>□ Variante 1: Alle 100.000 Tupel durchsuchen und WHERE Bedingung prüfen
<br>
□ Variante 2: Direkt alle 2000 Filme aus 1990 betrachten und auf ‚Disney‘ prüfen.
<br>
– CREATE INDEX JahrIndex ON Film(Jahr);
<br>
□ Variante 3: Direkt alle 100 Filme aus 1990 von ‘Disney‘ holen.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">CREATE</span> <span class="n">INDEX</span> <span class="n">JahrStudioIndex</span>
<span class="n">ON</span> <span class="n">Film</span><span class="p">(</span><span class="n">Jahr</span><span class="p">,</span> <span class="n">Studioname</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>■ Indizes auf einzelnen Attributen
<br>
□ CREATE INDEX JahrIndex ON Film(Jahr);
<br><br>
■ Indizes auf mehreren Attributen</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">CREATE</span> <span class="n">INDEX</span> <span class="n">JahrStudioIndex</span>
<span class="n">ON</span> <span class="n">Film</span><span class="p">(</span><span class="n">Jahr</span><span class="p">,</span> <span class="n">Studioname</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>□ Reihenfolge wichtig! Warum?
<br><br>
■ Löschen
<br>
□ DROP INDEX JahrIndex;</p>
<div class="section" id="indexwahl">
<h4><span class="section-number">9.7.7.1. </span>Indexwahl<a class="headerlink" href="#indexwahl" title="Permalink to this headline">¶</a></h4>
<p>■ Abwägung
<br>
□ Index beschleunigt Punkt- (und Bereichs-) Anfragen und Join-Anfragen erheblich.
<br>
□ Index verlangsamt das Einfügen, Löschen und Verändern von Tupeln der Relation.
<br>
– Index muss jeweils zusätzlich aktualisiert werden.
<br>
□ Indizes benötigen Speicherplatz.
<br><br>
■ Wahl der besten Indizes ist eine der schwierigsten Aufgaben des Datenbankdesigns.
<br>
□ Vorhersage der query workload und update-Frequenz
<br>
□ Wahl der Attribute
<br>
– Häufiger Vergleich mit Konstanten
<br>
– Häufiges Joinattribut</p>
</div>
<div class="section" id="indexwahl-voruberlegungen">
<h4><span class="section-number">9.7.7.2. </span>Indexwahl – Vorüberlegungen<a class="headerlink" href="#indexwahl-voruberlegungen" title="Permalink to this headline">¶</a></h4>
<p>■ Relationen sind typischerweise über mehrere Diskblöcke gespeichert.
<br>
□ Wichtigste Datenbankkosten sind die Anzahl der Diskblöcke, die in den Hauptspeicher gelesen werden müssen.
<br>
□ Bei Punktanfragen mit Index müssen statt aller Blöcke nur ein Block gelesen werden.
<br>
□ Aber Index selbst muss ebenfalls gespeichert und gelesen werden.
<br>
– IdR viel mehr Tupel pro Block repräsentiert: Nur Schlüsselwert und Speicheradresse, keine Daten
<br>
□ Updates kosten sogar doppelt: Lesen und Schreiben auch der Index-Blöcke</p>
</div>
<div class="section" id="indexwahl-beispiel">
<h4><span class="section-number">9.7.7.3. </span>Indexwahl – Beispiel<a class="headerlink" href="#indexwahl-beispiel" title="Permalink to this headline">¶</a></h4>
<p>■ spielt_in(FilmTitel, FilmJahr, Schauspieler)
<br><br>
■ Drei typische Anfragen</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT FilmTitel, FilmJahr </span>
<span class="c1">#FROM spielt_in </span>
<span class="c1">#WHERE Name = s;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT FilmTitel, FilmJahr FROM spielt_in WHERE Name = &#39;s&#39;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>FilmTitel</th>
      <th>FilmJahr</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">SELECT</span> <span class="n">Schauspieler</span> <span class="n">FROM</span> <span class="n">spielt_in</span>
<span class="n">WHERE</span> <span class="n">FilmTitel</span> <span class="o">=</span> <span class="n">t</span> <span class="n">AND</span> <span class="n">FilmJahr</span> <span class="o">=</span> <span class="n">j</span><span class="p">;</span>
<span class="n">INSERT</span> <span class="n">INTO</span> <span class="n">spielt_in</span> <span class="n">VALUES</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">s</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>■ Annahmen
<br>
□ spielt_in ist auf 10 Disk-Blöcke verteilt.
<br>
□ Durchschnittlich habe jeder Film 3 Schauspieler.
<br>
□ Durchschnittlich spiele jeder Schauspieler in 3 Filmen.
<br>
□ Annahme des Schlimmsten: 3 Tupel sind auf 3 Blöcke verteilt
<br>
□ Index ist auf 1 Block gespeichert.
<br>
□ Lesen und Schreiben kostet 1.
<br>
□ Update und Insert kosten jeweils 2.</p>
</div>
<div class="section" id="id3">
<h4><span class="section-number">9.7.7.4. </span>Indexwahl – Beispiel<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Anfrage</p></th>
<th class="head"><p>Kein Index</p></th>
<th class="head"><p>SchauspielerIndex</p></th>
<th class="head"><p>FilmIndex</p></th>
<th class="head"><p>Beide Indizes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Schauspieler = s</strong></p></td>
<td><p>10</p></td>
<td><p>4</p></td>
<td><p>10</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-odd"><td><p><strong>FilmTitel = t AND FilmJahr = j</strong></p></td>
<td><p>10</p></td>
<td><p>10</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
</tr>
<tr class="row-even"><td><p><strong>INSERT INTO spielt_in</strong></p></td>
<td><p>2</p></td>
<td><p>4</p></td>
<td><p>4</p></td>
<td><p>6</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Gesamtkosten</strong></p></td>
<td><p>2+8<span class="math notranslate nohighlight">\(p_1\)</span>8<span class="math notranslate nohighlight">\(p_2\)</span></p></td>
<td><p>4+6<span class="math notranslate nohighlight">\(p_2\)</span></p></td>
<td><p>4+6<span class="math notranslate nohighlight">\(p_1\)</span></p></td>
<td><p>6-2<span class="math notranslate nohighlight">\(p_1\)</span>-2<span class="math notranslate nohighlight">\(p_2\)</span></p></td>
</tr>
</tbody>
</table>
<p>■ p1: Anteil Anfrage 1
<br>
■ p2: Anteil Anfrage 2
<br>
■ 1‒p1‒p2: Anteil Anfrage 3
<br></p>
</div>
</div>
<div class="section" id="verteilung-in-imdb-real-world-daten-stand-ca-2010">
<h3><span class="section-number">9.7.8. </span>Verteilung in IMDB (Real-world Daten, Stand ca. 2010)<a class="headerlink" href="#verteilung-in-imdb-real-world-daten-stand-ca-2010" title="Permalink to this headline">¶</a></h3>
<p><img alt="title" src="../_images/imdb.jpg" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">WITH</span>
<span class="n">m</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">AS</span> <span class="n">ZahlMovies</span> <span class="n">FROM</span> <span class="n">imdb</span><span class="o">.</span><span class="n">movie</span><span class="p">),</span>
<span class="n">actress</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">AS</span> <span class="n">ZahlActress</span> <span class="n">FROM</span> <span class="n">imdb</span><span class="o">.</span><span class="n">actress</span><span class="p">),</span>
<span class="n">actor</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="n">AS</span> <span class="n">ZahlActor</span> <span class="n">FROM</span> <span class="n">imdb</span><span class="o">.</span><span class="n">actor</span><span class="p">),</span>
<span class="n">actors</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="p">(</span><span class="n">ZahlActress</span> <span class="o">+</span> <span class="n">ZahlActor</span><span class="p">)</span> <span class="n">AS</span> <span class="n">GesamtActors</span>
<span class="n">FROM</span> <span class="n">actress</span><span class="p">,</span> <span class="n">actor</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">DOUBLE</span><span class="p">(</span><span class="n">actors</span><span class="o">.</span><span class="n">GesamtActors</span><span class="p">)</span> <span class="o">/</span> <span class="n">DOUBLE</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">ZahlMovies</span><span class="p">)</span>
<span class="n">FROM</span> <span class="n">m</span><span class="p">,</span> <span class="n">actors</span>
</pre></div>
</div>
</div>
</div>
<p>Schauspieler*in pro Spielfilm: 8,7</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">WITH</span>
<span class="n">actors</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">imdb</span><span class="o">.</span><span class="n">actor</span> <span class="n">UNION</span>
<span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">imdb</span><span class="o">.</span><span class="n">actress</span><span class="p">),</span>
<span class="n">counts</span> <span class="n">AS</span> <span class="p">(</span><span class="n">SELECT</span> <span class="n">name</span><span class="p">,</span> <span class="n">count</span><span class="p">(</span><span class="n">movie_id</span><span class="p">)</span> <span class="n">AS</span> <span class="n">m</span>
<span class="n">FROM</span> <span class="n">actors</span> <span class="n">GROUP</span> <span class="n">BY</span> <span class="n">name</span><span class="p">)</span>
<span class="n">SELECT</span> <span class="n">AVG</span><span class="p">(</span><span class="n">DOUBLE</span><span class="p">(</span><span class="n">m</span><span class="p">))</span> <span class="n">FROM</span> <span class="n">counts</span>
</pre></div>
</div>
</div>
</div>
<p>Spielfilme pro Schauspieler: 4,2</p>
</div>
</div>
<div class="section" id="sichten">
<h2><span class="section-number">9.8. </span>Sichten<a class="headerlink" href="#sichten" title="Permalink to this headline">¶</a></h2>
<div class="section" id="virtuelle-relationen">
<h3><span class="section-number">9.8.1. </span>Virtuelle Relationen<a class="headerlink" href="#virtuelle-relationen" title="Permalink to this headline">¶</a></h3>
<p>■ Relationen aus CREATE TABLE Ausdrücken existieren tatsächlich (materialisiert, physisch) in der Datenbank.
<br>
□ Persistenz
<br>
□ Updates sind möglich
<br><br>
■ Die Daten aus Sichten (views) existieren nur virtuell.
<br>
□ Sichten entsprechen Anfragen, denen man einen Namen gibt. Sie wirken wie physische Relationen.
<br>
□ Updates sind nur manchmal möglich.
<br>
<br>
<img alt="title" src="../_images/stonebraker1.jpg" />
<br>
<img alt="title" src="../_images/stonebraker2.jpg" />
<br>
Michael Stonebraker: Implementation of Integrity Constraints and Views by Query Modification. SIGMOD Conference 1975: 65-78</p>
</div>
<div class="section" id="sichten-in-sql">
<h3><span class="section-number">9.8.2. </span>Sichten in SQL<a class="headerlink" href="#sichten-in-sql" title="Permalink to this headline">¶</a></h3>
<p>■ CREATE VIEW Name AS Anfrage</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">CREATE</span> <span class="n">VIEW</span> <span class="n">ParamountFilme</span> <span class="n">AS</span>
<span class="n">SELECT</span> <span class="n">Titel</span><span class="p">,</span> <span class="n">Jahr</span>
<span class="n">FROM</span> <span class="n">Film</span>
<span class="n">WHERE</span> <span class="n">StudioName</span> <span class="o">=</span> <span class="s2">&quot;Paramount&quot;</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>□ Auch mehr als eine Relation möglich!
<br><br>
■ Bedeutung einer Anfrage an die Sicht
<br></p>
<ol class="simple">
<li><p>Ausführung der Anfrage aus der Sichdefinition
<br></p></li>
<li><p>Die ursprüngliche Anfrage verwendet dann das Ergebnis als Relation.
<br><br>
■ Daten der Sicht ändern sich mit der Änderung der zugrundeliegenden Relationen.
<br>
■ Entfernen der Sicht: DROP VIEW ParamountFilme
<br>
□ Basisdaten bleiben unverändert.</p></li>
</ol>
</div>
<div class="section" id="anfragen-an-sichten">
<h3><span class="section-number">9.8.3. </span>Anfragen an Sichten<a class="headerlink" href="#anfragen-an-sichten" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">CREATE</span> <span class="n">VIEW</span> <span class="n">ParamountFilme</span> <span class="n">AS</span>
<span class="n">SELECT</span> <span class="n">Titel</span><span class="p">,</span> <span class="n">Jahr</span>
<span class="n">FROM</span> <span class="n">Film</span>
<span class="n">WHERE</span> <span class="n">StudioName</span> <span class="o">=</span> <span class="s2">&quot;Paramount&quot;</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">SELECT</span> <span class="n">Titel</span>
<span class="n">FROM</span> <span class="n">ParamountFilme</span>
<span class="n">WHERE</span> <span class="n">Jahr</span> <span class="o">=</span> <span class="mi">1979</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>■ Umwandlung der ursprünglichen Anfrage in eine Anfrage an Basisrelationen</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SELECT Titel </span>
<span class="c1">#FROM Film </span>
<span class="c1">#WHERE StudioName = &quot;Paramount&quot; </span>
<span class="c1">#AND Jahr = 1979;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel FROM Film WHERE Jahr = 1979 AND StudioName = &#39;Paramount&#39;;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>□ Übersetzung durch DBMS
<br>
■ Anfrage zugleich an Sichten und Basisrelationen möglich</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Anfrage aus VL Folien</span>
<span class="c1">#SELECT DISTINCT SchauspielerIn</span>
<span class="c1">#FROM ParamountFilme, spielt_in</span>
<span class="c1">#WHERE Titel = FilmTitel AND Jahr = FilmJahr;</span>

<span class="c1">#Anfrage für filme.db</span>
<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT DISTINCT Name FROM Film, spielt_in WHERE Titel = FilmTitel AND Jahr = FilmJahr;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Mark Hamill</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Harrison Ford</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Carrie Fisher</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Emile Hirsch</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Jake Gyllenhaal</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Heath Ledger</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Robert Pattinson</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Willem Dafoe</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Leonardo DiCaprio</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Tobey Maguire</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Carey Mulligan</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Saoirse Ronan</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Vincent Cassel</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Meryl Streep</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Phyllis Smith</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Arnold Schwarzenegger</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Sharon Stone</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Samuel L. Jackson</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Tom Hanks</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Kirsten Dunst</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Emma Stone</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Ryan Gosling</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Mahershala Ali</td>
    </tr>
    <tr>
      <th>23</th>
      <td>William Shatner</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Alan Young</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Jared Leto</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Adam Driver</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Lady Gaga</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Daniel Craig</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Léa Seydoux</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Christoph Waltz</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>■ Film(Titel, Jahr, Länge, inFarbe, StudioName, ProduzentinID)
■ Manager(Name, Adresse, ManagerinID, Gehalt)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">CREATE</span> <span class="n">VIEW</span> <span class="n">FilmeProduzenten</span> <span class="n">AS</span>
    <span class="n">SELECT</span> <span class="n">Titel</span><span class="p">,</span> <span class="n">Name</span>
    <span class="n">FROM</span> <span class="n">Film</span><span class="p">,</span> <span class="n">Manager</span>
    <span class="n">WHERE</span> <span class="n">ProduzentinID</span> <span class="o">=</span> <span class="n">ManagerinID</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>■ Anfrage</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#alte Anfrage</span>
<span class="c1">#SELECT Name FROM FilmeProduzenten WHERE Titel = ‘Gone with the Wind‘</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel FROM Film WHERE Titel = &#39;Gone with the Wind&#39;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Titel</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Gone with the Wind</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>■ Bedeutung</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#%sql SELECT Name FROM Film, ManagerIn WHERE ProduzentinID = ManagerinID AND Titel = &#39;Gone with the Wind&#39;;</span>

<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Name FROM Film, ManagerIn WHERE ProduzentinID = ManagerinID AND Titel = &#39;Gone with the Wind&#39;;&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_sql_query</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Louis B.Mayer</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>■ Nebenbei: Umbenennung von Attributen</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">CREATE</span> <span class="n">VIEW</span> <span class="n">FilmeProduzenten</span><span class="p">(</span><span class="n">FilmTitel</span><span class="p">,</span> <span class="n">Produzentenname</span><span class="p">)</span> <span class="n">AS</span>
<span class="n">SELECT</span> <span class="n">Titel</span><span class="p">,</span> <span class="n">Name</span>
<span class="n">FROM</span> <span class="n">Film</span><span class="p">,</span> <span class="n">ManagerIn</span>
<span class="n">WHERE</span> <span class="n">ProduzentinID</span> <span class="o">=</span> <span class="n">ManagerinID</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>■ Oder auch: Sicht einfach nur zur Umbenennung</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">CREATE</span> <span class="n">VIEW</span> <span class="n">Movie</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">inColor</span><span class="p">,</span> <span class="n">studio</span><span class="p">,</span> <span class="n">producerID</span><span class="p">)</span> <span class="n">AS</span>
<span class="n">SELECT</span> <span class="o">*</span>
<span class="n">FROM</span> <span class="n">Film</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="diskussion">
<h3><span class="section-number">9.8.4. </span>Diskussion<a class="headerlink" href="#diskussion" title="Permalink to this headline">¶</a></h3>
<p>■ Vorteile
<br>
□ Vereinfachung von Anfragen
<br>
□ Strukturierung der Datenbank
<br>
□ Logische Datenunabhängigkeit
<br>
– Sichten stabil bei Änderungen der Datenbankstruktur
<br>
– Sichtdefinitionen müssen gegebenenfalls angepasst werden
<br>
– Stabilität nicht bei jeder Änderung
<br>
□ Beschränkung von Zugriffen (Datenschutz)
<br>
□ Optimierung durch materialisierte Sichten
<br><br>
■ Probleme
<br>
□ Automatische Anfragetransformation schwierig
<br>
□ Änderungen auf Sichten
<br>
□ Updatepropagierung für materialisierte Sichten</p>
</div>
<div class="section" id="updates-auf-sichten">
<h3><span class="section-number">9.8.5. </span>Updates auf Sichten<a class="headerlink" href="#updates-auf-sichten" title="Permalink to this headline">¶</a></h3>
<p>■ In einigen Fällen ist es möglich, Einfüge-, Lösch- oder Updateoperationen auf Sichten durchzuführen.
<br>
□ Wo speichern?
<br>
□ Welche Relation?
<br>
□ Zuordnung der Änderung zur Sicht?
<br><br>
■ Übersetzung der Update-Operation auf eine Update-Operation der zugrunde liegenden Basisrelationen
<br>
□ Nur bei einer Relation
<br>
– Keine Subanfragen mit Selbstbezug
<br>
□ Nur bei normalem SELECT
<br>
– Kein DISTINCT
<br>
□ Nur falls genug Attribute verwendet werden, so dass alle anderen Attribute mit NULL oder dem Default-Wert gefüllt werden können.</p>
</div>
<div class="section" id="einfugen-auf-sichten-beispiel">
<h3><span class="section-number">9.8.6. </span>Einfügen auf Sichten – Beispiel<a class="headerlink" href="#einfugen-auf-sichten-beispiel" title="Permalink to this headline">¶</a></h3>
<p>■ Filme(Titel, Jahr, Länge, inFarbe, StudioName, ProduzentinID)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
CREATE VIEW ParamountFilme AS
    SELECT Titel, Jahr
    FROM Filme
    WHERE StudioName = ‚Paramount‘;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
INSERT INTO ParamountFilme
VALUES (‚Star Trek‘, 1979);
</pre></div>
</div>
</div>
</div>
<p>□ Wert für Studioname?
□ Einfügen also nicht erlaubt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
CREATE VIEW ParamountFilme AS
    SELECT Titel, Jahr, StudioName
    FROM Filme
    WHERE StudioName = ‚Paramount‘;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
INSERT INTO ParamountFilme
VALUES (‚Star Trek‘, 1979, ‚Paramount‘);
</pre></div>
</div>
</div>
</div>
<p>Dies muss Paramount sein. Ein anderes Studio entspricht nicht der View.
<br><br>
■ Neues Tupel (‚Star Trek‘, 1979, 0, NULL, ‚Paramount‘, NULL)</p>
</div>
<div class="section" id="loschen-und-updates-auf-sichten">
<h3><span class="section-number">9.8.7. </span>Löschen und Updates auf Sichten<a class="headerlink" href="#loschen-und-updates-auf-sichten" title="Permalink to this headline">¶</a></h3>
<p>■ Löschen</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
DELETE FROM ParamountFilme
WHERE Titel LIKE ‚%Trek%‘;
</pre></div>
</div>
</div>
</div>
<p>■ Wird umgeschrieben zu</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
DELETE FROM Filme
WHERE Titel LIKE ‚%Trek%‘ AND StudioName = ‚Paramount‘;
</pre></div>
</div>
</div>
</div>
<p>■ Update</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
UPDATE ParamountFilme
SET Jahr = 1979
WHERE Titel = ‚Star Trek the Movie‘;
</pre></div>
</div>
</div>
</div>
<p>■ Wird zu</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
UPDATE Filme
SET Jahr = 1979
WHERE Titel = ‚Star Trek the Movie‘ AND StudioName = ‚Paramount‘;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="tupelmigration">
<h3><span class="section-number">9.8.8. </span>Tupelmigration<a class="headerlink" href="#tupelmigration" title="Permalink to this headline">¶</a></h3>
<p>■ Manager(Name, Adresse, ManagerinID, Gehalt)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">CREATE</span> <span class="n">VIEW</span> <span class="n">Reiche</span> <span class="n">AS</span>
    <span class="n">SELECT</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Gehalt</span><span class="p">,</span> <span class="n">ManagerinID</span>
    <span class="n">FROM</span> <span class="n">ManagerIn</span>
    <span class="n">WHERE</span> <span class="n">Gehalt</span> <span class="o">&gt;</span> <span class="mi">2000000</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>■ Tupelmigration:
<br>
□ Ein Tupel (‚Eisner`, ‚Hollywood‘, 25, 3000000) wird aus der Sicht „herausbewegt“.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">UPDATE</span> <span class="n">Reiche</span> <span class="n">SET</span> <span class="n">Gehalt</span> <span class="o">=</span> <span class="mi">1500000</span>
<span class="n">WHERE</span> <span class="n">ManagerinID</span> <span class="o">=</span> <span class="mi">25</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>■ Vorsicht bei der Implementierung, oder explizite Verhinderung:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">sql</span>
<span class="n">CREATE</span> <span class="n">VIEW</span> <span class="n">Reiche</span> <span class="n">AS</span>
<span class="n">SELECT</span> <span class="n">Name</span><span class="p">,</span> <span class="n">Gehalt</span>
<span class="n">FROM</span> <span class="n">ManagerIn</span>
<span class="n">WHERE</span> <span class="n">Gehalt</span> <span class="o">&gt;</span> <span class="mi">2000000</span>
<span class="n">WITH</span> <span class="n">CHECK</span> <span class="n">OPTION</span><span class="p">;</span>
</pre></div>
</div>
</div>
</div>
<p>□ Verhindert Tupelmigration durch Ablehnung problematischer Updates.</p>
</div>
<div class="section" id="anfrageplanung-mit-sichten">
<h3><span class="section-number">9.8.9. </span>Anfrageplanung mit Sichten<a class="headerlink" href="#anfrageplanung-mit-sichten" title="Permalink to this headline">¶</a></h3>
<p>■ Baumdarstellung von Anfragen
<br>
□ Blätter repräsentieren Relationen
<br>
– Basisrelationen
<br>
– Sichten
<br>
□ Ersetzung der Sichten durch die Sichtdefinition
<br>
– Als Subanfrage
<br>
<img alt="title" src="../_images/anfrageplanung1.jpg" />
<br><br>
■ Sicht</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>%sql
CREATE VIEW ParamountFilme AS
SELECT Titel, Jahr
FROM Filme
WHERE StudioName = ‚Paramount‘;
</pre></div>
</div>
</div>
</div>
<p>■ Anfrage</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Anfrage aus VL Folien</span>
<span class="c1">#SELECT Titel </span>
<span class="c1">#FROM ParamountFilme </span>
<span class="c1">#WHERE Jahr = 1979;</span>

<span class="c1">#Neue Anfrage für filme.db</span>
<span class="n">__SQL__</span> <span class="o">=</span> <span class="s2">&quot;SELECT Titel FROM Film WHERE Jahr = 1979&quot;</span>
<span class="n">conn</span> <span class="o">=</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;filme/filme.db&quot;</span><span class="p">)</span>
<span class="n">cur</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">cursor</span><span class="p">()</span>
<span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="n">__SQL__</span><span class="p">)</span>
<span class="n">rows</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">fetchall</span><span class="p">()</span>

<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rows</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">row</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">col</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Star Trek 
</pre></div>
</div>
</div>
</div>
<p><img alt="title" src="../_images/anfrageplanung2.jpg" />
<br>
<img alt="title" src="../_images/anfrageplanung3.jpg" />
<br>
<img alt="title" src="../_images/anfrageplanung4.jpg" /></p>
</div>
<div class="section" id="materialisierte-sichten">
<h3><span class="section-number">9.8.10. </span>Materialisierte Sichten<a class="headerlink" href="#materialisierte-sichten" title="Permalink to this headline">¶</a></h3>
<p>■ Viele Anfragen an eine Datenbank wiederholen sich häufig
<br>
□ Business Reports, Bilanzen, Umsätze
<br>
□ Bestellungsplanung, Produktionsplanung
<br>
□ Kennzahlenberechnung
<br><br>
■ Viele Anfragen sind Variationen mit gemeinsamem Kern
<br><br>
■ Idee: Einmaliges Berechnen der Anfrage als Sicht
<br>
□ Automatische, transparente Verwendung in folgenden Anfragen
<br>
□ Materialisierte Sicht (materialized view, MV)
<br>
Drei Folien nach Prof. Ulf Leser, HU Berlin</p>
<div class="section" id="mv-themen-und-probleme">
<h4><span class="section-number">9.8.10.1. </span>MV – Themen und Probleme<a class="headerlink" href="#mv-themen-und-probleme" title="Permalink to this headline">¶</a></h4>
<p>■ Wahl von Views zur Materialisierung
<br>
□ MVs kosten: Platz und Aktualisierungsaufwand
<br>
□ Wahl der optimalen MVs hängt von Workload ab
<br>
□ Auswahl der „optimalen“ Menge von MVs
<br><br>
■ Automatische Aktualisierung von MVs
<br>
□ Aktualisierung bei Änderungen der Basisrelationen
<br>
□ U.U. schwierig: Aggregate, Joins, Outer-Joins, …
<br>
□ Algorithmen zur inkrementellen Aktualisierung
<br><br>
■ Automatische Verwendung von MV
<br>
□ „Answering Queries using Views“
<br>
□ Umschreiben der Anfrage notwendig
<br>
□ Schwierigkeit hängt von Komplexität der Anfrage / Views ab
<br>
□ Algorithmen zur transparenten und kostenoptimalen Verwendung der materialisierten Sichten</p>
</div>
</div>
<div class="section" id="answering-queries-using-views">
<h3><span class="section-number">9.8.11. </span>„Answering Queries using Views“<a class="headerlink" href="#answering-queries-using-views" title="Permalink to this headline">¶</a></h3>
<p>■ Gegeben
<br>
□ Eine Anfrage Q
<br>
□ Eine Menge V (materialisierten) von Sichten
<br><br>
■ Fragen
<br>
□ Kann man Q überhaupt unter Verwendung von V beantworten?
<br>
□ Kann man Q nur mit V beantworten?
<br>
□ Kann man Q mit V vollständig beantworten?
<br>
□ Ist es günstig, Sichten aus V zur Beantwortung von Q zu verwenden? Welche?</p>
</div>
</div>
<div class="section" id="zusammenfassung">
<h2><span class="section-number">9.9. </span>Zusammenfassung<a class="headerlink" href="#zusammenfassung" title="Permalink to this headline">¶</a></h2>
<p>Die Anfragesprache SQL
<br>
Der SFW Block
<br>
Subanfragen
<br>
In FROM und WHERE
<br>
EXISTS, IN, ALL, ANY
<br>
Mengenoperationen
<br>
UNION, INTERSECT, EXCEPT
<br>
Joins und Outerjoins
<br>
Nullwerte
<br>
Mengen vs. Multimengen
<br>
DISTINCT, ALL
<br>
Gruppierung und Aggregation
<br>
MIN, MAX, COUNT
<br>
GROUP BY, HAVING
<br>
Datenbankveränderungen
<br>
INSERT, UPDATE, DELETE
<br>
Schemata und Datentypen
<br>
CREATE TABLE
<br>
ALTER TABLE
<br>
Indizes
<br>
Sichten
<br>
Anfragen (und updates)
<br>
Materialisierte Sichten</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "LUH-DBS/GDBS_Script",
            ref: "main/",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./09"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="../08/relationale_algebra.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">8. </span>Relationale Algebra</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../10/integritaet_und_trigger.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">10. </span>Integrität und Trigger</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Prof. Dr. Ziawasch Abedjan<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>